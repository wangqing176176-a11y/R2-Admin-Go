(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var t=e.i(47167),r=e.i(43476),a=e.i(71645);function s({open:e,title:t,description:a,children:s,onClose:l,footer:d,panelClassName:i,showHeaderClose:n=!1}){return e?(0,r.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start sm:items-center justify-center p-3 sm:p-4 overflow-y-auto",role:"dialog","aria-modal":"true",children:[(0,r.jsx)("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:l,"aria-label":"Close dialog"}),(0,r.jsxs)("div",{className:["relative w-full max-w-lg max-h-[calc(100dvh-1.5rem)] sm:max-h-[calc(100dvh-2rem)] rounded-2xl border border-gray-200 bg-white shadow-2xl dark:border-gray-800 dark:bg-gray-900 flex flex-col overflow-hidden",i].filter(Boolean).join(" "),children:[(0,r.jsxs)("div",{className:"relative px-5 py-4 border-b border-gray-100 dark:border-gray-800",children:[n?(0,r.jsx)("button",{type:"button",onClick:l,"aria-label":"关闭弹窗",className:"absolute right-3 top-2.5 inline-flex h-10 w-10 items-center justify-center rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-gray-100",children:(0,r.jsx)("span",{className:"text-xl leading-none",children:"×"})}):null,(0,r.jsxs)("div",{className:"min-w-0 pr-10",children:[(0,r.jsx)("div",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:t}),a?(0,r.jsx)("div",{className:"mt-1 text-sm text-gray-500 dark:text-gray-300",children:a}):null]})]}),(0,r.jsx)("div",{className:"px-5 py-4 text-gray-900 dark:text-gray-100 overflow-y-auto min-h-0",children:s}),d?(0,r.jsx)("div",{className:"px-5 py-4 border-t border-gray-100 dark:border-gray-800",children:d}):null]})]}):null}let l=(e,t="操作失败，请重试。")=>{let r=String(e instanceof Error?e.message:e??"").trim();if(!r)return t;if(/[\u4e00-\u9fa5]/.test(r))return r;let a=r.toLowerCase();return a.includes("invalid login credentials")?"账号或密码错误，请重试。":a.includes("email not confirmed")?"邮箱尚未验证，请先前往邮箱完成验证。":a.includes("unauthorized")?"登录状态已失效，请重新登录。":a.includes("missing params")?"请求参数不完整，请刷新后重试。":a.includes("bucket required")?"缺少存储桶参数。":a.includes("bucket id required")?"缺少存储桶 ID。":a.includes("bucket not found")?"未找到存储桶，请刷新后重试。":a.includes("source not found")?"源文件不存在或已被删除。":a.includes("unknown bucket binding")||a.includes("bucket binding not configured")?"存储桶绑定未配置或不可用，请检查配置。":a.includes("token expired")?"操作令牌已过期，请重试。":a.includes("invalid token")?"操作令牌无效，请重试。":a.includes("missing environment variable")?"服务端缺少必要环境变量，请联系管理员。":a.includes("decryption failed")||a.includes("ciphertext authentication failure")||a.includes("bad padding")||a.includes("aes-gcm")?"密钥解密失败：请检查 CREDENTIALS_ENCRYPTION_KEY 是否与历史配置一致。":a.includes("failed to load buckets")?"读取存储桶列表失败，请稍后重试。":a.includes("failed to load bucket")?"读取存储桶信息失败，请稍后重试。":a.includes("failed to create bucket")?"新增存储桶失败，请检查配置后重试。":a.includes("failed to update bucket")?"更新存储桶失败，请稍后重试。":a.includes("failed to delete bucket")?"删除存储桶失败，请稍后重试。":a.includes("failed to check existing bucket")?"校验存储桶是否存在时失败，请稍后重试。":a.includes("failed to set default bucket")?"设置默认存储桶失败，请稍后重试。":a.includes("duplicate key value violates unique constraint")?"该账号下已存在同名存储桶（同 Account ID + 桶名），请修改后重试。":a.includes("failed to fetch")?"网络请求失败，请检查网络后重试。":t},d=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:l="",children:i,iconNode:o,...c},x)=>(0,a.createElement)("svg",{ref:x,...n,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:d("lucide",l),...!i&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1})(c)&&{"aria-hidden":"true"},...c},[...o.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(i)?i:[i]])),c=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...s},l)=>(0,a.createElement)(o,{ref:l,iconNode:t,className:d(`lucide-${i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...s}));return r.displayName=i(e),r},x=c("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),g=c("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),u=c("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),m=c("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),y=c("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),h=c("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),b=c("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),p=c("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),k=c("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),f=c("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),v=c("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),j=c("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),N=c("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),w=c("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),S=c("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),C=c("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),$=c("file-archive",[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]]),M=c("file-code",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]]),I=c("file-spreadsheet",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),E=c("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]),_=c("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),z=c("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),T=c("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),P=c("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),A=c("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),B=c("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),U=c("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),R=c("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),L=c("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),O=c("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),K=c("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),q=c("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),J=c("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),D=c("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),H=c("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),F=c("badge-info",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["line",{x1:"12",x2:"12",y1:"16",y2:"12",key:"1y1yb1"}],["line",{x1:"12",x2:"12.01",y1:"8",y2:"8",key:"110wyk"}]]),W=c("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),V=c("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),Z=c("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),X=c("circle-user-round",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Y=c("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),G="r2_admin_theme_v1",Q=e=>{let[t,r]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=window.matchMedia(e),a=()=>r(t.matches);return a(),t.addEventListener("change",a),()=>t.removeEventListener("change",a)},[e]),t},ee=({className:e})=>{let[t,s]=(0,a.useState)(!1);return t?(0,r.jsx)("div",{"aria-hidden":"true",className:e}):(0,r.jsx)("img",{src:"/brand.png",alt:"","aria-hidden":"true",className:["block object-contain",e].filter(Boolean).join(" "),onError:()=>s(!0),draggable:!1})},et=({className:e})=>(0,r.jsx)("span",{className:["inline-block bg-current",e].filter(Boolean).join(" "),"aria-hidden":"true",style:{WebkitMaskImage:"url(/Wi-Fi.svg)",maskImage:"url(/Wi-Fi.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain"}}),er=({bucketName:e,disabled:t,onClick:a,className:s})=>(0,r.jsxs)("button",{type:"button",disabled:t,onClick:a,title:e,"aria-label":"查看当前存储桶",className:["inline-flex items-center gap-2 px-1 py-1 rounded-md text-left","transition-colors hover:text-gray-700 dark:hover:text-gray-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/30 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900","disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-inherit",s].filter(Boolean).join(" "),children:[(0,r.jsx)(Y,{className:"w-5 h-5 text-gray-500 shrink-0 dark:text-gray-300",strokeWidth:1.75}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-[10px] leading-tight text-gray-500 dark:text-gray-400",children:"当前桶"}),(0,r.jsx)("div",{className:"mt-0.5 text-[11px] leading-tight font-normal text-blue-600 truncate max-w-[10.5rem] md:max-w-[16rem] dark:text-blue-300",children:e})]})]}),ea=(e,t=0)=>{let r="number"==typeof e?e:Number(e);return Number.isFinite(r)?r:t},es=e=>{if(void 0===e||!Number.isFinite(e)||e<0)return"-";if(0===e)return"0 B";let t=["B","KB","MB","GB","TB"],r=Math.min(t.length-1,Math.max(0,Math.floor(Math.log(e)/Math.log(1024))));return parseFloat((e/Math.pow(1024,r)).toFixed(2))+" "+t[r]},el={title:"R2 Admin Go",subtitle:"R2对象存储多功能管理工具",advantages:["极速的响应速度和上传下载速度","无服务器部署、不存储用户数据","支持大文件上传、预览、重命名、移动和批量操作等功能"],announcementTitle:"公告",announcementText:`欢迎使用

- 继续访问即代表您已阅读并同意「关于页面」相关条款。
- 如有问题欢迎通过「电子邮件」与我反馈沟通。
`,footer:"By Wang Qing"},ed=[{label:"我的博客",href:"https://qinghub.top",icon:"globe"},{label:"使用教程",href:"https://github.com/wangqing176176-a11y/qing-r2-cloudy",icon:"book"},{label:"关于页面",href:"https://qinghub.top/about/",icon:"about"},{label:"电子邮箱",href:"mailto:wangqing176176@gmail.com",icon:"mail"}],ei="r2_multipart_resume_v1",en="r2_supabase_session_v1",eo="r2_supabase_session_tmp_v1",ec=(e,t,r)=>`${e}|${t}|${r.size}|${r.lastModified}`,ex=()=>{try{let e=localStorage.getItem(ei);if(!e)return{};let t=JSON.parse(e);return t&&"object"==typeof t?t:{}}catch{return{}}},eg=e=>{localStorage.setItem(ei,JSON.stringify(e))},eu=(e,t)=>{let r=ex();r[e]=t,eg(r)},em=e=>{let t=ex();e in t&&(delete t[e],eg(t))};function ey(){let[e,d]=(0,a.useState)(null),i=(0,a.useRef)(null),[n,o]=(0,a.useState)([]),[c,ei]=(0,a.useState)(null),[eg,ey]=(0,a.useState)([]),[eh,eb]=(0,a.useState)([]),[ep,ek]=(0,a.useState)(!1),[ef,ev]=(0,a.useState)("checking"),[ej,eN]=(0,a.useState)(null),[ew,eS]=(0,a.useState)(null),[eC,e$]=(0,a.useState)(!0),[eM,eI]=(0,a.useState)(null),[eE,e_]=(0,a.useState)(null),[ez,eT]=(0,a.useState)(!1),[eP,eA]=(0,a.useState)(null),[eB,eU]=(0,a.useState)(new Set),[eR,eL]=(0,a.useState)(null),[eO,eK]=(0,a.useState)(!1),[eq,eJ]=(0,a.useState)([]),[eD,eH]=(0,a.useState)(!1),eF=(0,a.useRef)(null),[eW,eV]=(0,a.useState)(""),[eZ,eX]=(0,a.useState)([]),[eY,eG]=(0,a.useState)(null),[eQ,e0]=(0,a.useState)(!1),[e1,e2]=(0,a.useState)({}),[e5,e4]=(0,a.useState)({}),[e8,e6]=(0,a.useState)({}),[e3,e9]=(0,a.useState)(null),e7=(0,a.useMemo)(()=>(e=>{if(!e)return null;if("string"==typeof e){let t=e.trim();return{kind:/失败|错误|异常/.test(t)?"error":/成功|已/.test(t)?"success":"info",message:t}}return e})(e3),[e3]),te=Q("(max-width: 767px)"),tt=Q("(prefers-color-scheme: dark)"),[tr,ta]=(0,a.useState)(!1),[ts,tl]=(0,a.useState)(!1),[td,ti]=(0,a.useState)(!1),tn=(0,a.useRef)(null),[to,tc]=(0,a.useState)(!1),tx=(0,a.useRef)(null),[tg,tu]=(0,a.useState)(!1),[tm,ty]=(0,a.useState)("system"),[th,tb]=(0,a.useState)(!1),[tp,tk]=(0,a.useState)(!1),[tf,tv]=(0,a.useState)(""),[tj,tN]=(0,a.useState)(!1),[tw,tS]=(0,a.useState)("move"),[tC,t$]=(0,a.useState)(""),[tM,tI]=(0,a.useState)([]),[tE,t_]=(0,a.useState)(!1),[tz,tT]=(0,a.useState)(""),[tP,tA]=(0,a.useState)(!1),[tB,tU]=(0,a.useState)(""),[tR,tL]=(0,a.useState)(""),[tO,tK]=(0,a.useState)(""),[tq,tJ]=(0,a.useState)(!1),[tD,tH]=(0,a.useState)(!1),[tF,tW]=(0,a.useState)(!1),[tV,tZ]=(0,a.useState)(!1),[tX,tY]=(0,a.useState)(!1),[tG,tQ]=(0,a.useState)(null),[t0,t1]=(0,a.useState)(!1),[t2,t5]=(0,a.useState)(!1),[t4,t8]=(0,a.useState)(!1),[t6,t3]=(0,a.useState)(!1),[t9,t7]=(0,a.useState)(null),re=(0,a.useRef)([]),rt=(0,a.useRef)(!1),rr=(0,a.useRef)(new Map),ra=(0,a.useRef)(!1);(0,a.useEffect)(()=>{re.current=eq},[eq]),(0,a.useEffect)(()=>{ra.current=eD},[eD]);let[rs,rl]=(0,a.useState)(""),[rd,ri]=(0,a.useState)(""),[rn,ro]=(0,a.useState)(""),[rc,rx]=(0,a.useState)(""),[rg,ru]=(0,a.useState)(!1),[rm,ry]=(0,a.useState)(!1),[rh,rb]=(0,a.useState)(""),[rp,rk]=(0,a.useState)(""),[rf,rv]=(0,a.useState)(!1),[rj,rN]=(0,a.useState)(""),[rw,rS]=(0,a.useState)(!1),[rC,r$]=(0,a.useState)(""),[rM,rI]=(0,a.useState)(""),[rE,r_]=(0,a.useState)(null),[rz,rT]=(0,a.useState)(""),[rP,rA]=(0,a.useState)(""),[rB,rU]=(0,a.useState)(""),[rR,rL]=(0,a.useState)(!1),[rO,rK]=(0,a.useState)(!1),[rq,rJ]=(0,a.useState)(!1),[rD,rH]=(0,a.useState)({bucketLabel:"",bucketName:"",accountId:"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:"",customBaseUrl:""}),[rF,rW]=(0,a.useState)({}),rV=String(t.default.env.NEXT_PUBLIC_SUPABASE_URL??"").replace(/\/$/,""),rZ=String(t.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY??t.default.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY??"").trim(),rX=e=>{if(!e)return null;try{let t=JSON.parse(e),r=String(t?.accessToken??"").trim(),a=String(t?.refreshToken??"").trim();if(!r||!a)return null;return{accessToken:r,refreshToken:a,userId:t.userId?String(t.userId):void 0,email:t.email?String(t.email):void 0}}catch{return null}},rY=(e,t)=>{if(!e){localStorage.removeItem(en),sessionStorage.removeItem(eo);return}if(t){localStorage.setItem(en,JSON.stringify(e)),sessionStorage.removeItem(eo);return}sessionStorage.setItem(eo,JSON.stringify(e)),localStorage.removeItem(en)},rG=(e,t)=>{let r=String(e??"").trim(),a=String(t??"").trim();return!!r&&(rY(null,!1),d(null),e$(!0),ev("error"),eN("请设置新密码后再登录"),r_({accessToken:r,refreshToken:a}),r$(""),rI(""),rS(!0),tZ(!1),!0)},rQ=async(e,t,r)=>{if(!rV||!rZ)throw Error("Supabase 前端环境变量未配置");let a=async e=>{let t=await fetch(`${rV}/auth/v1/verify`,{method:"POST",headers:{apikey:rZ,"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await r2(t),a=String(r.access_token??"").trim(),s=String(r.refresh_token??"").trim();if(!t.ok||!a)throw Error(String(r.msg??r.error_description??r.error??"重置链接无效或已过期"));return{accessToken:a,refreshToken:s}};if(e)return await a({type:"recovery",token_hash:e});if(t&&r)return await a({type:"recovery",token:t,email:r});throw Error("重置链接无效或已过期")},r0=async e=>{if(!rV||!rZ||!e.refreshToken)return null;let t=await fetch(`${rV}/auth/v1/token?grant_type=refresh_token`,{method:"POST",headers:{apikey:rZ,"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e.refreshToken})}),r=await r2(t);if(!t.ok||!r.access_token||!r.refresh_token)return null;let a={accessToken:String(r.access_token),refreshToken:String(r.refresh_token),userId:String((r.user?.id??e.userId)||""),email:String((r.user?.email??e.email)||"")};return rY(a,!!localStorage.getItem(en)),d(a),a};(0,a.useEffect)(()=>{i.current=e},[e]),(0,a.useEffect)(()=>{let e=rX(localStorage.getItem(en)),t=rX(sessionStorage.getItem(eo)),r=e??t;r?(d(r),r.email&&rl(r.email),rK(!!e)):(e$(!0),ev("error"),eN("请登录后继续使用"));let a=localStorage.getItem("r2_link_config_v1");if(a)try{e2(JSON.parse(a))}catch{localStorage.removeItem("r2_link_config_v1")}let s=localStorage.getItem("r2_s3_bucket_check_v1");if(s)try{e4(JSON.parse(s))}catch{localStorage.removeItem("r2_s3_bucket_check_v1")}let l=localStorage.getItem("r2_transfer_mode_override_v1");if(l)try{e6(JSON.parse(l))}catch{localStorage.removeItem("r2_transfer_mode_override_v1")}},[]),(0,a.useEffect)(()=>{let e=!1,t=()=>{let e=new URL(window.location.href);["type","access_token","refresh_token","token_hash","token","email","expires_in","expires_at","error","error_code","error_description","code"].forEach(t=>e.searchParams.delete(t));let t=`${e.pathname}${e.searchParams.toString()?`?${e.searchParams.toString()}`:""}`;window.history.replaceState({},document.title,t)};return(async()=>{let r=window.location.hash.replace(/^#/,"");if(r){let t=new URLSearchParams(r),a=String(t.get("type")??""),s=String(t.get("access_token")??"").trim(),l=String(t.get("refresh_token")??"").trim();if("recovery"===a&&s){!e&&rG(s,l)&&e9("检测到密码重置请求，请设置新密码");let t=`${window.location.pathname}${window.location.search}`;window.history.replaceState({},document.title,t);return}}let a=new URLSearchParams(window.location.search);if("recovery"!==String(a.get("type")??"").trim())return;let s=String(a.get("access_token")??"").trim(),d=String(a.get("refresh_token")??"").trim();if(s){!e&&rG(s,d)&&e9("检测到密码重置请求，请设置新密码"),t();return}let i=String(a.get("token_hash")??"").trim(),n=String(a.get("token")??"").trim(),o=String(a.get("email")??"").trim();try{let t=await rQ(i,n,o);!e&&rG(t.accessToken,t.refreshToken)&&e9("检测到密码重置请求，请设置新密码")}catch(t){e||e9(l(t,"重置链接无效或已过期，请重新发起忘记密码")||"重置链接无效或已过期，请重新发起忘记密码")}finally{t()}})(),()=>{e=!0}},[rZ,rV]),(0,a.useEffect)(()=>{if(!e7)return;let e=setTimeout(()=>e9(null),"error"===e7.kind?4500:3200);return()=>clearTimeout(e)},[e7]);let r1=e7?(0,r.jsx)("div",{className:"fixed top-5 left-1/2 -translate-x-1/2 z-50 max-w-[92vw]",children:(0,r.jsxs)("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full border shadow-lg text-sm font-medium ${"success"===e7.kind?"bg-green-50 border-green-200 text-green-700 dark:bg-green-950/40 dark:border-green-900 dark:text-green-200":"error"===e7.kind?"bg-red-50 border-red-200 text-red-700 dark:bg-red-950/40 dark:border-red-900 dark:text-red-200":"bg-gray-900 text-white border-gray-900 dark:bg-gray-900 dark:border-gray-800"}`,role:"status","aria-live":"polite",children:[(0,r.jsx)("span",{className:"shrink-0 flex items-center justify-center",children:"success"===e7.kind?(0,r.jsx)(T,{className:"w-5 h-5"}):"error"===e7.kind?(0,r.jsx)(D,{className:"w-5 h-5"}):(0,r.jsx)(F,{className:"w-5 h-5"})}),(0,r.jsx)("span",{className:"leading-none",children:e7.message})]})}):null;(0,a.useEffect)(()=>{eC&&ti(!te)},[eC,te]),(0,a.useEffect)(()=>{if(!to)return;let e=e=>{let t=e.target;!t||tn.current&&tn.current.contains(t)||tc(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[to]),(0,a.useEffect)(()=>{if(!tg)return;let e=e=>{let t=e.target;!t||tx.current&&tx.current.contains(t)||tu(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[tg]),(0,a.useEffect)(()=>{tu(!1)},[c]),(0,a.useEffect)(()=>{try{let e=localStorage.getItem(G);("light"===e||"dark"===e||"system"===e)&&ty(e)}catch{}},[]),(0,a.useEffect)(()=>{let e="dark"===tm||"system"===tm&&tt;tb(e),document.documentElement.classList.toggle("dark",e);try{let t=document.querySelector('meta[name="theme-color"]');t&&t.setAttribute("content",e?"#111827":"#f9fafb")}catch{}try{localStorage.setItem(G,tm)}catch{}},[tt,tm]),(0,a.useEffect)(()=>{te||(ta(!1),tl(!1))},[te]),(0,a.useEffect)(()=>{if(!e){e$(!0),o([]),ei(null),ey([]),eS(null),eb([]),eI(null),e_(null),t1(!1),t5(!1),t8(!1),rL(!1),rv(!1),rb(""),ru(!1),ev("error"),eN("请登录后继续使用");return}an()},[e]);let r2=async e=>{try{return await e.clone().json()}catch{let t=await e.clone().text().catch(()=>"");return t?{error:t}:{}}},r5=async(e,t={},r=!0)=>{let a={...t.headers};a["content-type"]||"string"!=typeof t.body||(a["content-type"]="application/json");let s=i.current;s?.accessToken&&(a.Authorization=`Bearer ${s.accessToken}`);let l=await fetch(e,{...t,headers:a});if(401!==l.status||!r||!s?.refreshToken)return l;let d=await r0(s);return d?.accessToken?await r5(e,t,!1):l},r4=async(e,t)=>{if(!rV||!rZ)throw Error("Supabase 前端环境变量未配置");let r=await fetch(`${rV}/auth/v1/token?grant_type=password`,{method:"POST",headers:{apikey:rZ,"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await r2(r);if(!r.ok||!a.access_token||!a.refresh_token)throw Error(l(String(a.msg??a.error_description??a.error??"登录失败"),"登录失败，请重试。"));return{accessToken:String(a.access_token),refreshToken:String(a.refresh_token),userId:String((a.user?.id??"")||""),email:String((a.user?.email??e)||e)}},r8=async(e,t)=>{if(!rV||!rZ)throw Error("Supabase 前端环境变量未配置");let r=await fetch(`${rV}/auth/v1/signup`,{method:"POST",headers:{apikey:rZ,"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await r2(r);if(!r.ok)throw Error(l(String(a.msg??a.error_description??a.error??"注册失败"),"注册失败，请重试。"))},r6=async e=>{if(!rV||!rZ)throw Error("Supabase 前端环境变量未配置");let t=`${window.location.origin}${window.location.pathname}`,r=await fetch(`${rV}/auth/v1/recover`,{method:"POST",headers:{apikey:rZ,"Content-Type":"application/json"},body:JSON.stringify({email:e,options:t?{redirectTo:t}:void 0})}),a=await r2(r);if(!r.ok)throw Error(l(String(a.msg??a.error_description??a.error??"发送重置邮件失败"),"发送重置邮件失败，请重试。"))},r3=async(e,t)=>{if(!rV||!rZ)throw Error("Supabase 前端环境变量未配置");let r=await fetch(`${rV}/auth/v1/user`,{method:"PUT",headers:{apikey:rZ,Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({password:t})}),a=await r2(r);if(!r.ok)throw Error(l(String(a.msg??a.error_description??a.error??"重置密码失败"),"重置密码失败，请重试。"))},r9=async e=>{e.preventDefault(),rk("");let t=rs.trim(),r=rd.trim();if(!t||!r)return void rk("请输入邮箱和密码");try{ek(!0);let e=await r4(t,r);d(e),rY(e,rO),e$(!1),ev("checking"),eN(null),rk(""),e9("登录成功")}catch(e){rk(l(e,"登录失败，请重试。")||"登录失败，请重试。")}finally{ek(!1)}},r7=async e=>{e?.preventDefault(),rb("");let t=rn.trim(),r=rc.trim();if(!t||!r)return void e9("请填写完整注册信息");if(r.length<6)return void e9("密码至少 6 位");if(!rm)return void e9("请先勾选同意用户协议和隐私政策");try{ek(!0),await r8(t,r),rx(""),ry(!1),rl(t),rb("注册成功，请前往邮箱完成验证后再登录。")}catch(e){e9(l(e,"注册失败，请重试。")||"注册失败")}finally{ek(!1)}},ae=async()=>{let e=rj.trim();if(!e)return void e9("请输入注册邮箱");try{ek(!0),await r6(e),rv(!1),rl(e),e9("重置邮件已发送，请前往邮箱继续")}catch(e){e9(l(e,"发送重置邮件失败，请重试。")||"发送重置邮件失败")}finally{ek(!1)}},at=async()=>{let e=rC.trim(),t=rM.trim();if(!rE?.accessToken)return void e9("重置会话已失效，请重新发起忘记密码");if(!e||!t)return void e9("请填写完整的新密码");if(e.length<6)return void e9("新密码至少 6 位");if(e!==t)return void e9("两次输入的新密码不一致");try{ek(!0),await r3(rE.accessToken,e),rS(!1),r$(""),rI(""),r_(null),ri(""),e9("密码重置成功，请使用新密码登录")}catch(e){e9(l(e,"重置密码失败，请重试。")||"重置密码失败")}finally{ek(!1)}},ar=async()=>{let e=rz.trim(),t=rP.trim();if(!e||!t)return void e9("请填写完整的新密码信息");if(e.length<6)return void e9("新密码至少 6 位");if(e!==t)return void e9("两次输入的新密码不一致");try{ek(!0);let t=await r5("/api/account",{method:"PATCH",body:JSON.stringify({password:e})}),r=await r2(t);if(!t.ok)throw Error(String(r.error??"修改密码失败"));t5(!1),rT(""),rA(""),ai(),e9("密码修改成功，已退出登录，请使用新密码重新登录")}catch(e){e9(l(e,"修改密码失败，请重试。")||"修改密码失败")}finally{ek(!1)}},aa=async()=>{if("注销"!==rB.trim())return void e9("请输入“注销”确认此操作");try{ek(!0);let e=await r5("/api/account",{method:"DELETE"}),t=await r2(e);if(!e.ok)throw Error(String(t.error??"注销账号失败"));t8(!1),rU(""),ai(),e9("账号已注销")}catch(e){e9(l(e,"注销账号失败，请重试。")||"注销账号失败")}finally{ek(!1)}},as=()=>rH({bucketLabel:"",bucketName:"",accountId:"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:"",customBaseUrl:""}),al=async()=>{let e=!!tG,t={bucketLabel:rD.bucketLabel.trim(),bucketName:rD.bucketName.trim(),accountId:rD.accountId.trim(),accessKeyId:rD.accessKeyId.trim(),secretAccessKey:rD.secretAccessKey.trim(),publicBaseUrl:rD.publicBaseUrl.trim(),customBaseUrl:rD.customBaseUrl.trim(),isDefault:!e&&0===n.length},r={};if(t.bucketName||(r.bucketName="此项必填"),t.accountId||(r.accountId="此项必填"),e||t.accessKeyId||(r.accessKeyId="此项必填"),e||t.secretAccessKey||(r.secretAccessKey="此项必填"),Object.keys(r).length>0)return void rW(r);rW({});try{ek(!0);let r=e?await r5("/api/buckets",{method:"PATCH",body:JSON.stringify({id:tG,bucketLabel:t.bucketLabel,bucketName:t.bucketName,accountId:t.accountId,accessKeyId:t.accessKeyId||void 0,secretAccessKey:t.secretAccessKey||void 0,publicBaseUrl:t.publicBaseUrl,customBaseUrl:t.customBaseUrl})}):await r5("/api/buckets",{method:"POST",body:JSON.stringify(t)}),a=await r2(r);if(!r.ok)throw Error(String(a.error??(e?"更新失败":"创建失败")));let s=a.bucket;tY(!1),tQ(null),rW({}),as(),await an();let l=e?"存储桶已更新":"存储桶已添加";if(s?.id||c){let e=s?.id??c;if(!e)return;eb([]),eV(""),eA(null),eU(new Set),ei(e);try{let r=await r5(`/api/bucket-check?bucketId=${encodeURIComponent(e)}&bucketName=${encodeURIComponent(t.bucketName)}`),a=await r2(r),s=!!a.ok,d=String(a.hint??"").trim();ag(e,{bucketName:t.bucketName,ok:s,hint:d||void 0,checkedAt:Date.now()}),!s&&d&&(l=`存储桶已保存，但连通性校验失败：${d}`)}catch{}}e9(l)}catch(t){e9(l(t,e?"更新存储桶失败，请重试。":"添加存储桶失败，请重试。")||(e?"更新存储桶失败":"添加存储桶失败"))}finally{ek(!1)}},ad=async e=>{if(e)try{ek(!0);let t=await r5(`/api/buckets?id=${encodeURIComponent(e)}`,{method:"DELETE"}),r=await r2(t);if(!t.ok)throw Error(String(r.error??"删除失败"));t3(!1),t7(null),await an(),e9("存储桶已删除")}catch(e){e9(l(e,"删除存储桶失败，请重试。")||"删除存储桶失败")}finally{ek(!1)}},ai=()=>{rY(null,!1),d(null),o([]),ei(null),eS(null),eI(null),e_(null),eA(null),eU(new Set),eL(null),eJ([]),eK(!1),eH(!1),tk(!1),tN(!1),tA(!1),t1(!1),t5(!1),t8(!1),rL(!1),tJ(!1),t7(null),t3(!1),rT(""),rA(""),rU(""),rv(!1),rN(""),rS(!1),r$(""),rI(""),r_(null),rb(""),ru(!1),e$(!0),ev("error"),eN("已退出登录，请重新输入邮箱和密码"),rl(""),ri(""),rK(!1),ek(!1),e9("退出登录成功")},an=async()=>{if(!i.current)return void e$(!0);ev("checking"),eN(null);try{let e=await r5("/api/buckets"),t=await e.json().catch(()=>({}));if(401===e.status){rY(null,!1),d(null),e$(!0),ev("error"),eN("登录已失效，请重新登录");return}if(e.ok&&t.buckets){let e=t.buckets??[];if(e$(!1),o(e),e2(t=>{let r={...t};for(let t of e)r[t.id]={publicBaseUrl:t.publicBaseUrl??r[t.id]?.publicBaseUrl,customBaseUrl:t.customBaseUrl??r[t.id]?.customBaseUrl,s3BucketName:t.bucketName??r[t.id]?.s3BucketName};return localStorage.setItem("r2_link_config_v1",JSON.stringify(r)),r}),0===e.length)ei(null),ey([]),eS(null),eI(null),e_(null),eb([]),ev("unbound"),eN("未配置存储桶：请先新增一个存储桶");else if(ev("connected"),!c||!e.some(e=>e.id===c)){let t=e.find(e=>e.isDefault)?.id??e[0].id;ei(t)}}else if(ev("error"),t.error){let e=l(String(t.error),"连接失败，请稍后重试。");eN(e),e9(`连接失败: ${e}`)}}catch(e){ev("error"),eN("网络或运行时异常"),console.error(e)}},ao=async(e,t)=>{if(!e)return;ek(!0),eS(null);let r=t.length>0?t.join("/")+"/":"";try{let t=await r5(`/api/files?bucket=${encodeURIComponent(e)}&prefix=${encodeURIComponent(r)}`),a=await r2(t);if(!t.ok){ey([]);let e=l(a.error,"读取文件列表失败");eS(e),ev("error"),eN(null),e_(null);return}ey(Array.isArray(a.items)?a.items??[]:[]),eS(null),ev("connected"),eN(null)}catch(e){ey([]),eS("读取文件列表失败，请检查桶配置或网络"),ev("error"),eN(null),e_(null),console.error(e)}finally{ek(!1)}},ac=async(e,t)=>{let r=t.trim();if(!r){eX([]),eG(null);return}e0(!0);try{let t=await r5(`/api/search?bucket=${encodeURIComponent(e)}&q=${encodeURIComponent(r)}&limit=200`),a=await t.json();t.ok?(eX(a.items||[]),eG(a.cursor??null)):(eX([]),eG(null))}finally{e0(!1)}},ax=async e=>{eT(!0),e_(null);try{let t=await r5(`/api/usage?bucket=${encodeURIComponent(e)}&maxPages=10`),r=await r2(t);if(t.ok){let t={bucket:String(r.bucket??e),prefix:String(r.prefix??""),objects:Math.max(0,Math.floor(ea(r.objects,0))),bytes:Math.max(0,ea(r.bytes,0)),pagesScanned:Math.max(0,Math.floor(ea(r.pagesScanned,0))),truncated:!!r.truncated};eI(t),e_(null)}else eI(null),e_(String(r.error??"桶占用估算失败"))}catch{eI(null),e_("桶占用估算失败，请检查桶配置或网络")}finally{eT(!1)}};(0,a.useEffect)(()=>{c&&(ao(c,eh),eA(null),eU(new Set))},[c,eh,e]),(0,a.useEffect)(()=>{if(!c){eX([]),eG(null);return}let e=eW.trim();if(!e){eX([]),eG(null);return}let t=setTimeout(()=>{ac(c,e).catch(()=>{})},250);return()=>clearTimeout(t)},[eW,c,e]),(0,a.useEffect)(()=>{c&&ax(c)},[c,e]);let ag=(e,t)=>{e4(r=>{let a={...r,[e]:t};return localStorage.setItem("r2_s3_bucket_check_v1",JSON.stringify(a)),a})},au=(e,t)=>{e6(r=>{let a={...r,[e]:t};return localStorage.setItem("r2_transfer_mode_override_v1",JSON.stringify(a)),a})},am=e=>e8[e]??"auto",ay=e=>e?e1[e]??{}:{},ah=e=>{if(!e)return null;let t=(ay(e).s3BucketName??"").trim();if(!t)return null;let r=e5[e];return r&&r.bucketName===t?r:null},ab=e=>{let t=(ay(e).s3BucketName??"").trim();if(!t)return"";let r=ah(e);return r&&!1===r.ok?"":t},ap=e=>{if(!e)return;let t=e.trim();if(!t)return;let r=/^https?:\/\//i.test(t)?t:`https://${t}`;return r.endsWith("/")?r:`${r}/`},ak=e=>{let t=e.split("?")[0].split("/"),r=t[t.length-1]||"",a=r.lastIndexOf(".");return a<=0||a===r.length-1?"":r.slice(a+1).toLowerCase()},af=e=>{if("folder"===e.type)return"DIR";let t=ak(e.name);return t?t.toUpperCase():"FILE"},av=async e=>{try{await navigator.clipboard.writeText(e)}catch{let t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),document.body.removeChild(t)}e9("已复制到剪贴板")},aj=e=>{eb([...eh,e]),eV("")},aN=e=>{eb(eh.slice(0,e+1)),eV("")},aw=async()=>{if(!c)return;let e=eW.trim();e?await ac(c,e):await ao(c,eh)},aS=()=>{c&&(tT(""),t_(!0))},aC=async()=>{if(!c)return;let e=tz.trim();if(!e)return void t_(!1);if(e.includes("/"))return void e9("文件夹名不支持 /");let t=eh.length>0?eh.join("/")+"/":"";try{if(ek(!0),!(await r5("/api/operate",{method:"POST",body:JSON.stringify({bucket:c,targetKey:`${t}${e}/`,operation:"mkdir"})})).ok)throw Error("mkdir failed");t_(!1),eV(""),await ao(c,eh),e9("新建文件夹成功")}catch{e9("新建文件夹失败，请重试")}finally{ek(!1)}},a$=()=>{!c||(0!==eB.size||eP)&&tJ(!0)},aM=async()=>{if(c)try{ek(!0);let e=Array.from(eB);if(e.length>0){if(!(await r5("/api/operate",{method:"POST",body:JSON.stringify({bucket:c,sourceKeys:e,operation:"deleteMany"})})).ok)throw Error("delete failed")}else if(!eP)return void tJ(!1);else if("folder"===eP.type){if(!(await r5("/api/operate",{method:"POST",body:JSON.stringify({bucket:c,sourceKey:eP.key,operation:"delete"})})).ok)throw Error("delete failed")}else if(!(await r5(`/api/files?bucket=${c}&key=${encodeURIComponent(eP.key)}`,{method:"DELETE"})).ok)throw Error("delete failed");tJ(!1),await aw(),eA(null),eU(new Set),e9("删除成功")}catch{e9("删除失败，请刷新后重试")}finally{ek(!1)}},aI=()=>{c&&eP&&(tv(eP.name),tk(!0))},aE=()=>{if(c){if(1===eB.size)return void(()=>{if(!c)return;let e=Array.from(eB);if(1!==e.length)return e9("请选择 1 个文件/文件夹进行重命名");let t=a1.find(t=>t.key===e[0]);t?a_(t):e9("未找到选中文件")})();if(eP)return void aI();e9("请选择 1 个文件/文件夹进行重命名")}},a_=e=>{c&&(eA(e),tv(e.name),tk(!0))},az=async()=>{if(!c||!eP)return;let e=tf.trim();if(!e||e===eP.name)return void tk(!1);let t=eP.key,r="";if("folder"===eP.type){let e=(t.endsWith("/")?t.slice(0,-1):t).split("/").filter(Boolean);r=e.length>1?`${e.slice(0,-1).join("/")}/`:""}else{let e=t.split("/").filter(Boolean);r=e.length>1?`${e.slice(0,-1).join("/")}/`:""}let a=r+e+("folder"===eP.type?"/":"");try{if(ek(!0),!(await r5("/api/operate",{method:"POST",body:JSON.stringify({bucket:c,sourceKey:eP.key,targetKey:a,operation:"move"})})).ok)throw Error("rename failed");tk(!1),await aw(),eA(null),eU(new Set),e9("重命名成功")}catch{e9("重命名失败，请刷新后重试")}finally{ek(!1)}},aT=e=>{c&&eP&&(tS(e),t$(eh.length?eh.join("/")+"/":""),tI([eP.key]),tN(!0))},aP=(e,t)=>{c&&(eA(e),tS(t),t$(eh.length?eh.join("/")+"/":""),tI([e.key]),tN(!0))},aA=()=>{if(!c)return;let e=Array.from(eB).filter(e=>!e.endsWith("/"));e.length?(tS("move"),t$(eh.length?eh.join("/")+"/":""),tI(e),tN(!0)):e9("暂不支持文件夹整体移动")},aB=async()=>{if(!c)return;let e=tC.trim();if(!e)return void tN(!1);let t=e;t.startsWith("/")&&(t=t.slice(1));let r=tM.length?tM:eP?[eP.key]:[];if(r.length)try{let e,a;ek(!0);let s="move"===tw?"move":"copy";if(!(r.length>1||!eP||r[0]!==eP.key?await r5("/api/operate",{method:"POST",body:JSON.stringify({bucket:c,sourceKeys:r,targetPrefix:t,operation:"move"===s?"moveMany":"copyMany"})}):await r5("/api/operate",{method:"POST",body:JSON.stringify({bucket:c,sourceKey:eP.key,targetKey:(e="folder"===eP.type?"/":"",a=t,t.endsWith("/")?a=t+eP.name+e:"folder"!==eP.type||a.endsWith("/")||(a+="/"),a),operation:s})})).ok)throw Error("operate failed");tN(!1),tI([]),await aw(),eA(null),eU(new Set),e9("move"===tw?"已移动":"已复制")}catch{e9("move"===tw?"移动失败":"复制失败")}finally{ek(!1)}},aU=async(e,t,r)=>{let a=new URLSearchParams;a.set("bucket",e),a.set("key",t),r&&a.set("filename",r),"proxy"===am(e)&&a.set("forceProxy","1");let s=ab(e);s&&a.set("bucketName",s);let l=await r5(`/api/download?${a.toString()}`),d=await l.json();if(!l.ok||!d.url)throw Error(d.error||"download url failed");return d.url},aR=async(e,t,r)=>{let a=ab(e),s=am(e),l=a?`&bucketName=${encodeURIComponent(a)}`:"",d=await r5(`/api/download?bucket=${encodeURIComponent(e)}&key=${encodeURIComponent(t)}&download=1&filename=${encodeURIComponent(r)}${l}${"proxy"===s?"&forceProxy=1":""}`),i=await d.json();if(!d.ok||!i.url)throw Error(i.error||"download url failed");return i.url},aL=async e=>{if(c){if("folder"===e.type)return void e9("文件夹打包下载下一步做（当前先支持文件下载）");try{let t=await aR(c,e.key,e.name);aO(t,e.name),e9("已拉起下载")}catch{e9("下载失败")}}},aO=(e,t)=>{let r=document.createElement("a");r.href=e,r.download=t,r.rel="noreferrer",document.body.appendChild(r),r.click(),document.body.removeChild(r)},aK=async()=>{if(!c)return;let e=Array.from(eB).filter(e=>!e.endsWith("/"));if(!e.length)return void e9("暂不支持文件夹整体批量下载");for(let t of(e9(`开始下载 ${e.length} 个文件`),e))try{let e=t.split("/").pop()||"download",r=await aR(c,t,e);aO(r,e),await new Promise(e=>setTimeout(e,150))}catch{}e9("已拉起批量下载")},aq=async()=>{if(!c)return;let e=ap(tB||void 0),t=ap(tR||void 0),r=tO.trim()||void 0;if(!r)return void e9("桶名不能为空");try{var a;let s=await r5(`/api/bucket-check?bucketId=${encodeURIComponent(c)}&bucketName=${encodeURIComponent(r)}`),l=await r2(s),d=!!l.ok,i=String(l.hint??"").trim();if(ag(c,{bucketName:r,ok:d,hint:i||void 0,checkedAt:Date.now()}),!d)return void e9(`桶名校验失败：${i||"请检查桶名"}`);let n=await r5("/api/buckets",{method:"PATCH",body:JSON.stringify({id:c,bucketName:r,publicBaseUrl:e,customBaseUrl:t})}),o=await r2(n);if(!n.ok)throw Error(String(o.error??"保存失败"));a={...e1,[c]:{publicBaseUrl:e,customBaseUrl:t,s3BucketName:r}},e2(a),localStorage.setItem("r2_link_config_v1",JSON.stringify(a)),tA(!1),e9("已保存链接设置（桶名校验通过）")}catch(t){let e=l(t,"保存失败，请重试。");ag(c,{bucketName:r,ok:!1,hint:e,checkedAt:Date.now()}),e9(e||"保存失败")}},aJ=async(e,t)=>{var r,a;if(!c)return;let s=ay(c),l=(r="public"===t?s.publicBaseUrl:s.customBaseUrl,a=e.key,r?r+a.split("/").map(encodeURIComponent).join("/"):null);l?await av(l):e9("public"===t?"未配置公共开发 URL":"未配置自定义域名")},aD=async e=>{if(!c||"folder"===e.type)return;let t=e.name.toLowerCase(),r=ak(e.name),a="other";"pdf"===r?a="pdf":/^(doc|docx|ppt|pptx|xls|xlsx)$/.test(r)?a="office":/\.(png|jpg|jpeg|gif|webp|svg)$/.test(t)?a="image":/\.(mp4|mov|mkv|webm)$/.test(t)?a="video":/\.(mp3|wav|flac|ogg)$/.test(t)?a="audio":/\.(txt|log|md|json|csv|ts|tsx|js|jsx|css|html|xml|yml|yaml)$/.test(t)&&(a="text");try{let t=await aU(c,e.key,e.name),r={name:e.name,key:e.key,bucket:c,kind:a,url:t};if(eL(r),"text"===a){let r=await fetch(t,{headers:{Range:"bytes=0-204799"}}),a=await r.text();eL(t=>t&&t.key===e.key?{...t,text:a}:t)}}catch{e9("预览失败")}},aH=e=>!Number.isFinite(e)||e<=0?"-":`${es(e)}/s`,aF=(e,t,r,a,s)=>new Promise((l,d)=>{let i=new XMLHttpRequest;if(i.open("PUT",e,!0),i.setRequestHeader("Content-Type",r||"application/octet-stream"),s){if(s.aborted)return void d(Error("上传已中止"));let e=()=>{try{i.abort()}catch{}};s.addEventListener("abort",e,{once:!0}),i.addEventListener("loadend",()=>{s.removeEventListener("abort",e)},{once:!0})}i.upload.onprogress=e=>{e.lengthComputable&&a(e.loaded,e.total)},i.onload=()=>{i.status>=200&&i.status<300?l({etag:i.getResponseHeader("ETag")}):d(Error(`上传失败（状态码：${i.status}）`))},i.onerror=()=>d(Error("网络异常，请重试")),i.onabort=()=>d(Error("上传已中止")),i.send(t)}),aW=async(e,t,r,a,s,d)=>{let i;try{i=await r5("/api/files",{method:"POST",body:JSON.stringify({bucket:t,key:r,contentType:a.type})})}catch(t){let e=t instanceof Error?t.message:String(t);throw Error(`请求上传签名失败：${e}`)}let n=await r2(i);if(!i.ok||!n.url)throw Error(l(n.error,`上传签名失败（状态码：${i.status}）`));await aF(n.url,a,a.type,e=>s(e),d)},aV=async(e,t,r,a,s,d)=>{let i,n=e=>1048576*Math.ceil(Math.max(8388608,Math.min(0x4000000,Math.ceil(e/6)))/1048576),o=ec(t,r,a),c=re.current.find(t=>t.id===e),x=c?.multipart,g=(i=ex()[o])&&"object"==typeof i?i:null,u=x?.uploadId??g?.uploadId??null,m=x?.partSize??g?.partSize??n(a.size),y=x?.parts??g?.parts??{};if(g&&(g.size!==a.size||g.lastModified!==a.lastModified)&&(u=x?.uploadId??null,y=x?.parts??{},em(o)),!u){let e;try{e=await r5("/api/multipart",{method:"POST",body:JSON.stringify({action:"create",bucket:t,key:r,contentType:a.type})})}catch(t){let e=t instanceof Error?t.message:String(t);throw Error(`创建分片上传失败：${e}`)}let s=await r2(e);if(!e.ok||!s.uploadId)throw Error(l(s.error,`创建分片上传失败（状态码：${e.status}）`));u=s.uploadId,y={},m=n(a.size)}aZ(e,e=>({...e,resumeKey:o,multipart:{uploadId:u,partSize:m,parts:y}})),eu(o,{bucket:t,key:r,size:a.size,lastModified:a.lastModified,name:a.name,uploadId:u,partSize:m,parts:y});let h=Math.ceil(a.size/m),b=new Map,p=Math.min(6,h),k=1,f=!1,v=async i=>{let n;if(y[String(i)])return;let c=(i-1)*m,x=Math.min(a.size,c+m),g=a.slice(c,x);try{n=await r5("/api/multipart",{method:"POST",body:JSON.stringify({action:"signPart",bucket:t,key:r,uploadId:u,partNumber:i})})}catch(t){let e=t instanceof Error?t.message:String(t);throw Error(`获取分片上传签名失败：${e}`)}let h=await r2(n);if(!n.ok||!h.url)throw Error(l(h.error,`分片签名失败（状态码：${n.status}）`));let p=Object.keys(y).reduce((e,t)=>{let r=Number.parseInt(t,10);if(!Number.isFinite(r)||r<=0)return e;let s=(r-1)*m;return e+Math.max(0,Math.min(a.size,s+m)-s)},0),{etag:k}=await aF(h.url,g,a.type,(e,t)=>{b.set(i,e);let r=Array.from(b.values()).reduce((e,t)=>e+t,0);s(Math.min(a.size,p+r)),e===t&&b.set(i,t)},d);if(!k)throw Error("上传响应缺少 ETag");y[String(i)]=k,aZ(e,e=>e.multipart?{...e,multipart:{...e.multipart,parts:{...e.multipart.parts,[String(i)]:k}}}:e),eu(o,{bucket:t,key:r,size:a.size,lastModified:a.lastModified,name:a.name,uploadId:u,partSize:m,parts:y})},j=async()=>{for(;;){if(f)return;let e=k++;if(e>h)return;await v(e)}};try{let e;await Promise.all(Array.from({length:Math.min(p,h)},j));let a=Object.entries(y).map(([e,t])=>({partNumber:Number.parseInt(e,10),etag:t})).filter(e=>Number.isFinite(e.partNumber)&&e.partNumber>0).sort((e,t)=>e.partNumber-t.partNumber);try{e=await r5("/api/multipart",{method:"POST",body:JSON.stringify({action:"complete",bucket:t,key:r,uploadId:u,parts:a})})}catch(t){let e=t instanceof Error?t.message:String(t);throw Error(`完成分片上传失败：${e}`)}let s=await r2(e);if(!e.ok)throw Error(l(s.error,`完成分片上传失败（状态码：${e.status}）`));em(o)}catch(i){f=!0;let a=re.current.find(t=>t.id===e),s=a?.status,l=d?.aborted===!0;throw l&&"paused"===s||l&&"canceled"===s&&(await r5("/api/multipart",{method:"POST",body:JSON.stringify({action:"abort",bucket:t,key:r,uploadId:u})}).catch(()=>{}),em(o)),i}},aZ=(e,t)=>{eJ(r=>r.map(r=>r.id===e?t(r):r))},aX=e=>{eJ(t=>t.map(t=>t.id===e&&("paused"===t.status||"error"===t.status)?{...t,status:"queued",speedBps:0,startedAt:void 0,error:void 0}:t)),eH(!1),setTimeout(()=>aQ(),0)},aY=async e=>{let t=re.current.find(t=>t.id===e);if(t?.multipart?.uploadId)try{await r5("/api/multipart",{method:"POST",body:JSON.stringify({action:"abort",bucket:t.bucket,key:t.key,uploadId:t.multipart.uploadId})})}catch{}finally{t.resumeKey&&em(t.resumeKey)}},aG=e=>{eJ(t=>t.map(t=>t.id===e&&("queued"===t.status||"uploading"===t.status||"paused"===t.status)?{...t,status:"canceled",speedBps:0}:t)),rr.current.get(e)?.abort(),aY(e),e9("已取消")},aQ=async()=>{if(!rt.current&&!ra.current){rt.current=!0;try{for(;!ra.current;){let e=re.current.find(e=>"queued"===e.status);if(!e)break;let t=new AbortController;rr.current.set(e.id,t),aZ(e.id,e=>({...e,status:"uploading",startedAt:performance.now(),loaded:"number"==typeof e.loaded&&e.loaded>0?e.loaded:0,speedBps:0,error:void 0}));let r=e.file.size>=0x4600000?aV:aW,a=performance.now(),s=e.loaded??0;try{await r(e.id,e.bucket,e.key,e.file,t=>{let r=performance.now(),l=Math.max(0,t-s),d=Math.max(.25,(r-a)/1e3),i=l/d;a=r,s=t,aZ(e.id,e=>({...e,loaded:t,speedBps:Number.isFinite(i)?i:0}))},t.signal),aZ(e.id,e=>({...e,status:"done",loaded:e.file.size,speedBps:0,multipart:void 0})),c===e.bucket&&ao(e.bucket,eh),e.resumeKey&&em(e.resumeKey)}catch(a){let t=a instanceof Error?a.message:String(a),r=re.current.find(t=>t.id===e.id);r?.status==="paused"||r?.status==="canceled"||aZ(e.id,e=>({...e,status:"error",error:t,speedBps:0}))}finally{rr.current.delete(e.id)}}}finally{rt.current=!1}}},a0=async e=>{if(!e.target.files||!c)return;let t=Array.from(e.target.files),r=eh.length>0?eh.join("/")+"/":"",a=t.map(e=>({id:globalThis.crypto?.randomUUID?.()??`${Date.now()}_${Math.random().toString(16).slice(2)}`,bucket:c,file:e,key:r+e.name,resumeKey:ec(c,r+e.name,e),loaded:0,speedBps:0,status:"queued"}));eJ(e=>[...a,...e].slice(0,50)),eK(!0),e9(`已加入 ${a.length} 个上传任务`),eF.current&&(eF.current.value=""),setTimeout(()=>aQ(),0)},a1=(0,a.useMemo)(()=>eW.trim()?eZ:eg,[eg,eZ,eW]),a2=(0,a.useMemo)(()=>{let e=eq.reduce((e,t)=>e+t.file.size,0),t=eq.reduce((e,t)=>e+Math.min(t.loaded,t.file.size),0),r=eq.filter(e=>"queued"===e.status||"uploading"===e.status).length,a=eq.reduce((e,t)=>e+("uploading"===t.status?t.speedBps:0),0),s=e?Math.min(100,Math.round(t/e*100)):0;return{active:r,total:eq.length,pct:s,speedText:aH(a)}},[eq]),a5=(0,a.useMemo)(()=>{let e=eg.filter(e=>"file"===e.type).length;return{fileCount:e,folderCount:eg.filter(e=>"folder"===e.type).length,totalSize:eg.reduce((e,t)=>e+(t.size||0),0)}},[eg]),a4=(e,t,a="lg")=>{let s="lg"===a?"w-8 h-8":"w-5 h-5";if("folder"===e)return(0,r.jsx)(x,{className:`${s} text-yellow-500 ${"lg"===a?"fill-yellow-500/20":""}`});let l=t.toLowerCase(),d=ak(t);return/\.(jpg|png|gif|webp|svg)$/.test(l)?(0,r.jsx)(N,{className:`${s} text-purple-500`}):/\.(mp4|mov|mkv|webm)$/.test(l)?(0,r.jsx)(S,{className:`${s} text-red-500`}):/\.(mp3|wav|flac|ogg)$/.test(l)?(0,r.jsx)(w,{className:`${s} text-blue-500`}):/(zip|rar|7z|tar|gz|bz2|xz)$/.test(d)?(0,r.jsx)($,{className:`${s} text-amber-600`}):/(xls|xlsx|csv)$/.test(d)?(0,r.jsx)(I,{className:`${s} text-emerald-600`}):"json"===d?(0,r.jsx)(_,{className:`${s} text-orange-600`}):"pdf"===d?(0,r.jsx)(E,{className:`${s} text-rose-600`}):/(doc|docx|ppt|pptx)$/.test(d)?(0,r.jsx)(E,{className:`${s} text-sky-600`}):/(apk|ipa|dmg|pkg|exe|msi|deb|rpm)$/.test(d)?(0,r.jsx)(E,{className:`${s} text-slate-600`}):/(ts|tsx|js|jsx|css|html|xml|yml|yaml|md|txt|log|sh|bash|py|go|rs|java|kt|c|cpp|h|hpp)$/.test(d)?(0,r.jsx)(M,{className:`${s} text-indigo-600`}):(0,r.jsx)(j,{className:`${s} text-gray-400`})};if(eC){let e=!te||td;return(0,r.jsxs)("div",{className:`bg-gradient-to-br from-slate-50 via-white to-slate-50 dark:from-gray-950 dark:via-gray-950 dark:to-gray-900 px-4 sm:px-6 font-sans text-gray-900 dark:text-gray-100 pt-[max(1rem,env(safe-area-inset-top))] pb-[max(1rem,env(safe-area-inset-bottom))] ${te?"min-h-dvh overflow-y-auto":"h-dvh overflow-hidden flex items-center justify-center"}`,children:[(0,r.jsxs)("div",{className:`w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-6 ${te?"h-auto items-start":"h-full min-h-0 items-stretch"}`,children:[(0,r.jsxs)("section",{className:`min-h-0 rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col order-2 lg:order-1 dark:border-gray-800 dark:bg-gray-900 ${e?"":"hidden"}`,children:[(0,r.jsx)("div",{className:"px-8 py-7 h-[168px] bg-gradient-to-br from-indigo-600 to-blue-600 text-white flex items-center",children:(0,r.jsxs)("div",{className:"w-full",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-white/85",children:el.title}),(0,r.jsx)("h1",{className:"mt-2 text-3xl font-semibold tracking-tight",children:"公告与说明"}),(0,r.jsx)("p",{className:"mt-2 text-white/80",children:el.subtitle})]})}),(0,r.jsxs)("div",{className:["px-8 py-6 flex flex-col gap-5",te?"":"grow overflow-y-auto"].filter(Boolean).join(" "),children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:"平台优势"}),(0,r.jsx)("ul",{className:"mt-3 space-y-2 text-sm text-gray-800 dark:text-gray-200",children:el.advantages.map(e=>(0,r.jsxs)("li",{className:"flex gap-3",children:[(0,r.jsx)("span",{className:"mt-2 h-1.5 w-1.5 rounded-full bg-blue-600 flex-none"}),(0,r.jsx)("span",{className:"leading-relaxed",children:e})]},e))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:el.announcementTitle}),(0,r.jsx)("div",{className:"mt-3 rounded-2xl border border-gray-200 bg-gray-50 p-4 text-sm text-gray-700 whitespace-pre-wrap leading-relaxed dark:border-gray-800 dark:bg-gray-950/30 dark:text-gray-200",children:el.announcementText})]}),(0,r.jsxs)("div",{className:"mt-auto",children:[(0,r.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:"导航"}),(0,r.jsx)("nav",{className:"mt-3 grid grid-cols-4 gap-2",children:ed.map(e=>{let t="globe"===e.icon?(0,r.jsx)(H,{className:"w-5 h-5"}):"book"===e.icon?(0,r.jsx)(V,{className:"w-5 h-5"}):"about"===e.icon?(0,r.jsx)(F,{className:"w-5 h-5"}):(0,r.jsx)(W,{className:"w-5 h-5"});return(0,r.jsxs)("a",{href:e.href,target:e.href.startsWith("mailto:")?void 0:"_blank",rel:e.href.startsWith("mailto:")?void 0:"noreferrer",className:"group rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-colors px-2 py-3 flex flex-col items-center justify-center gap-2 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-900",children:[(0,r.jsx)("div",{className:"text-gray-700 group-hover:text-blue-600 transition-colors dark:text-gray-200 dark:group-hover:text-blue-300",children:t}),(0,r.jsx)("div",{className:"text-[12px] text-gray-700 group-hover:text-blue-600 transition-colors dark:text-gray-200 dark:group-hover:text-blue-300",children:e.label})]},e.href)})}),(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[(0,r.jsx)("span",{children:el.footer}),(0,r.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,r.jsx)("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),"Serverless"]})]})]})]})]}),(0,r.jsxs)("section",{className:"min-h-0 rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col order-1 lg:order-2 dark:border-gray-800 dark:bg-gray-900",children:[(0,r.jsx)("div",{className:"px-6 py-4 sm:px-8 sm:py-7 sm:h-[168px] bg-blue-600 text-white flex items-center shrink-0",children:(0,r.jsxs)("div",{className:"flex items-center gap-4 w-full",children:[(0,r.jsx)("div",{className:"h-16 w-16 flex items-center justify-center shrink-0",children:(0,r.jsx)(ee,{className:"w-16 h-16"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-2xl font-semibold leading-tight",children:el.title}),(0,r.jsx)("div",{className:"mt-1 text-[17px] text-white/80",children:el.subtitle})]})]})}),(0,r.jsxs)("div",{className:["px-8 py-7 flex flex-col gap-5",te?"":"grow overflow-y-auto"].filter(Boolean).join(" "),children:[(0,r.jsx)("div",{className:"mx-auto w-full max-w-sm",children:(0,r.jsxs)("div",{className:"relative grid grid-cols-2 rounded-xl border border-gray-200 bg-gray-50 p-1 dark:border-gray-800 dark:bg-gray-950/40",children:[(0,r.jsx)("span",{"aria-hidden":"true",className:`absolute left-1 top-1 bottom-1 w-[calc(50%-0.25rem)] rounded-lg bg-blue-600 transition-transform duration-300 ease-out ${tV?"translate-x-full":"translate-x-0"}`}),(0,r.jsx)("button",{type:"button",onClick:()=>{tZ(!1),rk("")},className:`relative z-10 rounded-lg py-2 text-sm font-semibold transition-colors ${tV?"text-gray-600 dark:text-gray-300":"text-white"}`,children:"登陆"}),(0,r.jsx)("button",{type:"button",onClick:()=>{tZ(!0),rk("")},className:`relative z-10 rounded-lg py-2 text-sm font-semibold transition-colors ${tV?"text-white":"text-gray-600 dark:text-gray-300"}`,children:"注册"})]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight text-blue-600 dark:text-blue-400",children:tV?"账号注册":"账号登录"})}),(0,r.jsx)("div",{className:"min-h-[286px] sm:min-h-[296px]",children:tV?(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),r7(e)},className:"flex h-full flex-col",children:[(0,r.jsxs)("div",{className:"space-y-5 min-h-[210px]",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱账号"}),(0,r.jsx)("input",{type:"email",value:rn,onChange:e=>{ro(e.target.value),rb("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"登陆密码"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:rg?"text":"password",value:rc,onChange:e=>{rx(e.target.value),rb("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all pr-10 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"}),(0,r.jsx)("button",{type:"button",onClick:()=>ru(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":rg?"隐藏密码":"显示密码",children:rg?(0,r.jsx)(A,{className:"w-5 h-5"}):(0,r.jsx)(P,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3 py-0 min-h-9",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"register_agree",checked:rm,onChange:e=>{ry(e.target.checked),rb("")},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-700"}),(0,r.jsx)("label",{htmlFor:"register_agree",className:"ml-2 block text-sm text-gray-600 dark:text-gray-300",children:"我已阅读并同意「用户协议」和「隐私政策」"})]}),(0,r.jsx)("span",{"aria-hidden":"true",className:"shrink-0 px-2 py-1 text-sm invisible select-none",children:"忘记密码"})]})]}),(0,r.jsxs)("div",{className:"mt-auto pt-2 space-y-2",children:[(0,r.jsx)("div",{className:"min-h-4",children:rh?(0,r.jsx)("div",{className:"text-sm text-red-600 leading-tight text-left dark:text-red-300",children:rh}):null}),(0,r.jsxs)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors shadow-blue-500/20 shadow-lg inline-flex items-center justify-center gap-2",children:[(0,r.jsx)(T,{className:"w-5 h-5"}),"注册账号"]})]})]}):(0,r.jsxs)("form",{onSubmit:r9,className:"flex h-full flex-col",children:[(0,r.jsxs)("div",{className:"space-y-5 min-h-[210px]",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱账号"}),(0,r.jsx)("input",{type:"email",value:rs,onChange:e=>{rl(e.target.value),rk("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"登陆密码"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:rq?"text":"password",value:rd,onChange:e=>{ri(e.target.value),rk("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all pr-10 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入密码"}),(0,r.jsx)("button",{type:"button",onClick:()=>rJ(!rq),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:rq?(0,r.jsx)(A,{className:"w-5 h-5"}):(0,r.jsx)(P,{className:"w-5 h-5"})})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3 py-0 min-h-9",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"remember",checked:rO,onChange:e=>rK(e.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-700"}),(0,r.jsx)("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-600 dark:text-gray-300",children:"记住登录状态"})]}),(0,r.jsx)("button",{type:"button",onClick:()=>{rN(rs.trim()),rv(!0)},className:"shrink-0 px-2 py-1 rounded-md text-sm text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition-colors dark:text-gray-300 dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:"忘记密码"})]})]}),(0,r.jsxs)("div",{className:"mt-auto pt-2 space-y-2",children:[(0,r.jsx)("div",{className:"min-h-4",children:rp?(0,r.jsx)("div",{className:"text-sm text-red-600 leading-tight text-left dark:text-red-300",children:rp}):null}),(0,r.jsxs)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors shadow-blue-500/20 shadow-lg inline-flex items-center justify-center gap-2",children:[(0,r.jsx)(T,{className:"w-5 h-5"}),"进入管理"]})]})]})}),te?(0,r.jsxs)("button",{type:"button",onClick:()=>ti(e=>!e),className:"mt-1 inline-flex w-fit self-start items-center gap-1.5 px-0 py-0 text-xs font-medium text-gray-500 hover:text-blue-600 transition-colors dark:text-gray-400 dark:hover:text-blue-300",children:[td?"收起「公告与说明」":"展开「公告与说明」",(0,r.jsx)(v,{className:`w-3.5 h-3.5 transition-transform ${td?"rotate-180":""}`})]}):null]})]})]}),(0,r.jsx)(s,{open:rf,title:"找回密码",description:"输入注册邮箱，我们会发送重置密码邮件。",onClose:()=>rv(!1),footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>rv(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:()=>{ae()},disabled:ep,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"发送重置邮件"})]}),children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"注册邮箱"}),(0,r.jsx)("input",{type:"email",value:rj,onChange:e=>rN(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入注册邮箱"})]})}),(0,r.jsx)(s,{open:rw,title:"设置新密码",description:"请设置新的登陆密码，设置完成后使用新密码登录。",onClose:()=>rS(!1),footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>rS(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"稍后再说"}),(0,r.jsx)("button",{onClick:()=>{at()},disabled:ep,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"保存新密码"})]}),children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新密码"}),(0,r.jsx)("input",{type:"password",value:rC,onChange:e=>r$(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"确认新密码"}),(0,r.jsx)("input",{type:"password",value:rM,onChange:e=>rI(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"再次输入新密码"})]})]})}),r1]})}let a8=e=>{if(!e)return"";let t=n.find(t=>t.id===e);return t?.Name||e},a6=c?a8(c):null,a3=t9?n.find(e=>e.id===t9)??null:null,a9=!tG,a7=e=>e?n.find(t=>t.id===e)??null:null,se=e=>{ei(e),eb([]),eV(""),eA(null),eU(new Set),tc(!1),te&&ta(!1),e9(`已切换到：${a8(e)}`)},st=()=>{t1(!1),tQ(null),rW({}),as(),tY(!0)},sr=({onClose:t})=>{let a,s,l,d,i,o,x,g,u,m;return(0,r.jsxs)("div",{className:`h-full w-full bg-white border-r border-gray-200 flex flex-col dark:bg-gray-900 dark:border-gray-800 ${t?"shadow-sm":""}`,children:[(0,r.jsxs)("div",{className:"h-16 px-5 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,r.jsx)(ee,{className:"w-10 h-10 md:w-11 md:h-11 shrink-0"}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("h1",{className:"font-bold text-[18px] leading-[1.15] tracking-tight text-blue-600 truncate dark:text-blue-400",children:el.title}),(0,r.jsx)("p",{className:"mt-0.25 text-[13px] leading-[1.1] text-gray-400 font-medium truncate dark:text-gray-400",children:el.subtitle})]})]}),(0,r.jsx)("div",{className:"flex items-center gap-1",children:t?(0,r.jsx)("button",{type:"button",onClick:t,className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800","aria-label":"关闭菜单",children:(0,r.jsx)(K,{className:"w-5 h-5"})}):null})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col overflow-y-auto",children:[(0,r.jsx)("div",{className:"p-3 space-y-3 shrink-0",children:(0,r.jsxs)("div",{className:"px-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase px-2 tracking-wider leading-none dark:text-gray-400",children:"存储桶"}),(0,r.jsx)("div",{className:"flex items-center gap-1",children:(0,r.jsx)("button",{type:"button",onClick:()=>{an(),e9("已刷新桶列表")},className:"px-2 py-1 rounded-md text-xs font-medium text-blue-600 hover:bg-blue-50 leading-none dark:text-blue-300 dark:hover:bg-blue-950/30",title:"刷新桶列表","aria-label":"刷新桶列表",children:"刷新"})})]}),te?(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsxs)("select",{value:c??"",onChange:e=>{let t=e.target.value;t&&se(t)},className:"w-full rounded-xl border border-gray-200 bg-white px-3 py-2.5 text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-label":"选择存储桶",children:[(0,r.jsx)("option",{value:"",disabled:!0,children:"选择存储桶"}),n.map(e=>(0,r.jsx)("option",{value:e.id,children:a8(e.id)},e.id))]})}):(0,r.jsxs)("div",{ref:tn,className:"relative mt-2",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>tc(e=>!e),className:"w-full rounded-xl border border-gray-200 bg-white px-3 py-2.5 text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 flex items-center justify-between gap-3","aria-haspopup":"listbox","aria-expanded":to,children:[(0,r.jsx)("span",{className:"truncate",children:c?a8(c):"选择存储桶"}),(0,r.jsx)(v,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform ${to?"rotate-180":""}`})]}),to?(0,r.jsx)("div",{className:"absolute left-0 right-0 top-[calc(100%+0.5rem)] z-20 rounded-2xl border border-gray-200 bg-white shadow-xl overflow-hidden dark:border-gray-800 dark:bg-gray-900",children:(0,r.jsx)("div",{className:"max-h-[40vh] overflow-auto p-2",children:n.length?n.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>se(e.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm transition-colors ${c===e.id?"bg-blue-50 text-blue-700 font-medium dark:bg-blue-950/40 dark:text-blue-200":"text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-800"}`,children:[(0,r.jsx)("div",{className:`w-2 h-2 rounded-full ${c===e.id?"bg-blue-500":"bg-gray-300 dark:bg-gray-700"}`}),(0,r.jsx)("span",{className:"truncate",children:a8(e.id)})]},e.id)):(0,r.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 dark:text-gray-400",children:"暂无桶"})})}):null]}),(0,r.jsx)("div",{className:"mt-2 text-[10px] text-gray-500 px-1 leading-relaxed dark:text-gray-400",children:"桶管理入口已移至底部「当前登录账号」模块。"})]})}),(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50/50 space-y-3 dark:border-gray-800 dark:bg-gray-950/30 shrink-0",children:[(0,r.jsxs)("div",{className:`text-xs px-3 py-2 rounded-md border ${"connected"===ef?"bg-green-50 text-green-700 border-green-100 dark:bg-green-950/40 dark:text-green-200 dark:border-green-900":"checking"===ef?"bg-yellow-50 text-yellow-700 border-yellow-100 dark:bg-yellow-950/35 dark:text-yellow-200 dark:border-yellow-900":"unbound"===ef?"bg-blue-50 text-blue-700 border-blue-100 dark:bg-blue-950/40 dark:text-blue-200 dark:border-blue-900":"bg-red-50 text-red-700 border-red-100 dark:bg-red-950/40 dark:text-red-200 dark:border-red-900"}`,children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(et,{className:"w-3 h-3"}),(0,r.jsx)("span",{className:"font-medium",children:"connected"===ef?"连接状态正常":"checking"===ef?"连接中...":"unbound"===ef?"未绑定存储桶":"连接异常"})]}),"connected"===ef?(a=c?n.find(e=>e.id===c)?.transferMode:void 0,s=c?ay(c):void 0,l=String(s?.s3BucketName??"").trim(),d=c?ah(c):null,i=c?am(c):"auto",o="当前传输通道：未检测",x=null,g="auto"===i?"":"（手动）","presigned"===a?(o="proxy"===i?`当前传输通道：Pages 代理${g}`:`当前传输通道：R2 直连${g}`,l&&(x=d?d.ok?null:`桶名校验失败：${l}，${d.hint||"请检查桶名"}（已忽略此桶名设置）`:null)):"presigned_needs_bucket_name"===a?l?d?d.ok?(o="proxy"===i?`当前传输通道：Pages 代理${g}`:`当前传输通道：R2 直连${g}`,x=null):(o=`当前传输通道：Pages 代理${g}`,x=`桶名校验失败：${l}${d.hint||"请检查桶名"}，无法启用「R2 直连」，已回退至「Pages 代理」`):(o="proxy"===i?`当前传输通道：Pages 代理${g}`:`当前传输通道：R2 直连${g}`,x=null):(o=`当前传输通道：Pages 代理${g}`,x="已配置 R2 直连，如需启动 R2 直连，请先在「编辑桶」中确认桶名并完成校验。"):"proxy"===a&&(o=`当前传输通道：Pages 代理${g}`),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mt-1 text-[11px] leading-relaxed opacity-80",children:o}),x?(0,r.jsx)("div",{className:"mt-1 text-[10px] leading-relaxed opacity-80",children:x}):null]})):null,ej&&!ew?(0,r.jsx)("div",{className:"mt-1 text-[10px] leading-relaxed opacity-80",children:ej}):null]}),"connected"===ef&&c?(0,r.jsx)("div",{className:"px-3 py-2 rounded-md border border-gray-200 bg-white text-xs text-gray-600 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("span",{className:"font-medium truncate",children:"选择传输通道"}),(u=am(c),m=n.find(e=>e.id===c)?.transferMode!=="proxy",te?(0,r.jsxs)("select",{value:u,onChange:e=>{let t=e.target.value||"auto";au(c,t),e9("auto"===t?"已切换传输模式（自动）":"presigned"===t?"已切换传输模式（R2 直连）":"已切换传输模式（Pages 代理）")},className:"shrink-0 rounded-md border border-gray-200 bg-white px-2 py-1 text-[12px] text-gray-700 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-label":"切换传输模式",title:"选择传输通道",children:[(0,r.jsx)("option",{value:"auto",children:"自动"}),(0,r.jsx)("option",{value:"presigned",disabled:!m,children:"R2 直连"}),(0,r.jsx)("option",{value:"proxy",children:"Pages 代理"})]}):(0,r.jsxs)("div",{ref:tx,className:"relative",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>tu(e=>!e),className:"inline-flex items-center gap-2 rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-700 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-haspopup":"listbox","aria-expanded":tg,title:"选择传输通道",children:[(0,r.jsx)("span",{className:"leading-none",children:"auto"===u?"自动":"presigned"===u?"R2 直连":"Pages 代理"}),(0,r.jsx)(v,{className:`w-3.5 h-3.5 opacity-70 transition-transform ${tg?"rotate-180":""}`})]}),tg?(0,r.jsx)("div",{className:"absolute right-0 top-[calc(100%+0.5rem)] z-30 min-w-[10rem] rounded-xl border border-gray-200 bg-white shadow-xl overflow-hidden dark:border-gray-800 dark:bg-gray-900",children:(0,r.jsx)("div",{className:"p-2 space-y-1",children:[{value:"auto",label:"自动",disabled:!1},{value:"presigned",label:"R2 直连",disabled:!m},{value:"proxy",label:"Pages 代理",disabled:!1}].map(e=>(0,r.jsxs)("button",{type:"button",disabled:e.disabled,onClick:()=>{tu(!1),au(c,e.value),e9("auto"===e.value?"已切换传输模式（自动）":"presigned"===e.value?"已切换传输模式（R2 直连）":"已切换传输模式（Pages 代理）")},className:["w-full flex items-center justify-between gap-3 px-3 py-2 rounded-lg text-[12px] transition-colors",e.value===u?"bg-blue-50 text-blue-700 font-medium dark:bg-blue-950/40 dark:text-blue-200":"text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-800",e.disabled?"opacity-50 cursor-not-allowed hover:bg-transparent dark:hover:bg-transparent":""].filter(Boolean).join(" "),role:"option","aria-selected":e.value===u,children:[(0,r.jsx)("span",{children:e.label}),(0,r.jsx)("span",{className:["w-2 h-2 rounded-full",e.value===u?"bg-blue-500":"bg-gray-300 dark:bg-gray-700"].join(" "),"aria-hidden":"true"})]},e.value))})}):null]}))]})}):null,(0,r.jsxs)("div",{className:"px-3 py-2 rounded-md border border-gray-200 bg-white text-xs text-gray-600 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsx)("span",{className:"font-medium truncate",children:"当前桶占用估算"}),(0,r.jsx)("button",{onClick:()=>c&&ax(c),disabled:!c||ez,className:"text-[11px] text-blue-600 hover:text-blue-700 disabled:opacity-50 dark:text-blue-300 dark:hover:text-blue-200",children:ez?"计算中...":"刷新"})]}),(0,r.jsxs)("div",{className:"mt-1.5 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"对象数"}),(0,r.jsx)("span",{className:"text-[11px] font-semibold text-gray-800 dark:text-gray-100",children:eM?eM.truncated?`≥${eM.objects}`:`${eM.objects}`:"-"})]}),(0,r.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"容量"}),(0,r.jsx)("span",{className:"text-[11px] font-semibold text-gray-800 dark:text-gray-100",children:eM?eM.truncated?`≥${es(eM.bytes)}`:es(eM.bytes):"-"})]}),eM?.truncated?(0,r.jsxs)("div",{className:"mt-1 text-[10px] text-gray-400 dark:text-gray-500",children:["仅扫描前 ",eM.pagesScanned," 页（每页最多 1000 项）"]}):null,eE&&!ew?(0,r.jsx)("div",{className:"mt-1 text-[10px] text-red-600 leading-relaxed dark:text-red-300",children:eE}):null]}),(0,r.jsxs)("button",{type:"button",onClick:()=>t1(!0),className:"w-full px-3 py-2 rounded-md border border-gray-200 bg-white text-left text-xs text-gray-600 hover:bg-gray-50 transition-colors dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200 dark:hover:bg-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-blue-50 text-blue-600 dark:bg-blue-950/40 dark:text-blue-300",children:(0,r.jsx)(X,{className:"h-5 w-5"})}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"font-medium truncate",children:"当前登录账号"}),(0,r.jsx)("div",{className:"mt-0.5 text-[11px] font-semibold text-gray-800 truncate dark:text-gray-100",children:e?.email?e.email:"未读取到邮箱"}),(0,r.jsxs)("div",{className:"mt-0.5 text-[10px] text-gray-500 dark:text-gray-400",children:["已绑定桶：",n.length]})]})]}),(0,r.jsx)("div",{className:"mt-2 text-[10px] text-gray-400 dark:text-gray-500",children:"点击进入账号中心，管理当前账号下的存储桶。"})]}),(0,r.jsxs)("button",{onClick:()=>tH(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-600 hover:bg-red-50 hover:text-red-600 hover:border-red-200 rounded-lg text-xs font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-red-950/40 dark:hover:text-red-200 dark:hover:border-red-900",children:[(0,r.jsx)(z,{className:"w-3 h-3"}),"退出登录"]})]})]})]})},sa=({onClose:e,compact:t})=>(0,r.jsxs)("div",{className:"h-full w-full bg-white border-l border-gray-200 flex flex-col shadow-sm dark:bg-gray-900 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"h-16 px-5 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,r.jsx)("h2",{className:"font-bold text-gray-800 text-sm uppercase tracking-wide dark:text-gray-100",children:"详细信息"}),e?(0,r.jsx)("button",{type:"button",onClick:e,className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800","aria-label":"关闭详情",children:(0,r.jsx)(K,{className:"w-5 h-5"})}):null]}),(0,r.jsxs)("div",{className:`flex-1 overflow-y-auto ${t?"p-4 space-y-5":"p-6 space-y-8"}`,children:[eP?(0,r.jsxs)("div",{className:`${t?"space-y-4":"space-y-6"} animate-in fade-in slide-in-from-right-4 duration-300`,children:[(0,r.jsxs)("div",{className:t?"flex items-center gap-3":"flex flex-col items-center",children:[(0,r.jsx)("div",{className:`${t?"w-14 h-14 rounded-xl":"w-16 h-16 rounded-2xl"} bg-gray-50 border border-gray-100 flex items-center justify-center ${t?"":"mb-4"} shadow-sm dark:bg-gray-950 dark:border-gray-800`,children:a4(eP.type,eP.name)}),(0,r.jsxs)("div",{className:t?"min-w-0 flex-1":"",children:[(0,r.jsx)("h3",{className:`font-semibold text-gray-900 ${t?"text-left break-words":"text-center break-all px-2"} leading-snug dark:text-gray-100`,children:eP.name}),t?(0,r.jsxs)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["folder"===eP.type?"文件夹":es(eP.size),eP.lastModified?` \xb7 ${new Date(eP.lastModified).toLocaleDateString()}`:""]}):(0,r.jsxs)("div",{className:"mt-2 flex flex-wrap items-center justify-center gap-2",children:[(0,r.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:af(eP)}),(0,r.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["folder"===eP.type?"文件夹":"文件","file"===eP.type?` \xb7 ${es(eP.size)}`:"",eP.lastModified?` \xb7 ${new Date(eP.lastModified).toLocaleDateString()}`:""]})]})]})]}),"folder"===eP.type?(0,r.jsxs)("div",{className:`grid grid-cols-2 ${t?"gap-2 pt-1":"gap-3 pt-2"}`,children:[(0,r.jsxs)("button",{onClick:()=>aj(eP.name),className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors col-span-2",children:[(0,r.jsx)(O,{className:"w-4 h-4"}),"打开文件夹"]}),(0,r.jsxs)("button",{onClick:aI,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(C,{className:"w-4 h-4"}),"重命名"]}),(0,r.jsxs)("button",{onClick:()=>aT("move"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(L,{className:"w-4 h-4"}),"移动"]}),(0,r.jsxs)("button",{onClick:()=>aT("copy"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(R,{className:"w-4 h-4"}),"复制"]}),(0,r.jsxs)("button",{onClick:a$,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-200 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-red-200 dark:hover:bg-red-950/40 dark:hover:border-red-900",children:[(0,r.jsx)(g,{className:"w-4 h-4"}),"删除"]})]}):(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[(0,r.jsxs)("button",{onClick:()=>aD(eP),className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors col-span-2",children:[(0,r.jsx)(P,{className:"w-4 h-4"}),"预览"]}),(0,r.jsxs)("button",{onClick:()=>aL(eP),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(B,{className:"w-4 h-4"}),"下载"]}),(0,r.jsxs)("button",{onClick:aI,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(C,{className:"w-4 h-4"}),"重命名"]}),(0,r.jsxs)("button",{onClick:()=>aT("move"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(L,{className:"w-4 h-4"}),"移动"]}),(0,r.jsxs)("button",{onClick:()=>aT("copy"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(R,{className:"w-4 h-4"}),"复制"]}),(0,r.jsxs)("button",{onClick:a$,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-200 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-red-200 dark:hover:bg-red-950/40 dark:hover:border-red-900",children:[(0,r.jsx)(g,{className:"w-4 h-4"}),"删除"]}),(0,r.jsxs)("button",{onClick:()=>aJ(eP,"public"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(U,{className:"w-4 h-4"}),"公共链接"]}),(0,r.jsxs)("button",{onClick:()=>aJ(eP,"custom"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,r.jsx)(U,{className:"w-4 h-4"}),"自定义链接"]})]})]}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 dark:bg-gray-950",children:(0,r.jsx)(h,{className:"w-6 h-6 text-gray-300 dark:text-gray-600"})}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm dark:text-gray-400",children:["选择一个文件以查看详情",(0,r.jsx)("br",{}),"或进行管理"]})]}),t?null:(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-100 dark:from-blue-950/35 dark:to-indigo-950/25 dark:border-blue-900",children:[(0,r.jsxs)("h3",{className:"text-xs font-bold text-blue-800 uppercase tracking-wider mb-4 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"当前视图统计"]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"文件数"}),(0,r.jsx)("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:a5.fileCount})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"文件夹数"}),(0,r.jsx)("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:a5.folderCount})]}),(0,r.jsx)("div",{className:"h-px bg-blue-200/50 my-2 dark:bg-blue-900/50"}),(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"总大小"}),(0,r.jsx)("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-200",children:es(a5.totalSize)})]})]})]})]}),(0,r.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50 text-[10px] text-gray-400 text-center dark:border-gray-800 dark:bg-gray-950/30 dark:text-gray-400",children:[(0,r.jsx)("p",{children:el.title}),(0,r.jsx)("p",{className:"mt-0.5",children:"R2对象存储多功能管理工具"})]})]});return(0,r.jsxs)("div",{className:"flex h-dvh md:h-screen bg-gray-50 text-gray-900 font-sans overflow-hidden dark:bg-gray-900 dark:text-gray-100",children:[(0,r.jsxs)("div",{className:`fixed inset-0 z-50 md:hidden ${tr?"":"pointer-events-none"}`,children:[(0,r.jsx)("button",{type:"button","aria-label":"关闭菜单",onClick:()=>ta(!1),className:`absolute inset-0 bg-black/40 transition-opacity ${tr?"opacity-100":"opacity-0"}`}),(0,r.jsx)("div",{className:`absolute inset-y-0 left-0 w-[18rem] max-w-[85vw] transition-transform duration-200 ${tr?"translate-x-0":"-translate-x-full"}`,children:(0,r.jsx)(sr,{onClose:()=>ta(!1)})})]}),(0,r.jsx)("div",{className:"hidden md:block w-[17rem] shrink-0",children:(0,r.jsx)(sr,{})}),(0,r.jsxs)("main",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-gray-900",children:[(0,r.jsxs)("div",{className:"border-b border-gray-200 bg-white shrink-0 dark:border-gray-800 dark:bg-gray-900",children:[(0,r.jsxs)("div",{className:"hidden md:flex h-16 border-b-0 items-center px-6 gap-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("button",{onClick:()=>c&&ao(c,eh),disabled:!c,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"刷新","aria-label":"刷新",children:[(0,r.jsx)(m,{className:`w-4 h-4 ${ep?"animate-spin":""}`}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"刷新"})]}),(0,r.jsxs)("button",{onClick:aK,disabled:0===eB.size,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"批量下载（所选文件）","aria-label":"下载",children:[(0,r.jsx)(B,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"下载"})]}),(0,r.jsxs)("button",{onClick:aA,disabled:0===eB.size,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"批量移动（所选文件）","aria-label":"移动",children:[(0,r.jsx)(L,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"移动"})]}),(0,r.jsxs)("button",{onClick:aE,disabled:eB.size>1||0===eB.size&&!eP,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"重命名（仅支持单选）","aria-label":"重命名",children:[(0,r.jsx)(C,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"重命名"})]}),(0,r.jsxs)("button",{onClick:a$,disabled:0===eB.size&&!eP,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-red-200 dark:hover:bg-red-950/40",title:"删除（所选项）","aria-label":"删除",children:[(0,r.jsx)(g,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-[10px] leading-none",children:"删除"})]}),(0,r.jsxs)("button",{onClick:aS,disabled:!c||!!eW.trim(),className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:eW.trim()?"搜索中无法新建文件夹":"新建文件夹","aria-label":"新建",children:[(0,r.jsx)(Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"新建"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>ty(e=>"system"===e?th?"light":"dark":"dark"===e?"light":"system"),className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"system"===tm?"主题：跟随系统":"dark"===tm?"主题：深色":"主题：浅色","aria-label":"主题",children:["dark"===tm?(0,r.jsx)(k,{className:"w-4 h-4"}):"light"===tm?(0,r.jsx)(p,{className:"w-4 h-4"}):(0,r.jsx)(f,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"主题"})]})]}),(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(h,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,r.jsx)("input",{type:"text",placeholder:"桶内全局搜索...",value:eW,onChange:e=>eV(e.target.value),className:"pl-9 pr-9 py-1.5 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 w-60 transition-all dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),eQ?(0,r.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,r.jsx)(m,{className:"w-4 h-4 text-gray-400 animate-spin dark:text-gray-500"})}):null]}),(0,r.jsx)("button",{onClick:()=>{c&&(eq.length>0?eK(!0):eF.current?.click())},disabled:!c,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-all shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:a2.active>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m,{className:"w-4 h-4 animate-spin"}),(0,r.jsxs)("span",{children:[a2.pct,"%"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"上传"})]})})]})]}),(0,r.jsxs)("div",{className:"hidden md:flex items-center justify-between gap-3 px-6 py-2 border-t border-gray-100 bg-white dark:border-gray-800 dark:bg-gray-900",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm text-gray-600 dark:text-gray-300 min-w-0",children:[(0,r.jsxs)("button",{onClick:()=>{eb([]),eV("")},className:"hover:bg-gray-100 px-2 py-1 rounded-md transition-colors text-gray-500 flex items-center gap-1 dark:text-gray-300 dark:hover:bg-gray-800",children:[(0,r.jsx)(O,{className:"w-5 h-5 text-gray-500 dark:text-gray-300",strokeWidth:1.75}),(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"根目录"})]}),eh.length>0&&(0,r.jsx)(y,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"}),eh.map((e,t)=>(0,r.jsxs)(a.default.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>aN(t),className:"hover:text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-md transition-colors font-medium break-words dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:e}),t<eh.length-1&&(0,r.jsx)(y,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"})]},t))]}),(0,r.jsx)(er,{bucketName:a6??"未选择",disabled:!c,onClick:()=>tW(!0)})]}),(0,r.jsxs)("div",{className:"md:hidden px-3 py-2 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{type:"button",onClick:()=>ta(!0),className:"p-2.5 -ml-1 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800","aria-label":"打开菜单",children:(0,r.jsx)(b,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,r.jsx)(ee,{className:"w-10 h-10 shrink-0"}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"font-bold text-[18px] leading-[1.15] tracking-tight text-blue-600 truncate dark:text-blue-400",children:el.title}),(0,r.jsx)("div",{className:"mt-0.25 text-[12px] leading-[1.1] text-gray-400 font-medium truncate dark:text-gray-400",children:el.subtitle})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(h,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,r.jsx)("input",{type:"text",placeholder:"桶内搜索...",value:eW,onChange:e=>eV(e.target.value),className:"w-full pl-9 pr-9 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),eQ?(0,r.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,r.jsx)(m,{className:"w-4 h-4 text-gray-400 animate-spin dark:text-gray-500"})}):null]}),(0,r.jsxs)("button",{onClick:()=>{c&&(eq.length>0?eK(!0):eF.current?.click())},disabled:!c,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-all shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[(0,r.jsx)(u,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"上传"})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto -mx-3 px-3 pb-0.5",children:[(0,r.jsxs)("button",{onClick:()=>c&&ao(c,eh),disabled:!c,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"刷新","aria-label":"刷新",children:[(0,r.jsx)(m,{className:`w-5 h-5 ${ep?"animate-spin":""}`}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"刷新"})]}),(0,r.jsxs)("button",{onClick:aK,disabled:0===eB.size,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"批量下载（所选文件）","aria-label":"下载",children:[(0,r.jsx)(B,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"下载"})]}),(0,r.jsxs)("button",{onClick:aA,disabled:0===eB.size,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"批量移动（所选文件）","aria-label":"移动",children:[(0,r.jsx)(L,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"移动"})]}),(0,r.jsxs)("button",{onClick:aE,disabled:eB.size>1||0===eB.size&&!eP,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名（仅支持单选）","aria-label":"重命名",children:[(0,r.jsx)(C,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"重命名"})]}),(0,r.jsxs)("button",{onClick:a$,disabled:0===eB.size&&!eP,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-red-200 dark:hover:bg-red-950/40",title:"删除（所选项）","aria-label":"删除",children:[(0,r.jsx)(g,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-[10px] leading-none",children:"删除"})]}),(0,r.jsxs)("button",{onClick:aS,disabled:!c||!!eW.trim(),className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:eW.trim()?"搜索中无法新建文件夹":"新建文件夹","aria-label":"新建",children:[(0,r.jsx)(Z,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"新建"})]}),(0,r.jsxs)("button",{type:"button",onClick:()=>ty(e=>"system"===e?th?"light":"dark":"dark"===e?"light":"system"),className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"system"===tm?"主题：跟随系统":"dark"===tm?"主题：深色":"主题：浅色","aria-label":"主题",children:["dark"===tm?(0,r.jsx)(k,{className:"w-5 h-5"}):"light"===tm?(0,r.jsx)(p,{className:"w-5 h-5"}):(0,r.jsx)(f,{className:"w-5 h-5"}),(0,r.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"主题"})]})]}),(0,r.jsx)("div",{className:"pt-1",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm text-gray-600 dark:text-gray-300 min-w-0",children:[(0,r.jsxs)("button",{onClick:()=>{eb([]),eV("")},className:"hover:bg-gray-100 px-2 py-1 rounded-md transition-colors text-gray-500 flex items-center gap-1 dark:text-gray-300 dark:hover:bg-gray-800",children:[(0,r.jsx)(O,{className:"w-5 h-5 text-gray-500 dark:text-gray-300",strokeWidth:1.75}),(0,r.jsx)("span",{className:"text-sm font-medium",children:"根目录"})]}),eh.length>0&&(0,r.jsx)(y,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"}),eh.map((e,t)=>(0,r.jsxs)(a.default.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>aN(t),className:"hover:text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-md transition-colors font-medium whitespace-nowrap dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:e}),t<eh.length-1&&(0,r.jsx)(y,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"})]},t))]}),(0,r.jsx)(er,{bucketName:a6??"未选择",disabled:!c,onClick:()=>tW(!0),className:"shrink-0"})]})})]})]}),(0,r.jsx)("input",{type:"file",multiple:!0,ref:eF,className:"hidden",onChange:a0}),ep||eQ?(0,r.jsx)("div",{className:"h-1 w-full bg-blue-100 dark:bg-blue-950/40",children:(0,r.jsx)("div",{className:"h-1 w-1/3 bg-blue-500 animate-pulse"})}):(0,r.jsx)("div",{className:"h-1 w-full bg-transparent"}),(0,r.jsx)("div",{className:`flex-1 overflow-y-auto p-3 md:py-4 md:px-6 bg-gray-50/30 dark:bg-gray-900 ${ep?"pointer-events-none":""}`,onClick:()=>{eA(null)},children:"unbound"===ef?(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"w-full max-w-2xl bg-white border border-gray-200 rounded-2xl shadow-sm p-6 dark:bg-gray-900 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:"未绑定存储桶"}),(0,r.jsx)("div",{className:"mt-1 text-sm text-gray-500 leading-relaxed dark:text-gray-300",children:"当前账号还没有可用存储桶，请点击「新增存储桶」并填写你的 R2 账号参数后继续。"})]}),(0,r.jsx)("button",{onClick:st,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium transition-colors whitespace-nowrap",children:"新增存储桶"})]}),(0,r.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950/30",children:[(0,r.jsx)("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"配置步骤"}),(0,r.jsxs)("ol",{className:"mt-3 space-y-2 text-sm text-gray-700 list-decimal pl-5 dark:text-gray-200",children:[(0,r.jsx)("li",{children:"点击「新增存储桶」按钮"}),(0,r.jsx)("li",{children:"填写桶名、Account ID、Access Key、Secret Key"}),(0,r.jsx)("li",{children:"可选填写公共链接和自定义域名"}),(0,r.jsx)("li",{children:"保存后即可开始管理文件"})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950/30",children:[(0,r.jsx)("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"字段说明"}),(0,r.jsxs)("div",{className:"mt-3 text-sm text-gray-700 leading-relaxed space-y-2 dark:text-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsx)("span",{className:"font-medium",children:"桶名称"}),(0,r.jsx)("code",{className:"px-2 py-1 rounded bg-white border border-gray-200 text-xs dark:bg-gray-900 dark:border-gray-800",children:"my-bucket"})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsx)("span",{className:"font-medium",children:"Account ID"}),(0,r.jsx)("code",{className:"px-2 py-1 rounded bg-white border border-gray-200 text-xs dark:bg-gray-900 dark:border-gray-800",children:"xxxxxxxx"})]}),(0,r.jsx)("div",{className:"text-[12px] text-gray-500 dark:text-gray-400",children:"Access Key 和 Secret Key 在 Cloudflare R2 API Tokens 中创建与查看。"})]})]})]}),(0,r.jsxs)("div",{className:"mt-4 rounded-xl border border-gray-200 bg-white p-4 dark:border-gray-800 dark:bg-gray-900",children:[(0,r.jsx)("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200",children:"提示"}),(0,r.jsxs)("ul",{className:"mt-2 text-sm text-gray-700 space-y-1.5 list-disc pl-5 dark:text-gray-200",children:[(0,r.jsx)("li",{children:"每个账号可配置多个桶，也可混用多个 Cloudflare 账号的桶。"}),(0,r.jsx)("li",{children:"所有桶配置会绑定到当前登录账号，后续登录可直接继续使用。"})]})]})]})}):ew&&!ep?(0,r.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,r.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl border border-red-200 bg-red-50 p-6 dark:border-red-900/50 dark:bg-red-950/20",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-red-700 dark:text-red-200",children:"文件列表读取失败"}),(0,r.jsx)("div",{className:"mt-2 text-sm leading-relaxed text-red-700/90 dark:text-red-200/90",children:ew}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("button",{onClick:()=>c&&ao(c,eh),className:"inline-flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:"重新读取"})})]})}):0!==a1.length||ep||eQ?(0,r.jsx)(a.default.Fragment,{children:(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm dark:bg-gray-900 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-center px-4 py-3 sm:py-2.5 text-[11px] font-semibold text-gray-500 bg-gray-50 border-b border-gray-200 dark:bg-gray-950/30 dark:border-gray-800 dark:text-gray-400",children:[(0,r.jsx)("div",{className:"w-10 flex items-center justify-center",children:(0,r.jsx)("input",{type:"checkbox","aria-label":"Select all",checked:a1.length>0&&a1.every(e=>eB.has(e.key)),onChange:e=>{let t=new Set(eB);if(e.target.checked)for(let e of a1)t.add(e.key);else for(let e of a1)t.delete(e.key);eU(t)},onClick:e=>e.stopPropagation(),className:"w-5 h-5 sm:w-4 sm:h-4"})}),(0,r.jsx)("div",{className:"flex-1",children:"名称"}),(0,r.jsx)("div",{className:"w-28 text-right hidden md:block",children:"大小"}),(0,r.jsx)("div",{className:"w-28 text-right hidden md:block",children:"修改时间"}),(0,r.jsx)("div",{className:"w-40 text-right hidden md:block",children:"操作"}),(0,r.jsx)("div",{className:"w-12 text-right md:hidden",children:"操作"})]}),(0,r.jsx)("div",{children:a1.map(e=>{let t=eB.has(e.key);return(0,r.jsxs)("div",{onClick:t=>{(t.stopPropagation(),te)?"folder"===e.type?aj(e.name):aD(e):eA(e)},onDoubleClick:t=>{t.stopPropagation(),te||("folder"===e.type?aj(e.name):aD(e))},className:`group flex items-center px-4 py-3 md:py-2.5 text-sm border-b border-gray-100 hover:bg-gray-50 cursor-pointer dark:border-gray-800 dark:hover:bg-gray-800 ${eP?.key===e.key?"bg-blue-50 dark:bg-blue-950/30":"bg-white dark:bg-gray-900"}`,children:[(0,r.jsx)("div",{className:"w-10 flex items-center justify-center",children:(0,r.jsx)("input",{type:"checkbox",checked:t,onChange:t=>{let r=new Set(eB);t.target.checked?r.add(e.key):r.delete(e.key),eU(r)},onClick:e=>e.stopPropagation(),className:"w-5 h-5 sm:w-4 sm:h-4"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"shrink-0",children:a4(e.type,e.name,"sm")}),(0,r.jsxs)("div",{className:"min-w-0 flex items-center gap-2",children:[(0,r.jsx)("div",{className:"truncate",title:e.name,children:e.name}),(0,r.jsx)("span",{className:"shrink-0 text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:af(e)})]})]}),(0,r.jsx)("div",{className:"w-28 text-right text-xs text-gray-500 hidden md:block dark:text-gray-400",children:"folder"===e.type?"-":es(e.size)}),(0,r.jsx)("div",{className:"w-28 text-right text-xs text-gray-500 hidden md:block dark:text-gray-400",children:e.lastModified?new Date(e.lastModified).toLocaleDateString():"-"}),(0,r.jsx)("div",{className:"w-40 hidden md:flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:"folder"===e.type?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),aj(e.name)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"打开",children:(0,r.jsx)(O,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),a_(e)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名",children:(0,r.jsx)(C,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),aP(e,"move")},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"移动",children:(0,r.jsx)(L,{className:"w-4 h-4"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),aL(e)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"下载",children:(0,r.jsx)(B,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),a_(e)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名",children:(0,r.jsx)(C,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:t=>{t.stopPropagation(),aP(e,"move")},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"移动",children:(0,r.jsx)(L,{className:"w-4 h-4"})})]})}),(0,r.jsx)("div",{className:"w-12 flex justify-end md:hidden",children:(0,r.jsx)("button",{type:"button",onClick:t=>{t.stopPropagation(),eA(e),tl(!0)},className:"px-2.5 py-1.5 rounded-lg border border-gray-200 bg-white text-xs font-medium text-gray-700 hover:bg-gray-50 active:scale-95 transition dark:border-gray-800 dark:bg-gray-900 dark:text-gray-100 dark:hover:bg-gray-800","aria-label":"操作",title:"操作",children:"操作"})})]},e.key)})})]})}):(0,r.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-400",children:[(0,r.jsx)("div",{className:"w-24 h-24 bg-gray-50 rounded-full flex items-center justify-center mb-4 dark:bg-gray-950",children:(0,r.jsx)(x,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),(0,r.jsx)("p",{className:"text-sm font-medium",children:eW.trim()?"未找到匹配内容":"文件夹为空"})]})})]}),(0,r.jsx)("div",{className:"hidden md:flex w-80 shrink-0",children:(0,r.jsx)(sa,{})}),(0,r.jsxs)("div",{className:`fixed inset-0 z-50 md:hidden ${ts?"":"pointer-events-none"}`,children:[(0,r.jsx)("button",{type:"button","aria-label":"关闭详情",onClick:()=>tl(!1),className:`absolute inset-0 bg-black/40 transition-opacity ${ts?"opacity-100":"opacity-0"}`}),(0,r.jsx)("div",{className:`absolute inset-x-0 bottom-0 transition-transform duration-200 ${ts?"translate-y-0":"translate-y-full"}`,onClick:e=>e.stopPropagation(),children:(0,r.jsx)("div",{className:"h-[70dvh] bg-white rounded-t-2xl shadow-2xl border border-gray-200 overflow-hidden dark:bg-gray-900 dark:border-gray-800",children:(0,r.jsx)(sa,{compact:!0,onClose:()=>tl(!1)})})})]}),null,(0,r.jsx)(s,{open:tF,title:"当前存储桶",description:"主页仅展示（不支持切换）；如需切换请在侧边栏/菜单中操作。",onClose:()=>tW(!1),footer:(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:()=>tW(!1),className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"知道了"})}),children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"桶名称"}),(0,r.jsx)("div",{className:"text-base font-semibold text-gray-900 break-all dark:text-gray-100",children:a6??"未选择"})]})}),(0,r.jsxs)(s,{open:tE,title:"新建文件夹",description:eh.length?`当前位置：/${eh.join("/")}/`:"当前位置：/（根目录）",onClose:()=>{t_(!1),tT("")},footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{t_(!1),tT("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:aC,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"创建"})]}),children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"文件夹名称"}),(0,r.jsx)("input",{value:tz,onChange:e=>tT(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：images"})]}),(0,r.jsxs)(s,{open:tp,title:"重命名",description:eP?`当前：${eP.name}`:void 0,onClose:()=>tk(!1),footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>tk(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:az,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"确认"})]}),children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新名称"}),(0,r.jsx)("input",{value:tf,onChange:e=>tv(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"输入新名称"})]}),(0,r.jsxs)(s,{open:tj,title:"move"===tw?"移动":"复制",description:tM.length>1?`已选择 ${tM.length} 个文件`:eP?`对象：${eP.key}`:void 0,onClose:()=>{tN(!1),tI([])},footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{tN(!1),tI([])},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:aB,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"确认"})]}),children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"目标路径"}),(0,r.jsx)("input",{value:tC,onChange:e=>t$(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：photos/ 或 a/b/c/"}),(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"以 `/` 结尾表示目标目录；不以 `/` 结尾表示目标 Key。"})]}),(0,r.jsx)(s,{open:t0,title:"账号中心",description:"当前账号与存储桶管理",panelClassName:"max-w-[96vw] sm:max-w-[600px]",showHeaderClose:!0,onClose:()=>{t1(!1),t7(null)},children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[(0,r.jsx)("div",{className:"h-11 w-11 shrink-0 rounded-full bg-blue-50 text-blue-600 dark:bg-blue-950/40 dark:text-blue-300 flex items-center justify-center",children:(0,r.jsx)(X,{className:"h-7 w-7"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("div",{className:"text-sm leading-tight font-semibold text-gray-800 truncate dark:text-gray-100",children:e?.email||"未读取到邮箱"}),(0,r.jsxs)("div",{className:"mt-0 min-w-0",children:[(0,r.jsx)("button",{type:"button",onClick:()=>rL(e=>!e),className:"text-[11px] leading-none text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:rR?"隐藏用户ID":"显示用户ID"}),rR?(0,r.jsxs)("div",{className:"mt-0.5 text-xs leading-tight text-gray-500 break-all dark:text-gray-400",children:["用户ID：",e?.userId||"-"]}):null]})]})]}),(0,r.jsxs)("div",{className:"shrink-0 flex items-center justify-end gap-1.5 flex-wrap",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{t1(!1),tH(!0)},className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"退出登录"}),(0,r.jsx)("button",{type:"button",onClick:()=>t5(!0),className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"修改密码"}),(0,r.jsx)("button",{type:"button",onClick:()=>t8(!0),className:"px-2 py-1 rounded-md text-xs font-medium border border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"注销账号"})]})]}),(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-900",children:[(0,r.jsxs)("div",{className:"pl-3 pr-5 py-2 border-b border-gray-200 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:["已绑定存储桶（",n.length,"）"]}),(0,r.jsxs)("button",{type:"button",onClick:st,className:"shrink-0 inline-flex items-center gap-1.5 px-2 py-1.5 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:[(0,r.jsx)(Y,{className:"w-3.5 h-3.5"}),"添加存储桶"]})]}),n.length?(0,r.jsx)("div",{className:"max-h-[45vh] overflow-y-auto p-2 space-y-2",children:n.map(e=>{let t=c===e.id;return(0,r.jsx)("div",{className:`rounded-lg border px-3 py-2 ${t?"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950/30":"border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-900"}`,children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-800 truncate dark:text-gray-100",children:e.Name||e.bucketName||e.id}),(0,r.jsxs)("div",{className:"mt-1 text-xs text-gray-500 break-all dark:text-gray-400",children:["R2 桶名：",e.bucketName||"-"]}),(0,r.jsxs)("div",{className:"mt-0.5 text-xs text-gray-500 truncate dark:text-gray-400",title:e.accountId||"-",children:["Account ID：",e.accountId||"-"]})]}),(0,r.jsxs)("div",{className:"shrink-0 flex items-center gap-1",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{t||(se(e.id),t1(!1))},disabled:t,className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800 dark:disabled:hover:bg-transparent",children:t?"当前":"切换"}),(0,r.jsx)("button",{type:"button",onClick:()=>{let t;!(t=a7(e.id??c))?e9("请先选择要编辑的存储桶"):(t1(!1),tQ(t.id),rW({}),rH({bucketLabel:t.Name??"",bucketName:t.bucketName??"",accountId:t.accountId??"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:t.publicBaseUrl??"",customBaseUrl:t.customBaseUrl??""}),tY(!0))},className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"编辑"}),(0,r.jsx)("button",{type:"button",onClick:()=>{let t;!(t=a7(e.id))?e9("未找到要删除的存储桶"):(t7(t.id),t3(!0))},className:"px-2 py-1 rounded-md text-xs font-medium border border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"删除"})]})]})},e.id)})}):(0,r.jsx)("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400",children:"当前账号还未绑定存储桶，请点击右上角「添加存储桶」。"})]})]})}),(0,r.jsx)(s,{open:t2,title:"修改密码",onClose:()=>{t5(!1),rT(""),rA("")},footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{t5(!1),rT(""),rA("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:()=>{ar()},disabled:ep,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"保存新密码"})]}),children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新密码"}),(0,r.jsx)("input",{type:"password",value:rz,onChange:e=>rT(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"确认新密码"}),(0,r.jsx)("input",{type:"password",value:rP,onChange:e=>rA(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"再次输入新密码"})]})]})}),(0,r.jsx)(s,{open:t4,title:"注销账号",description:"该操作不可恢复，将永久删除当前账号及其桶配置。",onClose:()=>{t8(!1),rU("")},footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{t8(!1),rU("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:()=>{aa()},disabled:ep,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"确认注销"})]}),children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-sm text-red-700 leading-relaxed dark:text-red-200",children:"注销后无法恢复，账号下已绑定的桶配置会一并清理。"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"请输入“注销”确认"}),(0,r.jsx)("input",{value:rB,onChange:e=>rU(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-red-500/20 focus:border-red-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"注销"})]})]})}),(0,r.jsx)(s,{open:tX,title:tG?"编辑存储桶":"新增存储桶",onClose:()=>{tY(!1),tQ(null),rW({})},footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{tY(!1),tQ(null),rW({})},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:()=>{al()},disabled:ep,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:tG?"保存修改":"保存"})]}),children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:a9?"带 * 的字段为必填；若缺失，点击保存后会在对应输入框提示。":"编辑模式下 Access Key / Secret 可留空表示不修改。"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"显示名称（可选）"}),(0,r.jsx)("input",{value:rD.bucketLabel,onChange:e=>rH(t=>({...t,bucketLabel:e.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：我的云盘"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["R2 桶名称 ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{value:rD.bucketName,onChange:e=>{rH(t=>({...t,bucketName:e.target.value})),rW(e=>({...e,bucketName:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${rF.bucketName?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:"例如：my-bucket"}),rF.bucketName?(0,r.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:rF.bucketName}):null]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Account ID ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{value:rD.accountId,onChange:e=>{rH(t=>({...t,accountId:e.target.value})),rW(e=>({...e,accountId:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${rF.accountId?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`}),rF.accountId?(0,r.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:rF.accountId}):null]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Access Key ID ",a9?(0,r.jsx)("span",{className:"text-red-500",children:"*"}):"（可选）"]}),(0,r.jsx)("input",{value:rD.accessKeyId,onChange:e=>{rH(t=>({...t,accessKeyId:e.target.value})),rW(e=>({...e,accessKeyId:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${rF.accessKeyId?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:tG?"留空表示不修改":""}),rF.accessKeyId?(0,r.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:rF.accessKeyId}):null]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Secret Access Key ",a9?(0,r.jsx)("span",{className:"text-red-500",children:"*"}):"（可选）"]}),(0,r.jsx)("input",{type:"password",value:rD.secretAccessKey,onChange:e=>{rH(t=>({...t,secretAccessKey:e.target.value})),rW(e=>({...e,secretAccessKey:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${rF.secretAccessKey?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:tG?"留空表示不修改":""}),rF.secretAccessKey?(0,r.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:rF.secretAccessKey}):null]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"公共开发 URL（可选）"}),(0,r.jsx)("input",{value:rD.publicBaseUrl,onChange:e=>rH(t=>({...t,publicBaseUrl:e.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,r.jsxs)("div",{className:"md:col-span-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"自定义域名（可选）"}),(0,r.jsx)("input",{value:rD.customBaseUrl,onChange:e=>rH(t=>({...t,customBaseUrl:e.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]})]})]})}),(0,r.jsx)(s,{open:t6,title:"确认删除存储桶？",onClose:()=>{t3(!1),t7(null)},footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>{t3(!1),t7(null)},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:()=>{t9&&ad(t9)},disabled:!t9,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"删除存储桶"})]}),children:(0,r.jsxs)("div",{className:"text-sm text-gray-700 leading-relaxed dark:text-gray-200",children:["将删除以下存储桶配置：",(0,r.jsxs)("span",{className:"font-semibold",children:[" ",a3?.Name||a3?.bucketName||t9||"-"]}),"。该操作不会删除 R2 中的真实文件，只会移除本账号下的桶绑定配置。"]})}),(0,r.jsx)(s,{open:tD,title:"确认退出登录？",onClose:()=>tH(!1),footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>tH(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:()=>{tH(!1),ai()},className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"退出登录"})]}),children:(0,r.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:"退出后将清除本地登录状态，需要重新输入邮箱和密码才能继续使用。确定退出登录吗？"})}),(0,r.jsx)(s,{open:tP,title:"链接设置",description:c?`桶：${c}`:void 0,onClose:()=>tA(!1),footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>tA(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:aq,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"保存"})]}),children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"公共开发 URL（可选）"}),(0,r.jsx)("input",{value:tB,onChange:e=>tU(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"自定义域名（可选）"}),(0,r.jsx)("input",{value:tR,onChange:e=>tL(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"R2 存储桶名称（必填）"}),(0,r.jsx)("input",{value:tO,onChange:e=>tK(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"修改后将重新校验该桶名，校验通过才会保存。"})]})]})}),(0,r.jsx)(s,{open:tq,title:"确认删除",description:eB.size>0?`将删除 ${eB.size} 项`:eP?`将删除：${eP.key}`:void 0,onClose:()=>tJ(!1),footer:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>tJ(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,r.jsx)("button",{onClick:aM,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"删除"})]}),children:(0,r.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:["确定删除文件？此操作不可恢复。",eB.size>0?Array.from(eB).some(e=>e.endsWith("/"))?"（选择文件夹时，文件夹内的所有文件都将会被删除）":null:eP?.type==="folder"?"（文件夹会递归删除前缀下的所有对象）":null]})}),eq.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:()=>eK(e=>!e),className:"fixed bottom-5 right-5 z-40 flex items-center gap-2 px-4 py-2 rounded-full bg-gray-900 text-white shadow-lg hover:bg-gray-800",children:[(0,r.jsx)(u,{className:"w-4 h-4"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["上传 ",a2.active?`(${a2.active})`:""]}),(0,r.jsxs)("span",{className:"text-xs text-gray-200",children:[a2.pct,"%"]})]}),eO?(0,r.jsxs)("div",{className:"fixed bottom-20 right-5 z-40 w-[420px] max-w-[calc(100vw-2.5rem)] bg-white border border-gray-200 rounded-2xl shadow-2xl overflow-hidden dark:bg-gray-900 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100 flex items-center justify-between dark:border-gray-800",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"上传任务"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("button",{onClick:()=>eF.current?.click(),className:"px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:"添加文件"}),(0,r.jsx)("button",{onClick:()=>eJ(e=>e.filter(e=>"queued"===e.status||"uploading"===e.status||"paused"===e.status)),className:"px-3 py-1.5 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-xs font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"清理已完成"}),(0,r.jsx)("button",{onClick:()=>eK(!1),className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",title:"关闭",children:(0,r.jsx)(K,{className:"w-4 h-4"})})]})]}),(0,r.jsx)("div",{className:"max-h-[50vh] overflow-auto divide-y divide-gray-100 dark:divide-gray-800",children:eq.map(e=>{let t=e.file.size?Math.min(100,Math.round(Math.min(e.loaded,e.file.size)/e.file.size*100)):0;return(0,r.jsxs)("div",{className:"px-4 py-3",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate dark:text-gray-100",title:e.key,children:e.file.name}),(0,r.jsxs)("div",{className:"mt-0.5 text-[11px] text-gray-500 truncate dark:text-gray-400",title:`${e.bucket}/${e.key}`,children:[e.bucket,"/",e.key]})]}),(0,r.jsxs)("div",{className:"shrink-0 flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsxs)("div",{className:"text-xs font-semibold text-gray-800 dark:text-gray-100",children:[t,"%"]}),(0,r.jsx)("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"uploading"===e.status?aH(e.speedBps):"done"===e.status?"完成":"queued"===e.status?"排队中":"paused"===e.status?"已暂停":"canceled"===e.status?"已取消":"error"===e.status?"失败":e.status})]}),"uploading"===e.status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{var t;return t=e.id,void(eJ(e=>e.map(e=>e.id===t&&"uploading"===e.status?{...e,status:"paused",speedBps:0}:e)),eH(!0),rr.current.get(t)?.abort(),e9("已暂停（可继续续传）"))},className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"暂停",children:(0,r.jsx)(q,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>aG(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,r.jsx)(D,{className:"w-4 h-4"})})]}):"paused"===e.status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>aX(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"继续",children:(0,r.jsx)(J,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>aG(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,r.jsx)(D,{className:"w-4 h-4"})})]}):"queued"===e.status?(0,r.jsx)("button",{onClick:()=>aG(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,r.jsx)(D,{className:"w-4 h-4"})}):"error"===e.status?(0,r.jsx)("button",{onClick:()=>aX(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重试",children:(0,r.jsx)(J,{className:"w-4 h-4"})}):null]})]}),(0,r.jsx)("div",{className:"mt-2 h-2 bg-gray-100 rounded-full overflow-hidden dark:bg-gray-800",children:(0,r.jsx)("div",{className:`h-2 ${"error"===e.status?"bg-red-500":"done"===e.status?"bg-green-500":"paused"===e.status||"canceled"===e.status?"bg-gray-400":"bg-blue-600"}`,style:{width:`${t}%`}})}),"error"===e.status?(0,r.jsx)("div",{className:"mt-2 text-[11px] text-red-600 dark:text-red-300",children:e.error??"上传失败"}):null]},e.id)})})]}):null]}):null,r1,eR?(0,r.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-6",onClick:()=>eL(null),children:(0,r.jsxs)("div",{className:"w-full max-w-4xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden dark:bg-gray-900 dark:border-gray-800",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"px-5 py-3 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("div",{className:"text-sm font-semibold text-gray-900 truncate dark:text-gray-100",title:eR.name,children:eR.name}),(0,r.jsx)("div",{className:"text-[11px] text-gray-500 truncate dark:text-gray-400",title:eR.key,children:eR.key})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"hidden sm:inline-flex text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:ak(eR.name).toUpperCase()||"FILE"}),(0,r.jsx)("button",{onClick:async()=>{try{let e=await aR(eR.bucket,eR.key,eR.name);aO(e,eR.name),e9("已拉起下载")}catch{e9("下载失败")}},className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800",title:"下载",children:(0,r.jsx)(B,{className:"w-4 h-4"})}),(0,r.jsx)("button",{onClick:()=>eL(null),className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",title:"关闭",children:(0,r.jsx)(K,{className:"w-4 h-4"})})]})]}),(0,r.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-950/30",children:"image"===eR.kind?(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("img",{src:eR.url,alt:eR.name,className:"max-h-[70vh] max-w-full rounded-lg shadow"})}):"video"===eR.kind?(0,r.jsx)("div",{className:"w-full aspect-video rounded-lg shadow bg-black overflow-hidden",children:(0,r.jsx)("video",{src:eR.url,controls:!0,className:"w-full h-full object-contain"})}):"audio"===eR.kind?(0,r.jsx)("audio",{src:eR.url,controls:!0,className:"w-full"}):"pdf"===eR.kind?(0,r.jsx)("iframe",{src:eR.url,className:"w-full h-[70vh] rounded-lg shadow bg-white dark:bg-gray-900",title:"PDF Preview"}):"office"===eR.kind?(0,r.jsx)("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(eR.url)}`,className:"w-full h-[70vh] rounded-lg shadow bg-white dark:bg-gray-900",title:"Office Preview"}):"text"===eR.kind?(0,r.jsx)("pre",{className:"text-xs bg-white border border-gray-200 rounded-lg p-4 overflow-auto max-h-[70vh] whitespace-pre-wrap dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100",children:eR.text??"加载中..."}):(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-10 flex flex-col items-center justify-center text-center dark:bg-gray-900 dark:border-gray-800",children:[(0,r.jsx)("div",{className:"w-28 h-28 rounded-full bg-gray-100 flex items-center justify-center dark:bg-gray-800",children:(0,r.jsx)(M,{className:"w-10 h-10 text-blue-600"})}),(0,r.jsx)("div",{className:"mt-8 text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"无法预览此文件"}),(0,r.jsx)("div",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:"此文件类型暂不支持在线预览，请下载后查看。"}),(0,r.jsxs)("button",{onClick:async()=>{try{let e=await aR(eR.bucket,eR.key,eR.name);aO(e,eR.name),e9("已拉起下载")}catch{e9("下载失败")}},className:"mt-8 inline-flex items-center gap-3 px-8 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg",children:[(0,r.jsx)(B,{className:"w-5 h-5"}),"下载文件"]})]})})]})}):null]})}e.s(["default",()=>ey],31713)}]);