module.exports=[60350,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({open:a,title:c,description:d,children:e,onClose:f,footer:g,panelClassName:h,showHeaderClose:i=!1}){return a?(0,b.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start sm:items-center justify-center p-3 sm:p-4 overflow-y-auto",role:"dialog","aria-modal":"true",children:[(0,b.jsx)("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:f,"aria-label":"Close dialog"}),(0,b.jsxs)("div",{className:["relative w-full max-w-lg max-h-[calc(100dvh-1.5rem)] sm:max-h-[calc(100dvh-2rem)] rounded-2xl border border-gray-200 bg-white shadow-2xl dark:border-gray-800 dark:bg-gray-900 flex flex-col overflow-hidden",h].filter(Boolean).join(" "),children:[(0,b.jsxs)("div",{className:"relative px-5 py-4 border-b border-gray-100 dark:border-gray-800",children:[i?(0,b.jsx)("button",{type:"button",onClick:f,"aria-label":"关闭弹窗",className:"absolute right-3 top-2.5 inline-flex h-10 w-10 items-center justify-center rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-gray-100",children:(0,b.jsx)("span",{className:"text-xl leading-none",children:"×"})}):null,(0,b.jsxs)("div",{className:"min-w-0 pr-10",children:[(0,b.jsx)("div",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:c}),d?(0,b.jsx)("div",{className:"mt-1 text-sm text-gray-500 dark:text-gray-300",children:d}):null]})]}),(0,b.jsx)("div",{className:"px-5 py-4 text-gray-900 dark:text-gray-100 overflow-y-auto min-h-0",children:e}),g?(0,b.jsx)("div",{className:"px-5 py-4 border-t border-gray-100 dark:border-gray-800",children:g}):null]})]}):null}let e=(a,b="操作失败，请重试。")=>{let c=String(a instanceof Error?a.message:a??"").trim();if(!c)return b;if(/[\u4e00-\u9fa5]/.test(c))return c;let d=c.toLowerCase();return d.includes("invalid login credentials")?"账号或密码错误，请重试。":d.includes("email not confirmed")?"邮箱尚未验证，请先前往邮箱完成验证。":d.includes("unauthorized")?"登录状态已失效，请重新登录。":d.includes("missing params")?"请求参数不完整，请刷新后重试。":d.includes("bucket required")?"缺少存储桶参数。":d.includes("bucket id required")?"缺少存储桶 ID。":d.includes("bucket not found")?"未找到存储桶，请刷新后重试。":d.includes("source not found")?"源文件不存在或已被删除。":d.includes("unknown bucket binding")||d.includes("bucket binding not configured")?"存储桶绑定未配置或不可用，请检查配置。":d.includes("token expired")?"操作令牌已过期，请重试。":d.includes("invalid token")?"操作令牌无效，请重试。":d.includes("missing environment variable")?"服务端缺少必要环境变量，请联系管理员。":d.includes("decryption failed")||d.includes("ciphertext authentication failure")||d.includes("bad padding")||d.includes("aes-gcm")?"密钥解密失败：请检查 CREDENTIALS_ENCRYPTION_KEY 是否与历史配置一致。":d.includes("failed to load buckets")?"读取存储桶列表失败，请稍后重试。":d.includes("failed to load bucket")?"读取存储桶信息失败，请稍后重试。":d.includes("failed to create bucket")?"新增存储桶失败，请检查配置后重试。":d.includes("failed to update bucket")?"更新存储桶失败，请稍后重试。":d.includes("failed to delete bucket")?"删除存储桶失败，请稍后重试。":d.includes("failed to check existing bucket")?"校验存储桶是否存在时失败，请稍后重试。":d.includes("failed to set default bucket")?"设置默认存储桶失败，请稍后重试。":d.includes("duplicate key value violates unique constraint")?"该账号下已存在同名存储桶（同 Account ID + 桶名），请修改后重试。":d.includes("failed to fetch")?"网络请求失败，请检查网络后重试。":b},f=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim(),g=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)};var h={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,c.forwardRef)(({color:a="currentColor",size:b=24,strokeWidth:d=2,absoluteStrokeWidth:e,className:g="",children:i,iconNode:j,...k},l)=>(0,c.createElement)("svg",{ref:l,...h,width:b,height:b,stroke:a,strokeWidth:e?24*Number(d)/Number(b):d,className:f("lucide",g),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0;return!1})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,b])=>(0,c.createElement)(a,b)),...Array.isArray(i)?i:[i]])),j=(a,b)=>{let d=(0,c.forwardRef)(({className:d,...e},h)=>(0,c.createElement)(i,{ref:h,iconNode:b,className:f(`lucide-${g(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,d),...e}));return d.displayName=g(a),d},k=j("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),l=j("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),m=j("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),n=j("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),o=j("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),p=j("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),q=j("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),r=j("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),s=j("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),t=j("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),u=j("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),v=j("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),w=j("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),x=j("music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),y=j("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),z=j("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),A=j("file-archive",[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]]),B=j("file-code",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]]),C=j("file-spreadsheet",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),D=j("file-type",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M11 18h2",key:"12mj7e"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M9 13v-.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 .5.5v.5",key:"qbrxap"}]]),E=j("file-braces",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]),F=j("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),G=j("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),H=j("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),I=j("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),J=j("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),K=j("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),L=j("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),M=j("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),N=j("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),O=j("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),P=j("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),Q=j("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),R=j("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),S=j("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),T=j("badge-info",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["line",{x1:"12",x2:"12",y1:"16",y2:"12",key:"1y1yb1"}],["line",{x1:"12",x2:"12.01",y1:"8",y2:"8",key:"110wyk"}]]),U=j("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),V=j("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),W=j("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),X=j("circle-user-round",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Y=j("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),Z="r2_admin_theme_v1",$=a=>{let[b,d]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{let b=window.matchMedia(a),c=()=>d(b.matches);return c(),b.addEventListener("change",c),()=>b.removeEventListener("change",c)},[a]),b},_=({className:a})=>{let[d,e]=(0,c.useState)(!1);return d?(0,b.jsx)("div",{"aria-hidden":"true",className:a}):(0,b.jsx)("img",{src:"/brand.png",alt:"","aria-hidden":"true",className:["block object-contain",a].filter(Boolean).join(" "),onError:()=>e(!0),draggable:!1})},aa=({className:a})=>(0,b.jsx)("span",{className:["inline-block bg-current",a].filter(Boolean).join(" "),"aria-hidden":"true",style:{WebkitMaskImage:"url(/Wi-Fi.svg)",maskImage:"url(/Wi-Fi.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain"}}),ab=({bucketName:a,disabled:c,onClick:d,className:e})=>(0,b.jsxs)("button",{type:"button",disabled:c,onClick:d,title:a,"aria-label":"查看当前存储桶",className:["inline-flex items-center gap-2 px-1 py-1 rounded-md text-left","transition-colors hover:text-gray-700 dark:hover:text-gray-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/30 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900","disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-inherit",e].filter(Boolean).join(" "),children:[(0,b.jsx)(Y,{className:"w-5 h-5 text-gray-500 shrink-0 dark:text-gray-300",strokeWidth:1.75}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-[10px] leading-tight text-gray-500 dark:text-gray-400",children:"当前桶"}),(0,b.jsx)("div",{className:"mt-0.5 text-[11px] leading-tight font-normal text-blue-600 truncate max-w-[10.5rem] md:max-w-[16rem] dark:text-blue-300",children:a})]})]}),ac=(a,b=0)=>{let c="number"==typeof a?a:Number(a);return Number.isFinite(c)?c:b},ad=a=>{if(void 0===a||!Number.isFinite(a)||a<0)return"-";if(0===a)return"0 B";let b=["B","KB","MB","GB","TB"],c=Math.min(b.length-1,Math.max(0,Math.floor(Math.log(a)/Math.log(1024))));return parseFloat((a/Math.pow(1024,c)).toFixed(2))+" "+b[c]},ae={title:"R2 Admin Go",subtitle:"R2对象存储多功能管理工具",advantages:["极速的响应速度和上传下载速度","无服务器部署、不存储用户数据","支持大文件上传、预览、重命名、移动和批量操作等功能"],announcementTitle:"公告",announcementText:`欢迎使用

- 继续访问即代表您已阅读并同意「关于页面」相关条款。
- 如有问题欢迎通过「电子邮件」与我反馈沟通。
`,footer:"By Wang Qing"},af=[{label:"我的博客",href:"https://qinghub.top",icon:"globe"},{label:"使用教程",href:"https://github.com/wangqing176176-a11y/qing-r2-cloudy",icon:"book"},{label:"关于页面",href:"https://qinghub.top/about/",icon:"about"},{label:"电子邮箱",href:"mailto:wangqing176176@gmail.com",icon:"mail"}],ag="r2_multipart_resume_v1",ah="r2_supabase_session_v1",ai="r2_supabase_session_tmp_v1",aj=(a,b,c)=>`${a}|${b}|${c.size}|${c.lastModified}`,ak=()=>{try{let a=localStorage.getItem(ag);if(!a)return{};let b=JSON.parse(a);return b&&"object"==typeof b?b:{}}catch{return{}}},al=a=>{localStorage.setItem(ag,JSON.stringify(a))},am=(a,b)=>{let c=ak();c[a]=b,al(c)},an=a=>{let b=ak();a in b&&(delete b[a],al(b))};function ao(){let[a,f]=(0,c.useState)(null),g=(0,c.useRef)(null),[h,i]=(0,c.useState)([]),[j,ag]=(0,c.useState)(null),[al,ao]=(0,c.useState)([]),[ap,aq]=(0,c.useState)([]),[ar,as]=(0,c.useState)(!1),[at,au]=(0,c.useState)("checking"),[av,aw]=(0,c.useState)(null),[ax,ay]=(0,c.useState)(null),[az,aA]=(0,c.useState)(!0),[aB,aC]=(0,c.useState)(null),[aD,aE]=(0,c.useState)(null),[aF,aG]=(0,c.useState)(!1),[aH,aI]=(0,c.useState)(null),[aJ,aK]=(0,c.useState)(new Set),[aL,aM]=(0,c.useState)(null),[aN,aO]=(0,c.useState)(!1),[aP,aQ]=(0,c.useState)([]),[aR,aS]=(0,c.useState)(!1),aT=(0,c.useRef)(null),[aU,aV]=(0,c.useState)(""),[aW,aX]=(0,c.useState)([]),[aY,aZ]=(0,c.useState)(null),[a$,a_]=(0,c.useState)(!1),[a0,a1]=(0,c.useState)({}),[a2,a3]=(0,c.useState)({}),[a4,a5]=(0,c.useState)({}),[a6,a7]=(0,c.useState)(null),a8=(0,c.useMemo)(()=>(a=>{if(!a)return null;if("string"==typeof a){let b=a.trim();return{kind:/失败|错误|异常/.test(b)?"error":/成功|已/.test(b)?"success":"info",message:b}}return a})(a6),[a6]),a9=$("(max-width: 767px)"),ba=$("(prefers-color-scheme: dark)"),[bb,bc]=(0,c.useState)(!1),[bd,be]=(0,c.useState)(!1),[bf,bg]=(0,c.useState)(!1),bh=(0,c.useRef)(null),[bi,bj]=(0,c.useState)(!1),bk=(0,c.useRef)(null),[bl,bm]=(0,c.useState)(!1),[bn,bo]=(0,c.useState)("system"),[bp,bq]=(0,c.useState)(!1),[br,bs]=(0,c.useState)(!1),[bt,bu]=(0,c.useState)(""),[bv,bw]=(0,c.useState)(!1),[bx,by]=(0,c.useState)("move"),[bz,bA]=(0,c.useState)(""),[bB,bC]=(0,c.useState)([]),[bD,bE]=(0,c.useState)(!1),[bF,bG]=(0,c.useState)(""),[bH,bI]=(0,c.useState)(!1),[bJ,bK]=(0,c.useState)(""),[bL,bM]=(0,c.useState)(""),[bN,bO]=(0,c.useState)(""),[bP,bQ]=(0,c.useState)(!1),[bR,bS]=(0,c.useState)(!1),[bT,bU]=(0,c.useState)(!1),[bV,bW]=(0,c.useState)(!1),[bX,bY]=(0,c.useState)(!1),[bZ,b$]=(0,c.useState)(null),[b_,b0]=(0,c.useState)(!1),[b1,b2]=(0,c.useState)(!1),[b3,b4]=(0,c.useState)(!1),[b5,b6]=(0,c.useState)(!1),[b7,b8]=(0,c.useState)(null),b9=(0,c.useRef)([]),ca=(0,c.useRef)(!1),cb=(0,c.useRef)(new Map),cc=(0,c.useRef)(!1);(0,c.useEffect)(()=>{b9.current=aP},[aP]),(0,c.useEffect)(()=>{cc.current=aR},[aR]);let[cd,ce]=(0,c.useState)(""),[cf,cg]=(0,c.useState)(""),[ch,ci]=(0,c.useState)(""),[cj,ck]=(0,c.useState)(""),[cl,cm]=(0,c.useState)(!1),[cn,co]=(0,c.useState)(!1),[cp,cq]=(0,c.useState)(""),[cr,cs]=(0,c.useState)(""),[ct,cu]=(0,c.useState)(!1),[cv,cw]=(0,c.useState)(""),[cx,cy]=(0,c.useState)(!1),[cz,cA]=(0,c.useState)(""),[cB,cC]=(0,c.useState)(""),[cD,cE]=(0,c.useState)(null),[cF,cG]=(0,c.useState)(""),[cH,cI]=(0,c.useState)(""),[cJ,cK]=(0,c.useState)(""),[cL,cM]=(0,c.useState)(!1),[cN,cO]=(0,c.useState)(!1),[cP,cQ]=(0,c.useState)(!1),[cR,cS]=(0,c.useState)({bucketLabel:"",bucketName:"",accountId:"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:"",customBaseUrl:""}),[cT,cU]=(0,c.useState)({}),cV=String(process.env.NEXT_PUBLIC_SUPABASE_URL??"").replace(/\/$/,""),cW=String(process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY??process.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY??"").trim(),cX=a=>{if(!a)return null;try{let b=JSON.parse(a),c=String(b?.accessToken??"").trim(),d=String(b?.refreshToken??"").trim();if(!c||!d)return null;return{accessToken:c,refreshToken:d,userId:b.userId?String(b.userId):void 0,email:b.email?String(b.email):void 0}}catch{return null}},cY=(a,b)=>{if(!a){localStorage.removeItem(ah),sessionStorage.removeItem(ai);return}if(b){localStorage.setItem(ah,JSON.stringify(a)),sessionStorage.removeItem(ai);return}sessionStorage.setItem(ai,JSON.stringify(a)),localStorage.removeItem(ah)},cZ=async a=>{if(!cV||!cW||!a.refreshToken)return null;let b=await fetch(`${cV}/auth/v1/token?grant_type=refresh_token`,{method:"POST",headers:{apikey:cW,"Content-Type":"application/json"},body:JSON.stringify({refresh_token:a.refreshToken})}),c=await c_(b);if(!b.ok||!c.access_token||!c.refresh_token)return null;let d={accessToken:String(c.access_token),refreshToken:String(c.refresh_token),userId:String((c.user?.id??a.userId)||""),email:String((c.user?.email??a.email)||"")};return cY(d,!!localStorage.getItem(ah)),f(d),d};(0,c.useEffect)(()=>{g.current=a},[a]),(0,c.useEffect)(()=>{let a=cX(localStorage.getItem(ah)),b=cX(sessionStorage.getItem(ai)),c=a??b;c?(f(c),c.email&&ce(c.email),cO(!!a)):(aA(!0),au("error"),aw("请登录后继续使用"));let d=localStorage.getItem("r2_link_config_v1");if(d)try{a1(JSON.parse(d))}catch{localStorage.removeItem("r2_link_config_v1")}let e=localStorage.getItem("r2_s3_bucket_check_v1");if(e)try{a3(JSON.parse(e))}catch{localStorage.removeItem("r2_s3_bucket_check_v1")}let g=localStorage.getItem("r2_transfer_mode_override_v1");if(g)try{a5(JSON.parse(g))}catch{localStorage.removeItem("r2_transfer_mode_override_v1")}},[]),(0,c.useEffect)(()=>{},[cW,cV]),(0,c.useEffect)(()=>{if(!a8)return;let a=setTimeout(()=>a7(null),"error"===a8.kind?4500:3200);return()=>clearTimeout(a)},[a8]);let c$=a8?(0,b.jsx)("div",{className:"fixed top-5 left-1/2 -translate-x-1/2 z-50 max-w-[92vw]",children:(0,b.jsxs)("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full border shadow-lg text-sm font-medium ${"success"===a8.kind?"bg-green-50 border-green-200 text-green-700 dark:bg-green-950/40 dark:border-green-900 dark:text-green-200":"error"===a8.kind?"bg-red-50 border-red-200 text-red-700 dark:bg-red-950/40 dark:border-red-900 dark:text-red-200":"bg-gray-900 text-white border-gray-900 dark:bg-gray-900 dark:border-gray-800"}`,role:"status","aria-live":"polite",children:[(0,b.jsx)("span",{className:"shrink-0 flex items-center justify-center",children:"success"===a8.kind?(0,b.jsx)(G,{className:"w-5 h-5"}):"error"===a8.kind?(0,b.jsx)(R,{className:"w-5 h-5"}):(0,b.jsx)(T,{className:"w-5 h-5"})}),(0,b.jsx)("span",{className:"leading-none",children:a8.message})]})}):null;(0,c.useEffect)(()=>{az&&bg(!a9)},[az,a9]),(0,c.useEffect)(()=>{if(!bi)return;let a=a=>{let b=a.target;!b||bh.current&&bh.current.contains(b)||bj(!1)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a,{passive:!0}),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[bi]),(0,c.useEffect)(()=>{if(!bl)return;let a=a=>{let b=a.target;!b||bk.current&&bk.current.contains(b)||bm(!1)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a,{passive:!0}),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a)}},[bl]),(0,c.useEffect)(()=>{bm(!1)},[j]),(0,c.useEffect)(()=>{try{let a=localStorage.getItem(Z);("light"===a||"dark"===a||"system"===a)&&bo(a)}catch{}},[]),(0,c.useEffect)(()=>{let a="dark"===bn||"system"===bn&&ba;bq(a),document.documentElement.classList.toggle("dark",a);try{let b=document.querySelector('meta[name="theme-color"]');b&&b.setAttribute("content",a?"#111827":"#f9fafb")}catch{}try{localStorage.setItem(Z,bn)}catch{}},[ba,bn]),(0,c.useEffect)(()=>{a9||(bc(!1),be(!1))},[a9]),(0,c.useEffect)(()=>{if(!a){aA(!0),i([]),ag(null),ao([]),ay(null),aq([]),aC(null),aE(null),b0(!1),b2(!1),b4(!1),cM(!1),cu(!1),cq(""),cm(!1),au("error"),aw("请登录后继续使用");return}df()},[a]);let c_=async a=>{try{return await a.clone().json()}catch{let b=await a.clone().text().catch(()=>"");return b?{error:b}:{}}},c0=async(a,b={},c=!0)=>{let d={...b.headers};d["content-type"]||"string"!=typeof b.body||(d["content-type"]="application/json");let e=g.current;e?.accessToken&&(d.Authorization=`Bearer ${e.accessToken}`);let f=await fetch(a,{...b,headers:d});if(401!==f.status||!c||!e?.refreshToken)return f;let h=await cZ(e);return h?.accessToken?await c0(a,b,!1):f},c1=async(a,b)=>{if(!cV||!cW)throw Error("Supabase 前端环境变量未配置");let c=await fetch(`${cV}/auth/v1/token?grant_type=password`,{method:"POST",headers:{apikey:cW,"Content-Type":"application/json"},body:JSON.stringify({email:a,password:b})}),d=await c_(c);if(!c.ok||!d.access_token||!d.refresh_token)throw Error(e(String(d.msg??d.error_description??d.error??"登录失败"),"登录失败，请重试。"));return{accessToken:String(d.access_token),refreshToken:String(d.refresh_token),userId:String((d.user?.id??"")||""),email:String((d.user?.email??a)||a)}},c2=async(a,b)=>{if(!cV||!cW)throw Error("Supabase 前端环境变量未配置");let c=await fetch(`${cV}/auth/v1/signup`,{method:"POST",headers:{apikey:cW,"Content-Type":"application/json"},body:JSON.stringify({email:a,password:b})}),d=await c_(c);if(!c.ok)throw Error(e(String(d.msg??d.error_description??d.error??"注册失败"),"注册失败，请重试。"))},c3=async a=>{if(!cV||!cW)throw Error("Supabase 前端环境变量未配置");let b=await fetch(`${cV}/auth/v1/recover`,{method:"POST",headers:{apikey:cW,"Content-Type":"application/json"},body:JSON.stringify({email:a,options:void 0})}),c=await c_(b);if(!b.ok)throw Error(e(String(c.msg??c.error_description??c.error??"发送重置邮件失败"),"发送重置邮件失败，请重试。"))},c4=async(a,b)=>{if(!cV||!cW)throw Error("Supabase 前端环境变量未配置");let c=await fetch(`${cV}/auth/v1/user`,{method:"PUT",headers:{apikey:cW,Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({password:b})}),d=await c_(c);if(!c.ok)throw Error(e(String(d.msg??d.error_description??d.error??"重置密码失败"),"重置密码失败，请重试。"))},c5=async a=>{a.preventDefault(),cs("");let b=cd.trim(),c=cf.trim();if(!b||!c)return void cs("请输入邮箱和密码");try{as(!0);let a=await c1(b,c);f(a),cY(a,cN),aA(!1),au("checking"),aw(null),cs(""),a7("登录成功")}catch(a){cs(e(a,"登录失败，请重试。")||"登录失败，请重试。")}finally{as(!1)}},c6=async a=>{a?.preventDefault(),cq("");let b=ch.trim(),c=cj.trim();if(!b||!c)return void a7("请填写完整注册信息");if(c.length<6)return void a7("密码至少 6 位");if(!cn)return void a7("请先勾选同意用户协议和隐私政策");try{as(!0),await c2(b,c),ck(""),co(!1),ce(b),cq("注册成功，请前往邮箱完成验证后再登录。")}catch(a){a7(e(a,"注册失败，请重试。")||"注册失败")}finally{as(!1)}},c7=async()=>{let a=cv.trim();if(!a)return void a7("请输入注册邮箱");try{as(!0),await c3(a),cu(!1),ce(a),a7("重置邮件已发送，请前往邮箱继续")}catch(a){a7(e(a,"发送重置邮件失败，请重试。")||"发送重置邮件失败")}finally{as(!1)}},c8=async()=>{let a=cz.trim(),b=cB.trim();if(!cD?.accessToken)return void a7("重置会话已失效，请重新发起忘记密码");if(!a||!b)return void a7("请填写完整的新密码");if(a.length<6)return void a7("新密码至少 6 位");if(a!==b)return void a7("两次输入的新密码不一致");try{as(!0),await c4(cD.accessToken,a),cy(!1),cA(""),cC(""),cE(null),cg(""),a7("密码重置成功，请使用新密码登录")}catch(a){a7(e(a,"重置密码失败，请重试。")||"重置密码失败")}finally{as(!1)}},c9=async()=>{let a=cF.trim(),b=cH.trim();if(!a||!b)return void a7("请填写完整的新密码信息");if(a.length<6)return void a7("新密码至少 6 位");if(a!==b)return void a7("两次输入的新密码不一致");try{as(!0);let b=await c0("/api/account",{method:"PATCH",body:JSON.stringify({password:a})}),c=await c_(b);if(!b.ok)throw Error(String(c.error??"修改密码失败"));b2(!1),cG(""),cI(""),de(),a7("密码修改成功，已退出登录，请使用新密码重新登录")}catch(a){a7(e(a,"修改密码失败，请重试。")||"修改密码失败")}finally{as(!1)}},da=async()=>{if("注销"!==cJ.trim())return void a7("请输入“注销”确认此操作");try{as(!0);let a=await c0("/api/account",{method:"DELETE"}),b=await c_(a);if(!a.ok)throw Error(String(b.error??"注销账号失败"));b4(!1),cK(""),de(),a7("账号已注销")}catch(a){a7(e(a,"注销账号失败，请重试。")||"注销账号失败")}finally{as(!1)}},db=()=>cS({bucketLabel:"",bucketName:"",accountId:"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:"",customBaseUrl:""}),dc=async()=>{let a=!!bZ,b={bucketLabel:cR.bucketLabel.trim(),bucketName:cR.bucketName.trim(),accountId:cR.accountId.trim(),accessKeyId:cR.accessKeyId.trim(),secretAccessKey:cR.secretAccessKey.trim(),publicBaseUrl:cR.publicBaseUrl.trim(),customBaseUrl:cR.customBaseUrl.trim(),isDefault:!a&&0===h.length},c={};if(b.bucketName||(c.bucketName="此项必填"),b.accountId||(c.accountId="此项必填"),a||b.accessKeyId||(c.accessKeyId="此项必填"),a||b.secretAccessKey||(c.secretAccessKey="此项必填"),Object.keys(c).length>0)return void cU(c);cU({});try{as(!0);let c=a?await c0("/api/buckets",{method:"PATCH",body:JSON.stringify({id:bZ,bucketLabel:b.bucketLabel,bucketName:b.bucketName,accountId:b.accountId,accessKeyId:b.accessKeyId||void 0,secretAccessKey:b.secretAccessKey||void 0,publicBaseUrl:b.publicBaseUrl,customBaseUrl:b.customBaseUrl})}):await c0("/api/buckets",{method:"POST",body:JSON.stringify(b)}),d=await c_(c);if(!c.ok)throw Error(String(d.error??(a?"更新失败":"创建失败")));let e=d.bucket;bY(!1),b$(null),cU({}),db(),await df();let f=a?"存储桶已更新":"存储桶已添加";if(e?.id||j){let a=e?.id??j;if(!a)return;aq([]),aV(""),aI(null),aK(new Set),ag(a);try{let c=await c0(`/api/bucket-check?bucketId=${encodeURIComponent(a)}&bucketName=${encodeURIComponent(b.bucketName)}`),d=await c_(c),e=!!d.ok,g=String(d.hint??"").trim();dj(a,{bucketName:b.bucketName,ok:e,hint:g||void 0,checkedAt:Date.now()}),!e&&g&&(f=`存储桶已保存，但连通性校验失败：${g}`)}catch{}}a7(f)}catch(b){a7(e(b,a?"更新存储桶失败，请重试。":"添加存储桶失败，请重试。")||(a?"更新存储桶失败":"添加存储桶失败"))}finally{as(!1)}},dd=async a=>{if(a)try{as(!0);let b=await c0(`/api/buckets?id=${encodeURIComponent(a)}`,{method:"DELETE"}),c=await c_(b);if(!b.ok)throw Error(String(c.error??"删除失败"));b6(!1),b8(null),await df(),a7("存储桶已删除")}catch(a){a7(e(a,"删除存储桶失败，请重试。")||"删除存储桶失败")}finally{as(!1)}},de=()=>{cY(null,!1),f(null),i([]),ag(null),ay(null),aC(null),aE(null),aI(null),aK(new Set),aM(null),aQ([]),aO(!1),aS(!1),bs(!1),bw(!1),bI(!1),b0(!1),b2(!1),b4(!1),cM(!1),bQ(!1),b8(null),b6(!1),cG(""),cI(""),cK(""),cu(!1),cw(""),cy(!1),cA(""),cC(""),cE(null),cq(""),cm(!1),aA(!0),au("error"),aw("已退出登录，请重新输入邮箱和密码"),ce(""),cg(""),cO(!1),as(!1),a7("退出登录成功")},df=async()=>{if(!g.current)return void aA(!0);au("checking"),aw(null);try{let a=await c0("/api/buckets"),b=await a.json().catch(()=>({}));if(401===a.status){cY(null,!1),f(null),aA(!0),au("error"),aw("登录已失效，请重新登录");return}if(a.ok&&b.buckets){let a=b.buckets??[];if(aA(!1),i(a),a1(b=>{let c={...b};for(let b of a)c[b.id]={publicBaseUrl:b.publicBaseUrl??c[b.id]?.publicBaseUrl,customBaseUrl:b.customBaseUrl??c[b.id]?.customBaseUrl,s3BucketName:b.bucketName??c[b.id]?.s3BucketName};return localStorage.setItem("r2_link_config_v1",JSON.stringify(c)),c}),0===a.length)ag(null),ao([]),ay(null),aC(null),aE(null),aq([]),au("unbound"),aw("未配置存储桶：请先新增一个存储桶");else if(au("connected"),!j||!a.some(a=>a.id===j)){let b=a.find(a=>a.isDefault)?.id??a[0].id;ag(b)}}else if(au("error"),b.error){let a=e(String(b.error),"连接失败，请稍后重试。");aw(a),a7(`连接失败: ${a}`)}}catch(a){au("error"),aw("网络或运行时异常"),console.error(a)}},dg=async(a,b)=>{if(!a)return;as(!0),ay(null);let c=b.length>0?b.join("/")+"/":"";try{let b=await c0(`/api/files?bucket=${encodeURIComponent(a)}&prefix=${encodeURIComponent(c)}`),d=await c_(b);if(!b.ok){ao([]);let a=e(d.error,"读取文件列表失败");ay(a),au("error"),aw(null),aE(null);return}ao(Array.isArray(d.items)?d.items??[]:[]),ay(null),au("connected"),aw(null)}catch(a){ao([]),ay("读取文件列表失败，请检查桶配置或网络"),au("error"),aw(null),aE(null),console.error(a)}finally{as(!1)}},dh=async(a,b)=>{let c=b.trim();if(!c){aX([]),aZ(null);return}a_(!0);try{let b=await c0(`/api/search?bucket=${encodeURIComponent(a)}&q=${encodeURIComponent(c)}&limit=200`),d=await b.json();b.ok?(aX(d.items||[]),aZ(d.cursor??null)):(aX([]),aZ(null))}finally{a_(!1)}},di=async a=>{aG(!0),aE(null);try{let b=await c0(`/api/usage?bucket=${encodeURIComponent(a)}&maxPages=10`),c=await c_(b);if(b.ok){let b={bucket:String(c.bucket??a),prefix:String(c.prefix??""),objects:Math.max(0,Math.floor(ac(c.objects,0))),bytes:Math.max(0,ac(c.bytes,0)),pagesScanned:Math.max(0,Math.floor(ac(c.pagesScanned,0))),truncated:!!c.truncated};aC(b),aE(null)}else aC(null),aE(String(c.error??"桶占用估算失败"))}catch{aC(null),aE("桶占用估算失败，请检查桶配置或网络")}finally{aG(!1)}};(0,c.useEffect)(()=>{j&&(dg(j,ap),aI(null),aK(new Set))},[j,ap,a]),(0,c.useEffect)(()=>{if(!j){aX([]),aZ(null);return}let a=aU.trim();if(!a){aX([]),aZ(null);return}let b=setTimeout(()=>{dh(j,a).catch(()=>{})},250);return()=>clearTimeout(b)},[aU,j,a]),(0,c.useEffect)(()=>{j&&di(j)},[j,a]);let dj=(a,b)=>{a3(c=>{let d={...c,[a]:b};return localStorage.setItem("r2_s3_bucket_check_v1",JSON.stringify(d)),d})},dk=(a,b)=>{a5(c=>{let d={...c,[a]:b};return localStorage.setItem("r2_transfer_mode_override_v1",JSON.stringify(d)),d})},dl=a=>a4[a]??"auto",dm=a=>a?a0[a]??{}:{},dn=a=>{if(!a)return null;let b=(dm(a).s3BucketName??"").trim();if(!b)return null;let c=a2[a];return c&&c.bucketName===b?c:null},dp=a=>{let b=(dm(a).s3BucketName??"").trim();if(!b)return"";let c=dn(a);return c&&!1===c.ok?"":b},dq=a=>{if(!a)return;let b=a.trim();if(!b)return;let c=/^https?:\/\//i.test(b)?b:`https://${b}`;return c.endsWith("/")?c:`${c}/`},dr=a=>{let b=a.split("?")[0].split("/"),c=b[b.length-1]||"",d=c.lastIndexOf(".");return d<=0||d===c.length-1?"":c.slice(d+1).toLowerCase()},ds=a=>{if("folder"===a.type)return"DIR";let b=dr(a.name);return b?b.toUpperCase():"FILE"},dt=async a=>{try{await navigator.clipboard.writeText(a)}catch{let b=document.createElement("textarea");b.value=a,b.style.position="fixed",b.style.left="-9999px",document.body.appendChild(b),b.focus(),b.select(),document.execCommand("copy"),document.body.removeChild(b)}a7("已复制到剪贴板")},du=a=>{aq([...ap,a]),aV("")},dv=a=>{aq(ap.slice(0,a+1)),aV("")},dw=async()=>{if(!j)return;let a=aU.trim();a?await dh(j,a):await dg(j,ap)},dx=()=>{j&&(bG(""),bE(!0))},dy=async()=>{if(!j)return;let a=bF.trim();if(!a)return void bE(!1);if(a.includes("/"))return void a7("文件夹名不支持 /");let b=ap.length>0?ap.join("/")+"/":"";try{if(as(!0),!(await c0("/api/operate",{method:"POST",body:JSON.stringify({bucket:j,targetKey:`${b}${a}/`,operation:"mkdir"})})).ok)throw Error("mkdir failed");bE(!1),aV(""),await dg(j,ap),a7("新建文件夹成功")}catch{a7("新建文件夹失败，请重试")}finally{as(!1)}},dz=()=>{!j||(0!==aJ.size||aH)&&bQ(!0)},dA=async()=>{if(j)try{as(!0);let a=Array.from(aJ);if(a.length>0){if(!(await c0("/api/operate",{method:"POST",body:JSON.stringify({bucket:j,sourceKeys:a,operation:"deleteMany"})})).ok)throw Error("delete failed")}else if(!aH)return void bQ(!1);else if("folder"===aH.type){if(!(await c0("/api/operate",{method:"POST",body:JSON.stringify({bucket:j,sourceKey:aH.key,operation:"delete"})})).ok)throw Error("delete failed")}else if(!(await c0(`/api/files?bucket=${j}&key=${encodeURIComponent(aH.key)}`,{method:"DELETE"})).ok)throw Error("delete failed");bQ(!1),await dw(),aI(null),aK(new Set),a7("删除成功")}catch{a7("删除失败，请刷新后重试")}finally{as(!1)}},dB=()=>{j&&aH&&(bu(aH.name),bs(!0))},dC=()=>{if(j){if(1===aJ.size)return void(()=>{if(!j)return;let a=Array.from(aJ);if(1!==a.length)return a7("请选择 1 个文件/文件夹进行重命名");let b=d_.find(b=>b.key===a[0]);b?dD(b):a7("未找到选中文件")})();if(aH)return void dB();a7("请选择 1 个文件/文件夹进行重命名")}},dD=a=>{j&&(aI(a),bu(a.name),bs(!0))},dE=async()=>{if(!j||!aH)return;let a=bt.trim();if(!a||a===aH.name)return void bs(!1);let b=aH.key,c="";if("folder"===aH.type){let a=(b.endsWith("/")?b.slice(0,-1):b).split("/").filter(Boolean);c=a.length>1?`${a.slice(0,-1).join("/")}/`:""}else{let a=b.split("/").filter(Boolean);c=a.length>1?`${a.slice(0,-1).join("/")}/`:""}let d=c+a+("folder"===aH.type?"/":"");try{if(as(!0),!(await c0("/api/operate",{method:"POST",body:JSON.stringify({bucket:j,sourceKey:aH.key,targetKey:d,operation:"move"})})).ok)throw Error("rename failed");bs(!1),await dw(),aI(null),aK(new Set),a7("重命名成功")}catch{a7("重命名失败，请刷新后重试")}finally{as(!1)}},dF=a=>{j&&aH&&(by(a),bA(ap.length?ap.join("/")+"/":""),bC([aH.key]),bw(!0))},dG=(a,b)=>{j&&(aI(a),by(b),bA(ap.length?ap.join("/")+"/":""),bC([a.key]),bw(!0))},dH=()=>{if(!j)return;let a=Array.from(aJ).filter(a=>!a.endsWith("/"));a.length?(by("move"),bA(ap.length?ap.join("/")+"/":""),bC(a),bw(!0)):a7("暂不支持文件夹整体移动")},dI=async()=>{if(!j)return;let a=bz.trim();if(!a)return void bw(!1);let b=a;b.startsWith("/")&&(b=b.slice(1));let c=bB.length?bB:aH?[aH.key]:[];if(c.length)try{let a,d;as(!0);let e="move"===bx?"move":"copy";if(!(c.length>1||!aH||c[0]!==aH.key?await c0("/api/operate",{method:"POST",body:JSON.stringify({bucket:j,sourceKeys:c,targetPrefix:b,operation:"move"===e?"moveMany":"copyMany"})}):await c0("/api/operate",{method:"POST",body:JSON.stringify({bucket:j,sourceKey:aH.key,targetKey:(a="folder"===aH.type?"/":"",d=b,b.endsWith("/")?d=b+aH.name+a:"folder"!==aH.type||d.endsWith("/")||(d+="/"),d),operation:e})})).ok)throw Error("operate failed");bw(!1),bC([]),await dw(),aI(null),aK(new Set),a7("move"===bx?"已移动":"已复制")}catch{a7("move"===bx?"移动失败":"复制失败")}finally{as(!1)}},dJ=async(a,b,c)=>{let d=new URLSearchParams;d.set("bucket",a),d.set("key",b),c&&d.set("filename",c),"proxy"===dl(a)&&d.set("forceProxy","1");let e=dp(a);e&&d.set("bucketName",e);let f=await c0(`/api/download?${d.toString()}`),g=await f.json();if(!f.ok||!g.url)throw Error(g.error||"download url failed");return g.url},dK=async(a,b,c)=>{let d=dp(a),e=dl(a),f=d?`&bucketName=${encodeURIComponent(d)}`:"",g=await c0(`/api/download?bucket=${encodeURIComponent(a)}&key=${encodeURIComponent(b)}&download=1&filename=${encodeURIComponent(c)}${f}${"proxy"===e?"&forceProxy=1":""}`),h=await g.json();if(!g.ok||!h.url)throw Error(h.error||"download url failed");return h.url},dL=async a=>{if(j){if("folder"===a.type)return void a7("文件夹打包下载下一步做（当前先支持文件下载）");try{let b=await dK(j,a.key,a.name);dM(b,a.name),a7("已拉起下载")}catch{a7("下载失败")}}},dM=(a,b)=>{let c=document.createElement("a");c.href=a,c.download=b,c.rel="noreferrer",document.body.appendChild(c),c.click(),document.body.removeChild(c)},dN=async()=>{if(!j)return;let a=Array.from(aJ).filter(a=>!a.endsWith("/"));if(!a.length)return void a7("暂不支持文件夹整体批量下载");for(let b of(a7(`开始下载 ${a.length} 个文件`),a))try{let a=b.split("/").pop()||"download",c=await dK(j,b,a);dM(c,a),await new Promise(a=>setTimeout(a,150))}catch{}a7("已拉起批量下载")},dO=async()=>{if(!j)return;let a=dq(bJ||void 0),b=dq(bL||void 0),c=bN.trim()||void 0;if(!c)return void a7("桶名不能为空");try{var d;let e=await c0(`/api/bucket-check?bucketId=${encodeURIComponent(j)}&bucketName=${encodeURIComponent(c)}`),f=await c_(e),g=!!f.ok,h=String(f.hint??"").trim();if(dj(j,{bucketName:c,ok:g,hint:h||void 0,checkedAt:Date.now()}),!g)return void a7(`桶名校验失败：${h||"请检查桶名"}`);let i=await c0("/api/buckets",{method:"PATCH",body:JSON.stringify({id:j,bucketName:c,publicBaseUrl:a,customBaseUrl:b})}),k=await c_(i);if(!i.ok)throw Error(String(k.error??"保存失败"));d={...a0,[j]:{publicBaseUrl:a,customBaseUrl:b,s3BucketName:c}},a1(d),localStorage.setItem("r2_link_config_v1",JSON.stringify(d)),bI(!1),a7("已保存链接设置（桶名校验通过）")}catch(b){let a=e(b,"保存失败，请重试。");dj(j,{bucketName:c,ok:!1,hint:a,checkedAt:Date.now()}),a7(a||"保存失败")}},dP=async(a,b)=>{var c,d;if(!j)return;let e=dm(j),f=(c="public"===b?e.publicBaseUrl:e.customBaseUrl,d=a.key,c?c+d.split("/").map(encodeURIComponent).join("/"):null);f?await dt(f):a7("public"===b?"未配置公共开发 URL":"未配置自定义域名")},dQ=async a=>{if(!j||"folder"===a.type)return;let b=a.name.toLowerCase(),c=dr(a.name),d="other";"pdf"===c?d="pdf":/^(doc|docx|ppt|pptx|xls|xlsx)$/.test(c)?d="office":/\.(png|jpg|jpeg|gif|webp|svg)$/.test(b)?d="image":/\.(mp4|mov|mkv|webm)$/.test(b)?d="video":/\.(mp3|wav|flac|ogg)$/.test(b)?d="audio":/\.(txt|log|md|json|csv|ts|tsx|js|jsx|css|html|xml|yml|yaml)$/.test(b)&&(d="text");try{let b=await dJ(j,a.key,a.name),c={name:a.name,key:a.key,bucket:j,kind:d,url:b};if(aM(c),"text"===d){let c=await fetch(b,{headers:{Range:"bytes=0-204799"}}),d=await c.text();aM(b=>b&&b.key===a.key?{...b,text:d}:b)}}catch{a7("预览失败")}},dR=a=>!Number.isFinite(a)||a<=0?"-":`${ad(a)}/s`,dS=(a,b,c,d,e)=>new Promise((f,g)=>{let h=new XMLHttpRequest;if(h.open("PUT",a,!0),h.setRequestHeader("Content-Type",c||"application/octet-stream"),e){if(e.aborted)return void g(Error("上传已中止"));let a=()=>{try{h.abort()}catch{}};e.addEventListener("abort",a,{once:!0}),h.addEventListener("loadend",()=>{e.removeEventListener("abort",a)},{once:!0})}h.upload.onprogress=a=>{a.lengthComputable&&d(a.loaded,a.total)},h.onload=()=>{h.status>=200&&h.status<300?f({etag:h.getResponseHeader("ETag")}):g(Error(`上传失败（状态码：${h.status}）`))},h.onerror=()=>g(Error("网络异常，请重试")),h.onabort=()=>g(Error("上传已中止")),h.send(b)}),dT=async(a,b,c,d,f,g)=>{let h;try{h=await c0("/api/files",{method:"POST",body:JSON.stringify({bucket:b,key:c,contentType:d.type})})}catch(b){let a=b instanceof Error?b.message:String(b);throw Error(`请求上传签名失败：${a}`)}let i=await c_(h);if(!h.ok||!i.url)throw Error(e(i.error,`上传签名失败（状态码：${h.status}）`));await dS(i.url,d,d.type,a=>f(a),g)},dU=async(a,b,c,d,f,g)=>{let h,i=a=>1048576*Math.ceil(Math.max(8388608,Math.min(0x4000000,Math.ceil(a/6)))/1048576),j=aj(b,c,d),k=b9.current.find(b=>b.id===a),l=k?.multipart,m=(h=ak()[j])&&"object"==typeof h?h:null,n=l?.uploadId??m?.uploadId??null,o=l?.partSize??m?.partSize??i(d.size),p=l?.parts??m?.parts??{};if(m&&(m.size!==d.size||m.lastModified!==d.lastModified)&&(n=l?.uploadId??null,p=l?.parts??{},an(j)),!n){let a;try{a=await c0("/api/multipart",{method:"POST",body:JSON.stringify({action:"create",bucket:b,key:c,contentType:d.type})})}catch(b){let a=b instanceof Error?b.message:String(b);throw Error(`创建分片上传失败：${a}`)}let f=await c_(a);if(!a.ok||!f.uploadId)throw Error(e(f.error,`创建分片上传失败（状态码：${a.status}）`));n=f.uploadId,p={},o=i(d.size)}dV(a,a=>({...a,resumeKey:j,multipart:{uploadId:n,partSize:o,parts:p}})),am(j,{bucket:b,key:c,size:d.size,lastModified:d.lastModified,name:d.name,uploadId:n,partSize:o,parts:p});let q=Math.ceil(d.size/o),r=new Map,s=Math.min(6,q),t=1,u=!1,v=async h=>{let i;if(p[String(h)])return;let k=(h-1)*o,l=Math.min(d.size,k+o),m=d.slice(k,l);try{i=await c0("/api/multipart",{method:"POST",body:JSON.stringify({action:"signPart",bucket:b,key:c,uploadId:n,partNumber:h})})}catch(b){let a=b instanceof Error?b.message:String(b);throw Error(`获取分片上传签名失败：${a}`)}let q=await c_(i);if(!i.ok||!q.url)throw Error(e(q.error,`分片签名失败（状态码：${i.status}）`));let s=Object.keys(p).reduce((a,b)=>{let c=Number.parseInt(b,10);if(!Number.isFinite(c)||c<=0)return a;let e=(c-1)*o;return a+Math.max(0,Math.min(d.size,e+o)-e)},0),{etag:t}=await dS(q.url,m,d.type,(a,b)=>{r.set(h,a);let c=Array.from(r.values()).reduce((a,b)=>a+b,0);f(Math.min(d.size,s+c)),a===b&&r.set(h,b)},g);if(!t)throw Error("上传响应缺少 ETag");p[String(h)]=t,dV(a,a=>a.multipart?{...a,multipart:{...a.multipart,parts:{...a.multipart.parts,[String(h)]:t}}}:a),am(j,{bucket:b,key:c,size:d.size,lastModified:d.lastModified,name:d.name,uploadId:n,partSize:o,parts:p})},w=async()=>{for(;;){if(u)return;let a=t++;if(a>q)return;await v(a)}};try{let a;await Promise.all(Array.from({length:Math.min(s,q)},w));let d=Object.entries(p).map(([a,b])=>({partNumber:Number.parseInt(a,10),etag:b})).filter(a=>Number.isFinite(a.partNumber)&&a.partNumber>0).sort((a,b)=>a.partNumber-b.partNumber);try{a=await c0("/api/multipart",{method:"POST",body:JSON.stringify({action:"complete",bucket:b,key:c,uploadId:n,parts:d})})}catch(b){let a=b instanceof Error?b.message:String(b);throw Error(`完成分片上传失败：${a}`)}let f=await c_(a);if(!a.ok)throw Error(e(f.error,`完成分片上传失败（状态码：${a.status}）`));an(j)}catch(h){u=!0;let d=b9.current.find(b=>b.id===a),e=d?.status,f=g?.aborted===!0;throw f&&"paused"===e||f&&"canceled"===e&&(await c0("/api/multipart",{method:"POST",body:JSON.stringify({action:"abort",bucket:b,key:c,uploadId:n})}).catch(()=>{}),an(j)),h}},dV=(a,b)=>{aQ(c=>c.map(c=>c.id===a?b(c):c))},dW=a=>{aQ(b=>b.map(b=>b.id===a&&("paused"===b.status||"error"===b.status)?{...b,status:"queued",speedBps:0,startedAt:void 0,error:void 0}:b)),aS(!1),setTimeout(()=>dZ(),0)},dX=async a=>{let b=b9.current.find(b=>b.id===a);if(b?.multipart?.uploadId)try{await c0("/api/multipart",{method:"POST",body:JSON.stringify({action:"abort",bucket:b.bucket,key:b.key,uploadId:b.multipart.uploadId})})}catch{}finally{b.resumeKey&&an(b.resumeKey)}},dY=a=>{aQ(b=>b.map(b=>b.id===a&&("queued"===b.status||"uploading"===b.status||"paused"===b.status)?{...b,status:"canceled",speedBps:0}:b)),cb.current.get(a)?.abort(),dX(a),a7("已取消")},dZ=async()=>{if(!ca.current&&!cc.current){ca.current=!0;try{for(;!cc.current;){let a=b9.current.find(a=>"queued"===a.status);if(!a)break;let b=new AbortController;cb.current.set(a.id,b),dV(a.id,a=>({...a,status:"uploading",startedAt:performance.now(),loaded:"number"==typeof a.loaded&&a.loaded>0?a.loaded:0,speedBps:0,error:void 0}));let c=a.file.size>=0x4600000?dU:dT,d=performance.now(),e=a.loaded??0;try{await c(a.id,a.bucket,a.key,a.file,b=>{let c=performance.now(),f=Math.max(0,b-e),g=Math.max(.25,(c-d)/1e3),h=f/g;d=c,e=b,dV(a.id,a=>({...a,loaded:b,speedBps:Number.isFinite(h)?h:0}))},b.signal),dV(a.id,a=>({...a,status:"done",loaded:a.file.size,speedBps:0,multipart:void 0})),j===a.bucket&&dg(a.bucket,ap),a.resumeKey&&an(a.resumeKey)}catch(d){let b=d instanceof Error?d.message:String(d),c=b9.current.find(b=>b.id===a.id);c?.status==="paused"||c?.status==="canceled"||dV(a.id,a=>({...a,status:"error",error:b,speedBps:0}))}finally{cb.current.delete(a.id)}}}finally{ca.current=!1}}},d$=async a=>{if(!a.target.files||!j)return;let b=Array.from(a.target.files),c=ap.length>0?ap.join("/")+"/":"",d=b.map(a=>({id:globalThis.crypto?.randomUUID?.()??`${Date.now()}_${Math.random().toString(16).slice(2)}`,bucket:j,file:a,key:c+a.name,resumeKey:aj(j,c+a.name,a),loaded:0,speedBps:0,status:"queued"}));aQ(a=>[...d,...a].slice(0,50)),aO(!0),a7(`已加入 ${d.length} 个上传任务`),aT.current&&(aT.current.value=""),setTimeout(()=>dZ(),0)},d_=(0,c.useMemo)(()=>aU.trim()?aW:al,[al,aW,aU]),d0=(0,c.useMemo)(()=>{let a=aP.reduce((a,b)=>a+b.file.size,0),b=aP.reduce((a,b)=>a+Math.min(b.loaded,b.file.size),0),c=aP.filter(a=>"queued"===a.status||"uploading"===a.status).length,d=aP.reduce((a,b)=>a+("uploading"===b.status?b.speedBps:0),0),e=a?Math.min(100,Math.round(b/a*100)):0;return{active:c,total:aP.length,pct:e,speedText:dR(d)}},[aP]),d1=(0,c.useMemo)(()=>{let a=al.filter(a=>"file"===a.type).length;return{fileCount:a,folderCount:al.filter(a=>"folder"===a.type).length,totalSize:al.reduce((a,b)=>a+(b.size||0),0)}},[al]),d2=(a,c,d="lg")=>{let e="lg"===d?"w-8 h-8":"w-5 h-5";if("folder"===a)return(0,b.jsx)(k,{className:`${e} text-yellow-500 ${"lg"===d?"fill-yellow-500/20":""}`});let f=c.toLowerCase(),g=dr(c);return/\.(jpg|png|gif|webp|svg)$/.test(f)?(0,b.jsx)(w,{className:`${e} text-purple-500`}):/\.(mp4|mov|mkv|webm)$/.test(f)?(0,b.jsx)(y,{className:`${e} text-red-500`}):/\.(mp3|wav|flac|ogg)$/.test(f)?(0,b.jsx)(x,{className:`${e} text-blue-500`}):/(zip|rar|7z|tar|gz|bz2|xz)$/.test(g)?(0,b.jsx)(A,{className:`${e} text-amber-600`}):/(xls|xlsx|csv)$/.test(g)?(0,b.jsx)(C,{className:`${e} text-emerald-600`}):"json"===g?(0,b.jsx)(E,{className:`${e} text-orange-600`}):"pdf"===g?(0,b.jsx)(D,{className:`${e} text-rose-600`}):/(doc|docx|ppt|pptx)$/.test(g)?(0,b.jsx)(D,{className:`${e} text-sky-600`}):/(apk|ipa|dmg|pkg|exe|msi|deb|rpm)$/.test(g)?(0,b.jsx)(D,{className:`${e} text-slate-600`}):/(ts|tsx|js|jsx|css|html|xml|yml|yaml|md|txt|log|sh|bash|py|go|rs|java|kt|c|cpp|h|hpp)$/.test(g)?(0,b.jsx)(B,{className:`${e} text-indigo-600`}):(0,b.jsx)(v,{className:`${e} text-gray-400`})};if(az){let a=!a9||bf;return(0,b.jsxs)("div",{className:`bg-gradient-to-br from-slate-50 via-white to-slate-50 dark:from-gray-950 dark:via-gray-950 dark:to-gray-900 px-4 sm:px-6 font-sans text-gray-900 dark:text-gray-100 pt-[max(1rem,env(safe-area-inset-top))] pb-[max(1rem,env(safe-area-inset-bottom))] ${a9?"min-h-dvh overflow-y-auto":"h-dvh overflow-hidden flex items-center justify-center"}`,children:[(0,b.jsxs)("div",{className:`w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-6 ${a9?"h-auto items-start":"h-full min-h-0 items-stretch"}`,children:[(0,b.jsxs)("section",{className:`min-h-0 rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col order-2 lg:order-1 dark:border-gray-800 dark:bg-gray-900 ${a?"":"hidden"}`,children:[(0,b.jsx)("div",{className:"px-8 py-7 h-[168px] bg-gradient-to-br from-indigo-600 to-blue-600 text-white flex items-center",children:(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-white/85",children:ae.title}),(0,b.jsx)("h1",{className:"mt-2 text-3xl font-semibold tracking-tight",children:"公告与说明"}),(0,b.jsx)("p",{className:"mt-2 text-white/80",children:ae.subtitle})]})}),(0,b.jsxs)("div",{className:["px-8 py-6 flex flex-col gap-5",a9?"":"grow overflow-y-auto"].filter(Boolean).join(" "),children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:"平台优势"}),(0,b.jsx)("ul",{className:"mt-3 space-y-2 text-sm text-gray-800 dark:text-gray-200",children:ae.advantages.map(a=>(0,b.jsxs)("li",{className:"flex gap-3",children:[(0,b.jsx)("span",{className:"mt-2 h-1.5 w-1.5 rounded-full bg-blue-600 flex-none"}),(0,b.jsx)("span",{className:"leading-relaxed",children:a})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:ae.announcementTitle}),(0,b.jsx)("div",{className:"mt-3 rounded-2xl border border-gray-200 bg-gray-50 p-4 text-sm text-gray-700 whitespace-pre-wrap leading-relaxed dark:border-gray-800 dark:bg-gray-950/30 dark:text-gray-200",children:ae.announcementText})]}),(0,b.jsxs)("div",{className:"mt-auto",children:[(0,b.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:"导航"}),(0,b.jsx)("nav",{className:"mt-3 grid grid-cols-4 gap-2",children:af.map(a=>{let c="globe"===a.icon?(0,b.jsx)(S,{className:"w-5 h-5"}):"book"===a.icon?(0,b.jsx)(V,{className:"w-5 h-5"}):"about"===a.icon?(0,b.jsx)(T,{className:"w-5 h-5"}):(0,b.jsx)(U,{className:"w-5 h-5"});return(0,b.jsxs)("a",{href:a.href,target:a.href.startsWith("mailto:")?void 0:"_blank",rel:a.href.startsWith("mailto:")?void 0:"noreferrer",className:"group rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-colors px-2 py-3 flex flex-col items-center justify-center gap-2 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-900",children:[(0,b.jsx)("div",{className:"text-gray-700 group-hover:text-blue-600 transition-colors dark:text-gray-200 dark:group-hover:text-blue-300",children:c}),(0,b.jsx)("div",{className:"text-[12px] text-gray-700 group-hover:text-blue-600 transition-colors dark:text-gray-200 dark:group-hover:text-blue-300",children:a.label})]},a.href)})}),(0,b.jsxs)("div",{className:"mt-6 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[(0,b.jsx)("span",{children:ae.footer}),(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),"Serverless"]})]})]})]})]}),(0,b.jsxs)("section",{className:"min-h-0 rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col order-1 lg:order-2 dark:border-gray-800 dark:bg-gray-900",children:[(0,b.jsx)("div",{className:"px-6 py-4 sm:px-8 sm:py-7 sm:h-[168px] bg-blue-600 text-white flex items-center shrink-0",children:(0,b.jsxs)("div",{className:"flex items-center gap-4 w-full",children:[(0,b.jsx)("div",{className:"h-16 w-16 flex items-center justify-center shrink-0",children:(0,b.jsx)(_,{className:"w-16 h-16"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-semibold leading-tight",children:ae.title}),(0,b.jsx)("div",{className:"mt-1 text-[17px] text-white/80",children:ae.subtitle})]})]})}),(0,b.jsxs)("div",{className:["px-8 py-7 flex flex-col gap-5",a9?"":"grow overflow-y-auto"].filter(Boolean).join(" "),children:[(0,b.jsx)("div",{className:"mx-auto w-full max-w-sm",children:(0,b.jsxs)("div",{className:"relative grid grid-cols-2 rounded-xl border border-gray-200 bg-gray-50 p-1 dark:border-gray-800 dark:bg-gray-950/40",children:[(0,b.jsx)("span",{"aria-hidden":"true",className:`absolute left-1 top-1 bottom-1 w-[calc(50%-0.25rem)] rounded-lg bg-blue-600 transition-transform duration-300 ease-out ${bV?"translate-x-full":"translate-x-0"}`}),(0,b.jsx)("button",{type:"button",onClick:()=>{bW(!1),cs("")},className:`relative z-10 rounded-lg py-2 text-sm font-semibold transition-colors ${bV?"text-gray-600 dark:text-gray-300":"text-white"}`,children:"登陆"}),(0,b.jsx)("button",{type:"button",onClick:()=>{bW(!0),cs("")},className:`relative z-10 rounded-lg py-2 text-sm font-semibold transition-colors ${bV?"text-white":"text-gray-600 dark:text-gray-300"}`,children:"注册"})]})}),(0,b.jsx)("div",{className:"text-center",children:(0,b.jsx)("h2",{className:"text-3xl font-bold tracking-tight text-blue-600 dark:text-blue-400",children:bV?"账号注册":"账号登录"})}),(0,b.jsx)("div",{className:"min-h-[286px] sm:min-h-[296px]",children:bV?(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),c6(a)},className:"flex h-full flex-col",children:[(0,b.jsxs)("div",{className:"space-y-5 min-h-[210px]",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱账号"}),(0,b.jsx)("input",{type:"email",value:ch,onChange:a=>{ci(a.target.value),cq("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"登陆密码"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:cl?"text":"password",value:cj,onChange:a=>{ck(a.target.value),cq("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all pr-10 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"}),(0,b.jsx)("button",{type:"button",onClick:()=>cm(a=>!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":cl?"隐藏密码":"显示密码",children:cl?(0,b.jsx)(I,{className:"w-5 h-5"}):(0,b.jsx)(H,{className:"w-5 h-5"})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 py-0 min-h-9",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",id:"register_agree",checked:cn,onChange:a=>{co(a.target.checked),cq("")},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-700"}),(0,b.jsx)("label",{htmlFor:"register_agree",className:"ml-2 block text-sm text-gray-600 dark:text-gray-300",children:"我已阅读并同意「用户协议」和「隐私政策」"})]}),(0,b.jsx)("span",{"aria-hidden":"true",className:"shrink-0 px-2 py-1 text-sm invisible select-none",children:"忘记密码"})]})]}),(0,b.jsxs)("div",{className:"mt-auto pt-2 space-y-2",children:[(0,b.jsx)("div",{className:"min-h-4",children:cp?(0,b.jsx)("div",{className:"text-sm text-red-600 leading-tight text-left dark:text-red-300",children:cp}):null}),(0,b.jsxs)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors shadow-blue-500/20 shadow-lg inline-flex items-center justify-center gap-2",children:[(0,b.jsx)(G,{className:"w-5 h-5"}),"注册账号"]})]})]}):(0,b.jsxs)("form",{onSubmit:c5,className:"flex h-full flex-col",children:[(0,b.jsxs)("div",{className:"space-y-5 min-h-[210px]",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱账号"}),(0,b.jsx)("input",{type:"email",value:cd,onChange:a=>{ce(a.target.value),cs("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"登陆密码"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("input",{type:cP?"text":"password",value:cf,onChange:a=>{cg(a.target.value),cs("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all pr-10 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入密码"}),(0,b.jsx)("button",{type:"button",onClick:()=>cQ(!cP),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:cP?(0,b.jsx)(I,{className:"w-5 h-5"}):(0,b.jsx)(H,{className:"w-5 h-5"})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 py-0 min-h-9",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",id:"remember",checked:cN,onChange:a=>cO(a.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-700"}),(0,b.jsx)("label",{htmlFor:"remember",className:"ml-2 block text-sm text-gray-600 dark:text-gray-300",children:"记住登录状态"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{cw(cd.trim()),cu(!0)},className:"shrink-0 px-2 py-1 rounded-md text-sm text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition-colors dark:text-gray-300 dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:"忘记密码"})]})]}),(0,b.jsxs)("div",{className:"mt-auto pt-2 space-y-2",children:[(0,b.jsx)("div",{className:"min-h-4",children:cr?(0,b.jsx)("div",{className:"text-sm text-red-600 leading-tight text-left dark:text-red-300",children:cr}):null}),(0,b.jsxs)("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors shadow-blue-500/20 shadow-lg inline-flex items-center justify-center gap-2",children:[(0,b.jsx)(G,{className:"w-5 h-5"}),"进入管理"]})]})]})}),a9?(0,b.jsxs)("button",{type:"button",onClick:()=>bg(a=>!a),className:"mt-1 inline-flex w-fit self-start items-center gap-1.5 px-0 py-0 text-xs font-medium text-gray-500 hover:text-blue-600 transition-colors dark:text-gray-400 dark:hover:text-blue-300",children:[bf?"收起「公告与说明」":"展开「公告与说明」",(0,b.jsx)(u,{className:`w-3.5 h-3.5 transition-transform ${bf?"rotate-180":""}`})]}):null]})]})]}),(0,b.jsx)(d,{open:ct,title:"找回密码",description:"输入注册邮箱，我们会发送重置密码邮件。",onClose:()=>cu(!1),footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>cu(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{c7()},disabled:ar,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"发送重置邮件"})]}),children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"注册邮箱"}),(0,b.jsx)("input",{type:"email",value:cv,onChange:a=>cw(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入注册邮箱"})]})}),(0,b.jsx)(d,{open:cx,title:"设置新密码",description:"请设置新的登陆密码，设置完成后使用新密码登录。",onClose:()=>cy(!1),footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>cy(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"稍后再说"}),(0,b.jsx)("button",{onClick:()=>{c8()},disabled:ar,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"保存新密码"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新密码"}),(0,b.jsx)("input",{type:"password",value:cz,onChange:a=>cA(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"确认新密码"}),(0,b.jsx)("input",{type:"password",value:cB,onChange:a=>cC(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"再次输入新密码"})]})]})}),c$]})}let d3=a=>{if(!a)return"";let b=h.find(b=>b.id===a);return b?.Name||a},d4=j?d3(j):null,d5=b7?h.find(a=>a.id===b7)??null:null,d6=!bZ,d7=a=>a?h.find(b=>b.id===a)??null:null,d8=a=>{ag(a),aq([]),aV(""),aI(null),aK(new Set),bj(!1),a9&&bc(!1),a7(`已切换到：${d3(a)}`)},d9=()=>{b0(!1),b$(null),cU({}),db(),bY(!0)},ea=({onClose:c})=>{let d,e,f,g,i,k,l,m,n,o;return(0,b.jsxs)("div",{className:`h-full w-full bg-white border-r border-gray-200 flex flex-col dark:bg-gray-900 dark:border-gray-800 ${c?"shadow-sm":""}`,children:[(0,b.jsxs)("div",{className:"h-16 px-5 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,b.jsx)(_,{className:"w-10 h-10 md:w-11 md:h-11 shrink-0"}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("h1",{className:"font-bold text-[18px] leading-[1.15] tracking-tight text-blue-600 truncate dark:text-blue-400",children:ae.title}),(0,b.jsx)("p",{className:"mt-0.25 text-[13px] leading-[1.1] text-gray-400 font-medium truncate dark:text-gray-400",children:ae.subtitle})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:c?(0,b.jsx)("button",{type:"button",onClick:c,className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800","aria-label":"关闭菜单",children:(0,b.jsx)(O,{className:"w-5 h-5"})}):null})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col overflow-y-auto",children:[(0,b.jsx)("div",{className:"p-3 space-y-3 shrink-0",children:(0,b.jsxs)("div",{className:"px-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase px-2 tracking-wider leading-none dark:text-gray-400",children:"存储桶"}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:(0,b.jsx)("button",{type:"button",onClick:()=>{df(),a7("已刷新桶列表")},className:"px-2 py-1 rounded-md text-xs font-medium text-blue-600 hover:bg-blue-50 leading-none dark:text-blue-300 dark:hover:bg-blue-950/30",title:"刷新桶列表","aria-label":"刷新桶列表",children:"刷新"})})]}),a9?(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsxs)("select",{value:j??"",onChange:a=>{let b=a.target.value;b&&d8(b)},className:"w-full rounded-xl border border-gray-200 bg-white px-3 py-2.5 text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-label":"选择存储桶",children:[(0,b.jsx)("option",{value:"",disabled:!0,children:"选择存储桶"}),h.map(a=>(0,b.jsx)("option",{value:a.id,children:d3(a.id)},a.id))]})}):(0,b.jsxs)("div",{ref:bh,className:"relative mt-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>bj(a=>!a),className:"w-full rounded-xl border border-gray-200 bg-white px-3 py-2.5 text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 flex items-center justify-between gap-3","aria-haspopup":"listbox","aria-expanded":bi,children:[(0,b.jsx)("span",{className:"truncate",children:j?d3(j):"选择存储桶"}),(0,b.jsx)(u,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform ${bi?"rotate-180":""}`})]}),bi?(0,b.jsx)("div",{className:"absolute left-0 right-0 top-[calc(100%+0.5rem)] z-20 rounded-2xl border border-gray-200 bg-white shadow-xl overflow-hidden dark:border-gray-800 dark:bg-gray-900",children:(0,b.jsx)("div",{className:"max-h-[40vh] overflow-auto p-2",children:h.length?h.map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>d8(a.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm transition-colors ${j===a.id?"bg-blue-50 text-blue-700 font-medium dark:bg-blue-950/40 dark:text-blue-200":"text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-800"}`,children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${j===a.id?"bg-blue-500":"bg-gray-300 dark:bg-gray-700"}`}),(0,b.jsx)("span",{className:"truncate",children:d3(a.id)})]},a.id)):(0,b.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 dark:text-gray-400",children:"暂无桶"})})}):null]}),(0,b.jsx)("div",{className:"mt-2 text-[10px] text-gray-500 px-1 leading-relaxed dark:text-gray-400",children:"桶管理入口已移至底部「当前登录账号」模块。"})]})}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50/50 space-y-3 dark:border-gray-800 dark:bg-gray-950/30 shrink-0",children:[(0,b.jsxs)("div",{className:`text-xs px-3 py-2 rounded-md border ${"connected"===at?"bg-green-50 text-green-700 border-green-100 dark:bg-green-950/40 dark:text-green-200 dark:border-green-900":"checking"===at?"bg-yellow-50 text-yellow-700 border-yellow-100 dark:bg-yellow-950/35 dark:text-yellow-200 dark:border-yellow-900":"unbound"===at?"bg-blue-50 text-blue-700 border-blue-100 dark:bg-blue-950/40 dark:text-blue-200 dark:border-blue-900":"bg-red-50 text-red-700 border-red-100 dark:bg-red-950/40 dark:text-red-200 dark:border-red-900"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(aa,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"font-medium",children:"connected"===at?"连接状态正常":"checking"===at?"连接中...":"unbound"===at?"未绑定存储桶":"连接异常"})]}),"connected"===at?(d=j?h.find(a=>a.id===j)?.transferMode:void 0,e=j?dm(j):void 0,f=String(e?.s3BucketName??"").trim(),g=j?dn(j):null,i=j?dl(j):"auto",k="当前传输通道：未检测",l=null,m="auto"===i?"":"（手动）","presigned"===d?(k="proxy"===i?`当前传输通道：Pages 代理${m}`:`当前传输通道：R2 直连${m}`,f&&(l=g?g.ok?null:`桶名校验失败：${f}，${g.hint||"请检查桶名"}（已忽略此桶名设置）`:null)):"presigned_needs_bucket_name"===d?f?g?g.ok?(k="proxy"===i?`当前传输通道：Pages 代理${m}`:`当前传输通道：R2 直连${m}`,l=null):(k=`当前传输通道：Pages 代理${m}`,l=`桶名校验失败：${f}${g.hint||"请检查桶名"}，无法启用「R2 直连」，已回退至「Pages 代理」`):(k="proxy"===i?`当前传输通道：Pages 代理${m}`:`当前传输通道：R2 直连${m}`,l=null):(k=`当前传输通道：Pages 代理${m}`,l="已配置 R2 直连，如需启动 R2 直连，请先在「编辑桶」中确认桶名并完成校验。"):"proxy"===d&&(k=`当前传输通道：Pages 代理${m}`),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"mt-1 text-[11px] leading-relaxed opacity-80",children:k}),l?(0,b.jsx)("div",{className:"mt-1 text-[10px] leading-relaxed opacity-80",children:l}):null]})):null,av&&!ax?(0,b.jsx)("div",{className:"mt-1 text-[10px] leading-relaxed opacity-80",children:av}):null]}),"connected"===at&&j?(0,b.jsx)("div",{className:"px-3 py-2 rounded-md border border-gray-200 bg-white text-xs text-gray-600 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"font-medium truncate",children:"选择传输通道"}),(n=dl(j),o=h.find(a=>a.id===j)?.transferMode!=="proxy",a9?(0,b.jsxs)("select",{value:n,onChange:a=>{let b=a.target.value||"auto";dk(j,b),a7("auto"===b?"已切换传输模式（自动）":"presigned"===b?"已切换传输模式（R2 直连）":"已切换传输模式（Pages 代理）")},className:"shrink-0 rounded-md border border-gray-200 bg-white px-2 py-1 text-[12px] text-gray-700 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-label":"切换传输模式",title:"选择传输通道",children:[(0,b.jsx)("option",{value:"auto",children:"自动"}),(0,b.jsx)("option",{value:"presigned",disabled:!o,children:"R2 直连"}),(0,b.jsx)("option",{value:"proxy",children:"Pages 代理"})]}):(0,b.jsxs)("div",{ref:bk,className:"relative",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>bm(a=>!a),className:"inline-flex items-center gap-2 rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-700 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-haspopup":"listbox","aria-expanded":bl,title:"选择传输通道",children:[(0,b.jsx)("span",{className:"leading-none",children:"auto"===n?"自动":"presigned"===n?"R2 直连":"Pages 代理"}),(0,b.jsx)(u,{className:`w-3.5 h-3.5 opacity-70 transition-transform ${bl?"rotate-180":""}`})]}),bl?(0,b.jsx)("div",{className:"absolute right-0 top-[calc(100%+0.5rem)] z-30 min-w-[10rem] rounded-xl border border-gray-200 bg-white shadow-xl overflow-hidden dark:border-gray-800 dark:bg-gray-900",children:(0,b.jsx)("div",{className:"p-2 space-y-1",children:[{value:"auto",label:"自动",disabled:!1},{value:"presigned",label:"R2 直连",disabled:!o},{value:"proxy",label:"Pages 代理",disabled:!1}].map(a=>(0,b.jsxs)("button",{type:"button",disabled:a.disabled,onClick:()=>{bm(!1),dk(j,a.value),a7("auto"===a.value?"已切换传输模式（自动）":"presigned"===a.value?"已切换传输模式（R2 直连）":"已切换传输模式（Pages 代理）")},className:["w-full flex items-center justify-between gap-3 px-3 py-2 rounded-lg text-[12px] transition-colors",a.value===n?"bg-blue-50 text-blue-700 font-medium dark:bg-blue-950/40 dark:text-blue-200":"text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-800",a.disabled?"opacity-50 cursor-not-allowed hover:bg-transparent dark:hover:bg-transparent":""].filter(Boolean).join(" "),role:"option","aria-selected":a.value===n,children:[(0,b.jsx)("span",{children:a.label}),(0,b.jsx)("span",{className:["w-2 h-2 rounded-full",a.value===n?"bg-blue-500":"bg-gray-300 dark:bg-gray-700"].join(" "),"aria-hidden":"true"})]},a.value))})}):null]}))]})}):null,(0,b.jsxs)("div",{className:"px-3 py-2 rounded-md border border-gray-200 bg-white text-xs text-gray-600 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("span",{className:"font-medium truncate",children:"当前桶占用估算"}),(0,b.jsx)("button",{onClick:()=>j&&di(j),disabled:!j||aF,className:"text-[11px] text-blue-600 hover:text-blue-700 disabled:opacity-50 dark:text-blue-300 dark:hover:text-blue-200",children:aF?"计算中...":"刷新"})]}),(0,b.jsxs)("div",{className:"mt-1.5 flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"对象数"}),(0,b.jsx)("span",{className:"text-[11px] font-semibold text-gray-800 dark:text-gray-100",children:aB?aB.truncated?`≥${aB.objects}`:`${aB.objects}`:"-"})]}),(0,b.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"容量"}),(0,b.jsx)("span",{className:"text-[11px] font-semibold text-gray-800 dark:text-gray-100",children:aB?aB.truncated?`≥${ad(aB.bytes)}`:ad(aB.bytes):"-"})]}),aB?.truncated?(0,b.jsxs)("div",{className:"mt-1 text-[10px] text-gray-400 dark:text-gray-500",children:["仅扫描前 ",aB.pagesScanned," 页（每页最多 1000 项）"]}):null,aD&&!ax?(0,b.jsx)("div",{className:"mt-1 text-[10px] text-red-600 leading-relaxed dark:text-red-300",children:aD}):null]}),(0,b.jsxs)("button",{type:"button",onClick:()=>b0(!0),className:"w-full px-3 py-2 rounded-md border border-gray-200 bg-white text-left text-xs text-gray-600 hover:bg-gray-50 transition-colors dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200 dark:hover:bg-gray-800",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-blue-50 text-blue-600 dark:bg-blue-950/40 dark:text-blue-300",children:(0,b.jsx)(X,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"font-medium truncate",children:"当前登录账号"}),(0,b.jsx)("div",{className:"mt-0.5 text-[11px] font-semibold text-gray-800 truncate dark:text-gray-100",children:a?.email?a.email:"未读取到邮箱"}),(0,b.jsxs)("div",{className:"mt-0.5 text-[10px] text-gray-500 dark:text-gray-400",children:["已绑定桶：",h.length]})]})]}),(0,b.jsx)("div",{className:"mt-2 text-[10px] text-gray-400 dark:text-gray-500",children:"点击进入账号中心，管理当前账号下的存储桶。"})]}),(0,b.jsxs)("button",{onClick:()=>bS(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-600 hover:bg-red-50 hover:text-red-600 hover:border-red-200 rounded-lg text-xs font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-red-950/40 dark:hover:text-red-200 dark:hover:border-red-900",children:[(0,b.jsx)(F,{className:"w-3 h-3"}),"退出登录"]})]})]})]})},eb=({onClose:a,compact:c})=>(0,b.jsxs)("div",{className:"h-full w-full bg-white border-l border-gray-200 flex flex-col shadow-sm dark:bg-gray-900 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"h-16 px-5 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,b.jsx)("h2",{className:"font-bold text-gray-800 text-sm uppercase tracking-wide dark:text-gray-100",children:"详细信息"}),a?(0,b.jsx)("button",{type:"button",onClick:a,className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800","aria-label":"关闭详情",children:(0,b.jsx)(O,{className:"w-5 h-5"})}):null]}),(0,b.jsxs)("div",{className:`flex-1 overflow-y-auto ${c?"p-4 space-y-5":"p-6 space-y-8"}`,children:[aH?(0,b.jsxs)("div",{className:`${c?"space-y-4":"space-y-6"} animate-in fade-in slide-in-from-right-4 duration-300`,children:[(0,b.jsxs)("div",{className:c?"flex items-center gap-3":"flex flex-col items-center",children:[(0,b.jsx)("div",{className:`${c?"w-14 h-14 rounded-xl":"w-16 h-16 rounded-2xl"} bg-gray-50 border border-gray-100 flex items-center justify-center ${c?"":"mb-4"} shadow-sm dark:bg-gray-950 dark:border-gray-800`,children:d2(aH.type,aH.name)}),(0,b.jsxs)("div",{className:c?"min-w-0 flex-1":"",children:[(0,b.jsx)("h3",{className:`font-semibold text-gray-900 ${c?"text-left break-words":"text-center break-all px-2"} leading-snug dark:text-gray-100`,children:aH.name}),c?(0,b.jsxs)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["folder"===aH.type?"文件夹":ad(aH.size),aH.lastModified?` \xb7 ${new Date(aH.lastModified).toLocaleDateString()}`:""]}):(0,b.jsxs)("div",{className:"mt-2 flex flex-wrap items-center justify-center gap-2",children:[(0,b.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:ds(aH)}),(0,b.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["folder"===aH.type?"文件夹":"文件","file"===aH.type?` \xb7 ${ad(aH.size)}`:"",aH.lastModified?` \xb7 ${new Date(aH.lastModified).toLocaleDateString()}`:""]})]})]})]}),"folder"===aH.type?(0,b.jsxs)("div",{className:`grid grid-cols-2 ${c?"gap-2 pt-1":"gap-3 pt-2"}`,children:[(0,b.jsxs)("button",{onClick:()=>du(aH.name),className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors col-span-2",children:[(0,b.jsx)(N,{className:"w-4 h-4"}),"打开文件夹"]}),(0,b.jsxs)("button",{onClick:dB,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(z,{className:"w-4 h-4"}),"重命名"]}),(0,b.jsxs)("button",{onClick:()=>dF("move"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(M,{className:"w-4 h-4"}),"移动"]}),(0,b.jsxs)("button",{onClick:()=>dF("copy"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(L,{className:"w-4 h-4"}),"复制"]}),(0,b.jsxs)("button",{onClick:dz,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-200 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-red-200 dark:hover:bg-red-950/40 dark:hover:border-red-900",children:[(0,b.jsx)(l,{className:"w-4 h-4"}),"删除"]})]}):(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[(0,b.jsxs)("button",{onClick:()=>dQ(aH),className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors col-span-2",children:[(0,b.jsx)(H,{className:"w-4 h-4"}),"预览"]}),(0,b.jsxs)("button",{onClick:()=>dL(aH),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(J,{className:"w-4 h-4"}),"下载"]}),(0,b.jsxs)("button",{onClick:dB,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(z,{className:"w-4 h-4"}),"重命名"]}),(0,b.jsxs)("button",{onClick:()=>dF("move"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(M,{className:"w-4 h-4"}),"移动"]}),(0,b.jsxs)("button",{onClick:()=>dF("copy"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(L,{className:"w-4 h-4"}),"复制"]}),(0,b.jsxs)("button",{onClick:dz,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-200 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-red-200 dark:hover:bg-red-950/40 dark:hover:border-red-900",children:[(0,b.jsx)(l,{className:"w-4 h-4"}),"删除"]}),(0,b.jsxs)("button",{onClick:()=>dP(aH,"public"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(K,{className:"w-4 h-4"}),"公共链接"]}),(0,b.jsxs)("button",{onClick:()=>dP(aH,"custom"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,b.jsx)(K,{className:"w-4 h-4"}),"自定义链接"]})]})]}):(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 dark:bg-gray-950",children:(0,b.jsx)(p,{className:"w-6 h-6 text-gray-300 dark:text-gray-600"})}),(0,b.jsxs)("p",{className:"text-gray-500 text-sm dark:text-gray-400",children:["选择一个文件以查看详情",(0,b.jsx)("br",{}),"或进行管理"]})]}),c?null:(0,b.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-100 dark:from-blue-950/35 dark:to-indigo-950/25 dark:border-blue-900",children:[(0,b.jsxs)("h3",{className:"text-xs font-bold text-blue-800 uppercase tracking-wider mb-4 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"当前视图统计"]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"文件数"}),(0,b.jsx)("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:d1.fileCount})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"文件夹数"}),(0,b.jsx)("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:d1.folderCount})]}),(0,b.jsx)("div",{className:"h-px bg-blue-200/50 my-2 dark:bg-blue-900/50"}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"总大小"}),(0,b.jsx)("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-200",children:ad(d1.totalSize)})]})]})]})]}),(0,b.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50 text-[10px] text-gray-400 text-center dark:border-gray-800 dark:bg-gray-950/30 dark:text-gray-400",children:[(0,b.jsx)("p",{children:ae.title}),(0,b.jsx)("p",{className:"mt-0.5",children:"R2对象存储多功能管理工具"})]})]});return(0,b.jsxs)("div",{className:"flex h-dvh md:h-screen bg-gray-50 text-gray-900 font-sans overflow-hidden dark:bg-gray-900 dark:text-gray-100",children:[(0,b.jsxs)("div",{className:`fixed inset-0 z-50 md:hidden ${bb?"":"pointer-events-none"}`,children:[(0,b.jsx)("button",{type:"button","aria-label":"关闭菜单",onClick:()=>bc(!1),className:`absolute inset-0 bg-black/40 transition-opacity ${bb?"opacity-100":"opacity-0"}`}),(0,b.jsx)("div",{className:`absolute inset-y-0 left-0 w-[18rem] max-w-[85vw] transition-transform duration-200 ${bb?"translate-x-0":"-translate-x-full"}`,children:(0,b.jsx)(ea,{onClose:()=>bc(!1)})})]}),(0,b.jsx)("div",{className:"hidden md:block w-[17rem] shrink-0",children:(0,b.jsx)(ea,{})}),(0,b.jsxs)("main",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-gray-900",children:[(0,b.jsxs)("div",{className:"border-b border-gray-200 bg-white shrink-0 dark:border-gray-800 dark:bg-gray-900",children:[(0,b.jsxs)("div",{className:"hidden md:flex h-16 border-b-0 items-center px-6 gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{onClick:()=>j&&dg(j,ap),disabled:!j,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"刷新","aria-label":"刷新",children:[(0,b.jsx)(n,{className:`w-4 h-4 ${ar?"animate-spin":""}`}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"刷新"})]}),(0,b.jsxs)("button",{onClick:dN,disabled:0===aJ.size,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"批量下载（所选文件）","aria-label":"下载",children:[(0,b.jsx)(J,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"下载"})]}),(0,b.jsxs)("button",{onClick:dH,disabled:0===aJ.size,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"批量移动（所选文件）","aria-label":"移动",children:[(0,b.jsx)(M,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"移动"})]}),(0,b.jsxs)("button",{onClick:dC,disabled:aJ.size>1||0===aJ.size&&!aH,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"重命名（仅支持单选）","aria-label":"重命名",children:[(0,b.jsx)(z,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"重命名"})]}),(0,b.jsxs)("button",{onClick:dz,disabled:0===aJ.size&&!aH,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-red-200 dark:hover:bg-red-950/40",title:"删除（所选项）","aria-label":"删除",children:[(0,b.jsx)(l,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-[10px] leading-none",children:"删除"})]}),(0,b.jsxs)("button",{onClick:dx,disabled:!j||!!aU.trim(),className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:aU.trim()?"搜索中无法新建文件夹":"新建文件夹","aria-label":"新建",children:[(0,b.jsx)(W,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"新建"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>bo(a=>"system"===a?bp?"light":"dark":"dark"===a?"light":"system"),className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors active:scale-95 dark:text-gray-300 dark:hover:bg-gray-800",title:"system"===bn?"主题：跟随系统":"dark"===bn?"主题：深色":"主题：浅色","aria-label":"主题",children:["dark"===bn?(0,b.jsx)(s,{className:"w-4 h-4"}):"light"===bn?(0,b.jsx)(r,{className:"w-4 h-4"}):(0,b.jsx)(t,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"主题"})]})]}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(p,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,b.jsx)("input",{type:"text",placeholder:"桶内全局搜索...",value:aU,onChange:a=>aV(a.target.value),className:"pl-9 pr-9 py-1.5 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 w-60 transition-all dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),a$?(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(n,{className:"w-4 h-4 text-gray-400 animate-spin dark:text-gray-500"})}):null]}),(0,b.jsx)("button",{onClick:()=>{j&&(aP.length>0?aO(!0):aT.current?.click())},disabled:!j,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-all shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:d0.active>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n,{className:"w-4 h-4 animate-spin"}),(0,b.jsxs)("span",{children:[d0.pct,"%"]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"上传"})]})})]})]}),(0,b.jsxs)("div",{className:"hidden md:flex items-center justify-between gap-3 px-6 py-2 border-t border-gray-100 bg-white dark:border-gray-800 dark:bg-gray-900",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm text-gray-600 dark:text-gray-300 min-w-0",children:[(0,b.jsxs)("button",{onClick:()=>{aq([]),aV("")},className:"hover:bg-gray-100 px-2 py-1 rounded-md transition-colors text-gray-500 flex items-center gap-1 dark:text-gray-300 dark:hover:bg-gray-800",children:[(0,b.jsx)(N,{className:"w-5 h-5 text-gray-500 dark:text-gray-300",strokeWidth:1.75}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"根目录"})]}),ap.length>0&&(0,b.jsx)(o,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"}),ap.map((a,d)=>(0,b.jsxs)(c.default.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>dv(d),className:"hover:text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-md transition-colors font-medium break-words dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:a}),d<ap.length-1&&(0,b.jsx)(o,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"})]},d))]}),(0,b.jsx)(ab,{bucketName:d4??"未选择",disabled:!j,onClick:()=>bU(!0)})]}),(0,b.jsxs)("div",{className:"md:hidden px-3 py-2 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>bc(!0),className:"p-2.5 -ml-1 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800","aria-label":"打开菜单",children:(0,b.jsx)(q,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,b.jsx)(_,{className:"w-10 h-10 shrink-0"}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"font-bold text-[18px] leading-[1.15] tracking-tight text-blue-600 truncate dark:text-blue-400",children:ae.title}),(0,b.jsx)("div",{className:"mt-0.25 text-[12px] leading-[1.1] text-gray-400 font-medium truncate dark:text-gray-400",children:ae.subtitle})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(p,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,b.jsx)("input",{type:"text",placeholder:"桶内搜索...",value:aU,onChange:a=>aV(a.target.value),className:"w-full pl-9 pr-9 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),a$?(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(n,{className:"w-4 h-4 text-gray-400 animate-spin dark:text-gray-500"})}):null]}),(0,b.jsxs)("button",{onClick:()=>{j&&(aP.length>0?aO(!0):aT.current?.click())},disabled:!j,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-all shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[(0,b.jsx)(m,{className:"w-4 h-4"}),(0,b.jsx)("span",{children:"上传"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto -mx-3 px-3 pb-0.5",children:[(0,b.jsxs)("button",{onClick:()=>j&&dg(j,ap),disabled:!j,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"刷新","aria-label":"刷新",children:[(0,b.jsx)(n,{className:`w-5 h-5 ${ar?"animate-spin":""}`}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"刷新"})]}),(0,b.jsxs)("button",{onClick:dN,disabled:0===aJ.size,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"批量下载（所选文件）","aria-label":"下载",children:[(0,b.jsx)(J,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"下载"})]}),(0,b.jsxs)("button",{onClick:dH,disabled:0===aJ.size,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"批量移动（所选文件）","aria-label":"移动",children:[(0,b.jsx)(M,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"移动"})]}),(0,b.jsxs)("button",{onClick:dC,disabled:aJ.size>1||0===aJ.size&&!aH,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名（仅支持单选）","aria-label":"重命名",children:[(0,b.jsx)(z,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"重命名"})]}),(0,b.jsxs)("button",{onClick:dz,disabled:0===aJ.size&&!aH,className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-red-200 dark:hover:bg-red-950/40",title:"删除（所选项）","aria-label":"删除",children:[(0,b.jsx)(l,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-[10px] leading-none",children:"删除"})]}),(0,b.jsxs)("button",{onClick:dx,disabled:!j||!!aU.trim(),className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:aU.trim()?"搜索中无法新建文件夹":"新建文件夹","aria-label":"新建",children:[(0,b.jsx)(W,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"新建"})]}),(0,b.jsxs)("button",{type:"button",onClick:()=>bo(a=>"system"===a?bp?"light":"dark":"dark"===a?"light":"system"),className:"w-16 h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"system"===bn?"主题：跟随系统":"dark"===bn?"主题：深色":"主题：浅色","aria-label":"主题",children:["dark"===bn?(0,b.jsx)(s,{className:"w-5 h-5"}):"light"===bn?(0,b.jsx)(r,{className:"w-5 h-5"}):(0,b.jsx)(t,{className:"w-5 h-5"}),(0,b.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"主题"})]})]}),(0,b.jsx)("div",{className:"pt-1",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm text-gray-600 dark:text-gray-300 min-w-0",children:[(0,b.jsxs)("button",{onClick:()=>{aq([]),aV("")},className:"hover:bg-gray-100 px-2 py-1 rounded-md transition-colors text-gray-500 flex items-center gap-1 dark:text-gray-300 dark:hover:bg-gray-800",children:[(0,b.jsx)(N,{className:"w-5 h-5 text-gray-500 dark:text-gray-300",strokeWidth:1.75}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"根目录"})]}),ap.length>0&&(0,b.jsx)(o,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"}),ap.map((a,d)=>(0,b.jsxs)(c.default.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>dv(d),className:"hover:text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-md transition-colors font-medium whitespace-nowrap dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:a}),d<ap.length-1&&(0,b.jsx)(o,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"})]},d))]}),(0,b.jsx)(ab,{bucketName:d4??"未选择",disabled:!j,onClick:()=>bU(!0),className:"shrink-0"})]})})]})]}),(0,b.jsx)("input",{type:"file",multiple:!0,ref:aT,className:"hidden",onChange:d$}),ar||a$?(0,b.jsx)("div",{className:"h-1 w-full bg-blue-100 dark:bg-blue-950/40",children:(0,b.jsx)("div",{className:"h-1 w-1/3 bg-blue-500 animate-pulse"})}):(0,b.jsx)("div",{className:"h-1 w-full bg-transparent"}),(0,b.jsx)("div",{className:`flex-1 overflow-y-auto p-3 md:py-4 md:px-6 bg-gray-50/30 dark:bg-gray-900 ${ar?"pointer-events-none":""}`,onClick:()=>{aI(null)},children:"unbound"===at?(0,b.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,b.jsxs)("div",{className:"w-full max-w-2xl bg-white border border-gray-200 rounded-2xl shadow-sm p-6 dark:bg-gray-900 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:"未绑定存储桶"}),(0,b.jsx)("div",{className:"mt-1 text-sm text-gray-500 leading-relaxed dark:text-gray-300",children:"当前账号还没有可用存储桶，请点击「新增存储桶」并填写你的 R2 账号参数后继续。"})]}),(0,b.jsx)("button",{onClick:d9,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium transition-colors whitespace-nowrap",children:"新增存储桶"})]}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950/30",children:[(0,b.jsx)("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"配置步骤"}),(0,b.jsxs)("ol",{className:"mt-3 space-y-2 text-sm text-gray-700 list-decimal pl-5 dark:text-gray-200",children:[(0,b.jsx)("li",{children:"点击「新增存储桶」按钮"}),(0,b.jsx)("li",{children:"填写桶名、Account ID、Access Key、Secret Key"}),(0,b.jsx)("li",{children:"可选填写公共链接和自定义域名"}),(0,b.jsx)("li",{children:"保存后即可开始管理文件"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950/30",children:[(0,b.jsx)("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"字段说明"}),(0,b.jsxs)("div",{className:"mt-3 text-sm text-gray-700 leading-relaxed space-y-2 dark:text-gray-200",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("span",{className:"font-medium",children:"桶名称"}),(0,b.jsx)("code",{className:"px-2 py-1 rounded bg-white border border-gray-200 text-xs dark:bg-gray-900 dark:border-gray-800",children:"my-bucket"})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("span",{className:"font-medium",children:"Account ID"}),(0,b.jsx)("code",{className:"px-2 py-1 rounded bg-white border border-gray-200 text-xs dark:bg-gray-900 dark:border-gray-800",children:"xxxxxxxx"})]}),(0,b.jsx)("div",{className:"text-[12px] text-gray-500 dark:text-gray-400",children:"Access Key 和 Secret Key 在 Cloudflare R2 API Tokens 中创建与查看。"})]})]})]}),(0,b.jsxs)("div",{className:"mt-4 rounded-xl border border-gray-200 bg-white p-4 dark:border-gray-800 dark:bg-gray-900",children:[(0,b.jsx)("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200",children:"提示"}),(0,b.jsxs)("ul",{className:"mt-2 text-sm text-gray-700 space-y-1.5 list-disc pl-5 dark:text-gray-200",children:[(0,b.jsx)("li",{children:"每个账号可配置多个桶，也可混用多个 Cloudflare 账号的桶。"}),(0,b.jsx)("li",{children:"所有桶配置会绑定到当前登录账号，后续登录可直接继续使用。"})]})]})]})}):ax&&!ar?(0,b.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,b.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl border border-red-200 bg-red-50 p-6 dark:border-red-900/50 dark:bg-red-950/20",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-red-700 dark:text-red-200",children:"文件列表读取失败"}),(0,b.jsx)("div",{className:"mt-2 text-sm leading-relaxed text-red-700/90 dark:text-red-200/90",children:ax}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("button",{onClick:()=>j&&dg(j,ap),className:"inline-flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:"重新读取"})})]})}):0!==d_.length||ar||a$?(0,b.jsx)(c.default.Fragment,{children:(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm dark:bg-gray-900 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"flex items-center px-4 py-3 sm:py-2.5 text-[11px] font-semibold text-gray-500 bg-gray-50 border-b border-gray-200 dark:bg-gray-950/30 dark:border-gray-800 dark:text-gray-400",children:[(0,b.jsx)("div",{className:"w-10 flex items-center justify-center",children:(0,b.jsx)("input",{type:"checkbox","aria-label":"Select all",checked:d_.length>0&&d_.every(a=>aJ.has(a.key)),onChange:a=>{let b=new Set(aJ);if(a.target.checked)for(let a of d_)b.add(a.key);else for(let a of d_)b.delete(a.key);aK(b)},onClick:a=>a.stopPropagation(),className:"w-5 h-5 sm:w-4 sm:h-4"})}),(0,b.jsx)("div",{className:"flex-1",children:"名称"}),(0,b.jsx)("div",{className:"w-28 text-right hidden md:block",children:"大小"}),(0,b.jsx)("div",{className:"w-28 text-right hidden md:block",children:"修改时间"}),(0,b.jsx)("div",{className:"w-40 text-right hidden md:block",children:"操作"}),(0,b.jsx)("div",{className:"w-12 text-right md:hidden",children:"操作"})]}),(0,b.jsx)("div",{children:d_.map(a=>{let c=aJ.has(a.key);return(0,b.jsxs)("div",{onClick:b=>{(b.stopPropagation(),a9)?"folder"===a.type?du(a.name):dQ(a):aI(a)},onDoubleClick:b=>{b.stopPropagation(),a9||("folder"===a.type?du(a.name):dQ(a))},className:`group flex items-center px-4 py-3 md:py-2.5 text-sm border-b border-gray-100 hover:bg-gray-50 cursor-pointer dark:border-gray-800 dark:hover:bg-gray-800 ${aH?.key===a.key?"bg-blue-50 dark:bg-blue-950/30":"bg-white dark:bg-gray-900"}`,children:[(0,b.jsx)("div",{className:"w-10 flex items-center justify-center",children:(0,b.jsx)("input",{type:"checkbox",checked:c,onChange:b=>{let c=new Set(aJ);b.target.checked?c.add(a.key):c.delete(a.key),aK(c)},onClick:a=>a.stopPropagation(),className:"w-5 h-5 sm:w-4 sm:h-4"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"shrink-0",children:d2(a.type,a.name,"sm")}),(0,b.jsxs)("div",{className:"min-w-0 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"truncate",title:a.name,children:a.name}),(0,b.jsx)("span",{className:"shrink-0 text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:ds(a)})]})]}),(0,b.jsx)("div",{className:"w-28 text-right text-xs text-gray-500 hidden md:block dark:text-gray-400",children:"folder"===a.type?"-":ad(a.size)}),(0,b.jsx)("div",{className:"w-28 text-right text-xs text-gray-500 hidden md:block dark:text-gray-400",children:a.lastModified?new Date(a.lastModified).toLocaleDateString():"-"}),(0,b.jsx)("div",{className:"w-40 hidden md:flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:"folder"===a.type?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),du(a.name)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"打开",children:(0,b.jsx)(N,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),dD(a)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名",children:(0,b.jsx)(z,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),dG(a,"move")},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"移动",children:(0,b.jsx)(M,{className:"w-4 h-4"})})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),dL(a)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"下载",children:(0,b.jsx)(J,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),dD(a)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名",children:(0,b.jsx)(z,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),dG(a,"move")},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"移动",children:(0,b.jsx)(M,{className:"w-4 h-4"})})]})}),(0,b.jsx)("div",{className:"w-12 flex justify-end md:hidden",children:(0,b.jsx)("button",{type:"button",onClick:b=>{b.stopPropagation(),aI(a),be(!0)},className:"px-2.5 py-1.5 rounded-lg border border-gray-200 bg-white text-xs font-medium text-gray-700 hover:bg-gray-50 active:scale-95 transition dark:border-gray-800 dark:bg-gray-900 dark:text-gray-100 dark:hover:bg-gray-800","aria-label":"操作",title:"操作",children:"操作"})})]},a.key)})})]})}):(0,b.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-400",children:[(0,b.jsx)("div",{className:"w-24 h-24 bg-gray-50 rounded-full flex items-center justify-center mb-4 dark:bg-gray-950",children:(0,b.jsx)(k,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),(0,b.jsx)("p",{className:"text-sm font-medium",children:aU.trim()?"未找到匹配内容":"文件夹为空"})]})})]}),(0,b.jsx)("div",{className:"hidden md:flex w-80 shrink-0",children:(0,b.jsx)(eb,{})}),(0,b.jsxs)("div",{className:`fixed inset-0 z-50 md:hidden ${bd?"":"pointer-events-none"}`,children:[(0,b.jsx)("button",{type:"button","aria-label":"关闭详情",onClick:()=>be(!1),className:`absolute inset-0 bg-black/40 transition-opacity ${bd?"opacity-100":"opacity-0"}`}),(0,b.jsx)("div",{className:`absolute inset-x-0 bottom-0 transition-transform duration-200 ${bd?"translate-y-0":"translate-y-full"}`,onClick:a=>a.stopPropagation(),children:(0,b.jsx)("div",{className:"h-[70dvh] bg-white rounded-t-2xl shadow-2xl border border-gray-200 overflow-hidden dark:bg-gray-900 dark:border-gray-800",children:(0,b.jsx)(eb,{compact:!0,onClose:()=>be(!1)})})})]}),null,(0,b.jsx)(d,{open:bT,title:"当前存储桶",description:"主页仅展示（不支持切换）；如需切换请在侧边栏/菜单中操作。",onClose:()=>bU(!1),footer:(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)("button",{onClick:()=>bU(!1),className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"知道了"})}),children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"桶名称"}),(0,b.jsx)("div",{className:"text-base font-semibold text-gray-900 break-all dark:text-gray-100",children:d4??"未选择"})]})}),(0,b.jsxs)(d,{open:bD,title:"新建文件夹",description:ap.length?`当前位置：/${ap.join("/")}/`:"当前位置：/（根目录）",onClose:()=>{bE(!1),bG("")},footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{bE(!1),bG("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:dy,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"创建"})]}),children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"文件夹名称"}),(0,b.jsx)("input",{value:bF,onChange:a=>bG(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：images"})]}),(0,b.jsxs)(d,{open:br,title:"重命名",description:aH?`当前：${aH.name}`:void 0,onClose:()=>bs(!1),footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>bs(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:dE,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"确认"})]}),children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新名称"}),(0,b.jsx)("input",{value:bt,onChange:a=>bu(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"输入新名称"})]}),(0,b.jsxs)(d,{open:bv,title:"move"===bx?"移动":"复制",description:bB.length>1?`已选择 ${bB.length} 个文件`:aH?`对象：${aH.key}`:void 0,onClose:()=>{bw(!1),bC([])},footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{bw(!1),bC([])},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:dI,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"确认"})]}),children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"目标路径"}),(0,b.jsx)("input",{value:bz,onChange:a=>bA(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：photos/ 或 a/b/c/"}),(0,b.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"以 `/` 结尾表示目标目录；不以 `/` 结尾表示目标 Key。"})]}),(0,b.jsx)(d,{open:b_,title:"账号中心",description:"当前账号与存储桶管理",panelClassName:"max-w-[96vw] sm:max-w-[600px]",showHeaderClose:!0,onClose:()=>{b0(!1),b8(null)},children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[(0,b.jsx)("div",{className:"h-11 w-11 shrink-0 rounded-full bg-blue-50 text-blue-600 dark:bg-blue-950/40 dark:text-blue-300 flex items-center justify-center",children:(0,b.jsx)(X,{className:"h-7 w-7"})}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsx)("div",{className:"text-sm leading-tight font-semibold text-gray-800 truncate dark:text-gray-100",children:a?.email||"未读取到邮箱"}),(0,b.jsxs)("div",{className:"mt-0 min-w-0",children:[(0,b.jsx)("button",{type:"button",onClick:()=>cM(a=>!a),className:"text-[11px] leading-none text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:cL?"隐藏用户ID":"显示用户ID"}),cL?(0,b.jsxs)("div",{className:"mt-0.5 text-xs leading-tight text-gray-500 break-all dark:text-gray-400",children:["用户ID：",a?.userId||"-"]}):null]})]})]}),(0,b.jsxs)("div",{className:"shrink-0 flex items-center justify-end gap-1.5 flex-wrap",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{b0(!1),bS(!0)},className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"退出登录"}),(0,b.jsx)("button",{type:"button",onClick:()=>b2(!0),className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"修改密码"}),(0,b.jsx)("button",{type:"button",onClick:()=>b4(!0),className:"px-2 py-1 rounded-md text-xs font-medium border border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"注销账号"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-900",children:[(0,b.jsxs)("div",{className:"pl-3 pr-5 py-2 border-b border-gray-200 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:["已绑定存储桶（",h.length,"）"]}),(0,b.jsxs)("button",{type:"button",onClick:d9,className:"shrink-0 inline-flex items-center gap-1.5 px-2 py-1.5 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:[(0,b.jsx)(Y,{className:"w-3.5 h-3.5"}),"添加存储桶"]})]}),h.length?(0,b.jsx)("div",{className:"max-h-[45vh] overflow-y-auto p-2 space-y-2",children:h.map(a=>{let c=j===a.id;return(0,b.jsx)("div",{className:`rounded-lg border px-3 py-2 ${c?"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950/30":"border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-900"}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-800 truncate dark:text-gray-100",children:a.Name||a.bucketName||a.id}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-gray-500 break-all dark:text-gray-400",children:["R2 桶名：",a.bucketName||"-"]}),(0,b.jsxs)("div",{className:"mt-0.5 text-xs text-gray-500 truncate dark:text-gray-400",title:a.accountId||"-",children:["Account ID：",a.accountId||"-"]})]}),(0,b.jsxs)("div",{className:"shrink-0 flex items-center gap-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>{c||(d8(a.id),b0(!1))},disabled:c,className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800 dark:disabled:hover:bg-transparent",children:c?"当前":"切换"}),(0,b.jsx)("button",{type:"button",onClick:()=>{let b;!(b=d7(a.id??j))?a7("请先选择要编辑的存储桶"):(b0(!1),b$(b.id),cU({}),cS({bucketLabel:b.Name??"",bucketName:b.bucketName??"",accountId:b.accountId??"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:b.publicBaseUrl??"",customBaseUrl:b.customBaseUrl??""}),bY(!0))},className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"编辑"}),(0,b.jsx)("button",{type:"button",onClick:()=>{let b;!(b=d7(a.id))?a7("未找到要删除的存储桶"):(b8(b.id),b6(!0))},className:"px-2 py-1 rounded-md text-xs font-medium border border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"删除"})]})]})},a.id)})}):(0,b.jsx)("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400",children:"当前账号还未绑定存储桶，请点击右上角「添加存储桶」。"})]})]})}),(0,b.jsx)(d,{open:b1,title:"修改密码",onClose:()=>{b2(!1),cG(""),cI("")},footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{b2(!1),cG(""),cI("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{c9()},disabled:ar,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"保存新密码"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新密码"}),(0,b.jsx)("input",{type:"password",value:cF,onChange:a=>cG(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"确认新密码"}),(0,b.jsx)("input",{type:"password",value:cH,onChange:a=>cI(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"再次输入新密码"})]})]})}),(0,b.jsx)(d,{open:b3,title:"注销账号",description:"该操作不可恢复，将永久删除当前账号及其桶配置。",onClose:()=>{b4(!1),cK("")},footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{b4(!1),cK("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{da()},disabled:ar,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"确认注销"})]}),children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"text-sm text-red-700 leading-relaxed dark:text-red-200",children:"注销后无法恢复，账号下已绑定的桶配置会一并清理。"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"请输入“注销”确认"}),(0,b.jsx)("input",{value:cJ,onChange:a=>cK(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-red-500/20 focus:border-red-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"注销"})]})]})}),(0,b.jsx)(d,{open:bX,title:bZ?"编辑存储桶":"新增存储桶",onClose:()=>{bY(!1),b$(null),cU({})},footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{bY(!1),b$(null),cU({})},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{dc()},disabled:ar,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:bZ?"保存修改":"保存"})]}),children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:d6?"带 * 的字段为必填；若缺失，点击保存后会在对应输入框提示。":"编辑模式下 Access Key / Secret 可留空表示不修改。"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"显示名称（可选）"}),(0,b.jsx)("input",{value:cR.bucketLabel,onChange:a=>cS(b=>({...b,bucketLabel:a.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：我的云盘"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["R2 桶名称 ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{value:cR.bucketName,onChange:a=>{cS(b=>({...b,bucketName:a.target.value})),cU(a=>({...a,bucketName:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${cT.bucketName?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:"例如：my-bucket"}),cT.bucketName?(0,b.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:cT.bucketName}):null]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Account ID ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{value:cR.accountId,onChange:a=>{cS(b=>({...b,accountId:a.target.value})),cU(a=>({...a,accountId:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${cT.accountId?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`}),cT.accountId?(0,b.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:cT.accountId}):null]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Access Key ID ",d6?(0,b.jsx)("span",{className:"text-red-500",children:"*"}):"（可选）"]}),(0,b.jsx)("input",{value:cR.accessKeyId,onChange:a=>{cS(b=>({...b,accessKeyId:a.target.value})),cU(a=>({...a,accessKeyId:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${cT.accessKeyId?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:bZ?"留空表示不修改":""}),cT.accessKeyId?(0,b.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:cT.accessKeyId}):null]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Secret Access Key ",d6?(0,b.jsx)("span",{className:"text-red-500",children:"*"}):"（可选）"]}),(0,b.jsx)("input",{type:"password",value:cR.secretAccessKey,onChange:a=>{cS(b=>({...b,secretAccessKey:a.target.value})),cU(a=>({...a,secretAccessKey:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${cT.secretAccessKey?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:bZ?"留空表示不修改":""}),cT.secretAccessKey?(0,b.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:cT.secretAccessKey}):null]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"公共开发 URL（可选）"}),(0,b.jsx)("input",{value:cR.publicBaseUrl,onChange:a=>cS(b=>({...b,publicBaseUrl:a.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"自定义域名（可选）"}),(0,b.jsx)("input",{value:cR.customBaseUrl,onChange:a=>cS(b=>({...b,customBaseUrl:a.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]})]})]})}),(0,b.jsx)(d,{open:b5,title:"确认删除存储桶？",onClose:()=>{b6(!1),b8(null)},footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>{b6(!1),b8(null)},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{b7&&dd(b7)},disabled:!b7,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"删除存储桶"})]}),children:(0,b.jsxs)("div",{className:"text-sm text-gray-700 leading-relaxed dark:text-gray-200",children:["将删除以下存储桶配置：",(0,b.jsxs)("span",{className:"font-semibold",children:[" ",d5?.Name||d5?.bucketName||b7||"-"]}),"。该操作不会删除 R2 中的真实文件，只会移除本账号下的桶绑定配置。"]})}),(0,b.jsx)(d,{open:bR,title:"确认退出登录？",onClose:()=>bS(!1),footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>bS(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:()=>{bS(!1),de()},className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"退出登录"})]}),children:(0,b.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:"退出后将清除本地登录状态，需要重新输入邮箱和密码才能继续使用。确定退出登录吗？"})}),(0,b.jsx)(d,{open:bH,title:"链接设置",description:j?`桶：${j}`:void 0,onClose:()=>bI(!1),footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>bI(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:dO,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"保存"})]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"公共开发 URL（可选）"}),(0,b.jsx)("input",{value:bJ,onChange:a=>bK(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"自定义域名（可选）"}),(0,b.jsx)("input",{value:bL,onChange:a=>bM(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"R2 存储桶名称（必填）"}),(0,b.jsx)("input",{value:bN,onChange:a=>bO(a.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),(0,b.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"修改后将重新校验该桶名，校验通过才会保存。"})]})]})}),(0,b.jsx)(d,{open:bP,title:"确认删除",description:aJ.size>0?`将删除 ${aJ.size} 项`:aH?`将删除：${aH.key}`:void 0,onClose:()=>bQ(!1),footer:(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)("button",{onClick:()=>bQ(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,b.jsx)("button",{onClick:dA,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"删除"})]}),children:(0,b.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:["确定删除文件？此操作不可恢复。",aJ.size>0?Array.from(aJ).some(a=>a.endsWith("/"))?"（选择文件夹时，文件夹内的所有文件都将会被删除）":null:aH?.type==="folder"?"（文件夹会递归删除前缀下的所有对象）":null]})}),aP.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{onClick:()=>aO(a=>!a),className:"fixed bottom-5 right-5 z-40 flex items-center gap-2 px-4 py-2 rounded-full bg-gray-900 text-white shadow-lg hover:bg-gray-800",children:[(0,b.jsx)(m,{className:"w-4 h-4"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:["上传 ",d0.active?`(${d0.active})`:""]}),(0,b.jsxs)("span",{className:"text-xs text-gray-200",children:[d0.pct,"%"]})]}),aN?(0,b.jsxs)("div",{className:"fixed bottom-20 right-5 z-40 w-[420px] max-w-[calc(100vw-2.5rem)] bg-white border border-gray-200 rounded-2xl shadow-2xl overflow-hidden dark:bg-gray-900 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100 flex items-center justify-between dark:border-gray-800",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"上传任务"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>aT.current?.click(),className:"px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:"添加文件"}),(0,b.jsx)("button",{onClick:()=>aQ(a=>a.filter(a=>"queued"===a.status||"uploading"===a.status||"paused"===a.status)),className:"px-3 py-1.5 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-xs font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"清理已完成"}),(0,b.jsx)("button",{onClick:()=>aO(!1),className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",title:"关闭",children:(0,b.jsx)(O,{className:"w-4 h-4"})})]})]}),(0,b.jsx)("div",{className:"max-h-[50vh] overflow-auto divide-y divide-gray-100 dark:divide-gray-800",children:aP.map(a=>{let c=a.file.size?Math.min(100,Math.round(Math.min(a.loaded,a.file.size)/a.file.size*100)):0;return(0,b.jsxs)("div",{className:"px-4 py-3",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate dark:text-gray-100",title:a.key,children:a.file.name}),(0,b.jsxs)("div",{className:"mt-0.5 text-[11px] text-gray-500 truncate dark:text-gray-400",title:`${a.bucket}/${a.key}`,children:[a.bucket,"/",a.key]})]}),(0,b.jsxs)("div",{className:"shrink-0 flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsxs)("div",{className:"text-xs font-semibold text-gray-800 dark:text-gray-100",children:[c,"%"]}),(0,b.jsx)("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"uploading"===a.status?dR(a.speedBps):"done"===a.status?"完成":"queued"===a.status?"排队中":"paused"===a.status?"已暂停":"canceled"===a.status?"已取消":"error"===a.status?"失败":a.status})]}),"uploading"===a.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>{var b;return b=a.id,void(aQ(a=>a.map(a=>a.id===b&&"uploading"===a.status?{...a,status:"paused",speedBps:0}:a)),aS(!0),cb.current.get(b)?.abort(),a7("已暂停（可继续续传）"))},className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"暂停",children:(0,b.jsx)(P,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>dY(a.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,b.jsx)(R,{className:"w-4 h-4"})})]}):"paused"===a.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>dW(a.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"继续",children:(0,b.jsx)(Q,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>dY(a.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,b.jsx)(R,{className:"w-4 h-4"})})]}):"queued"===a.status?(0,b.jsx)("button",{onClick:()=>dY(a.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,b.jsx)(R,{className:"w-4 h-4"})}):"error"===a.status?(0,b.jsx)("button",{onClick:()=>dW(a.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重试",children:(0,b.jsx)(Q,{className:"w-4 h-4"})}):null]})]}),(0,b.jsx)("div",{className:"mt-2 h-2 bg-gray-100 rounded-full overflow-hidden dark:bg-gray-800",children:(0,b.jsx)("div",{className:`h-2 ${"error"===a.status?"bg-red-500":"done"===a.status?"bg-green-500":"paused"===a.status||"canceled"===a.status?"bg-gray-400":"bg-blue-600"}`,style:{width:`${c}%`}})}),"error"===a.status?(0,b.jsx)("div",{className:"mt-2 text-[11px] text-red-600 dark:text-red-300",children:a.error??"上传失败"}):null]},a.id)})})]}):null]}):null,c$,aL?(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-6",onClick:()=>aM(null),children:(0,b.jsxs)("div",{className:"w-full max-w-4xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden dark:bg-gray-900 dark:border-gray-800",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"px-5 py-3 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-sm font-semibold text-gray-900 truncate dark:text-gray-100",title:aL.name,children:aL.name}),(0,b.jsx)("div",{className:"text-[11px] text-gray-500 truncate dark:text-gray-400",title:aL.key,children:aL.key})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"hidden sm:inline-flex text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:dr(aL.name).toUpperCase()||"FILE"}),(0,b.jsx)("button",{onClick:async()=>{try{let a=await dK(aL.bucket,aL.key,aL.name);dM(a,aL.name),a7("已拉起下载")}catch{a7("下载失败")}},className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800",title:"下载",children:(0,b.jsx)(J,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:()=>aM(null),className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",title:"关闭",children:(0,b.jsx)(O,{className:"w-4 h-4"})})]})]}),(0,b.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-950/30",children:"image"===aL.kind?(0,b.jsx)("div",{className:"flex items-center justify-center",children:(0,b.jsx)("img",{src:aL.url,alt:aL.name,className:"max-h-[70vh] max-w-full rounded-lg shadow"})}):"video"===aL.kind?(0,b.jsx)("div",{className:"w-full aspect-video rounded-lg shadow bg-black overflow-hidden",children:(0,b.jsx)("video",{src:aL.url,controls:!0,className:"w-full h-full object-contain"})}):"audio"===aL.kind?(0,b.jsx)("audio",{src:aL.url,controls:!0,className:"w-full"}):"pdf"===aL.kind?(0,b.jsx)("iframe",{src:aL.url,className:"w-full h-[70vh] rounded-lg shadow bg-white dark:bg-gray-900",title:"PDF Preview"}):"office"===aL.kind?(0,b.jsx)("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(aL.url)}`,className:"w-full h-[70vh] rounded-lg shadow bg-white dark:bg-gray-900",title:"Office Preview"}):"text"===aL.kind?(0,b.jsx)("pre",{className:"text-xs bg-white border border-gray-200 rounded-lg p-4 overflow-auto max-h-[70vh] whitespace-pre-wrap dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100",children:aL.text??"加载中..."}):(0,b.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-10 flex flex-col items-center justify-center text-center dark:bg-gray-900 dark:border-gray-800",children:[(0,b.jsx)("div",{className:"w-28 h-28 rounded-full bg-gray-100 flex items-center justify-center dark:bg-gray-800",children:(0,b.jsx)(B,{className:"w-10 h-10 text-blue-600"})}),(0,b.jsx)("div",{className:"mt-8 text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"无法预览此文件"}),(0,b.jsx)("div",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:"此文件类型暂不支持在线预览，请下载后查看。"}),(0,b.jsxs)("button",{onClick:async()=>{try{let a=await dK(aL.bucket,aL.key,aL.name);dM(a,aL.name),a7("已拉起下载")}catch{a7("下载失败")}},className:"mt-8 inline-flex items-center gap-3 px-8 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg",children:[(0,b.jsx)(J,{className:"w-5 h-5"}),"下载文件"]})]})})]})}):null]})}a.s(["default",()=>ao],60350)}];

//# sourceMappingURL=app_page_tsx_55b2e5ee._.js.map