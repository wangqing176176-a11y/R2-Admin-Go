(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31713,e=>{"use strict";var r=e.i(47167),t=e.i(43476),a=e.i(71645);function s({open:e,title:r,description:a,children:s,onClose:l,footer:d,panelClassName:n,contentClassName:i,showHeaderClose:o=!1,closeOnBackdropClick:c=!0}){return e?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-3 sm:p-4 overflow-y-auto",role:"dialog","aria-modal":"true",children:[c?(0,t.jsx)("button",{type:"button",className:"absolute inset-0 bg-black/40",onClick:l,"aria-label":"Close dialog"}):(0,t.jsx)("div",{className:"absolute inset-0 bg-black/40","aria-hidden":"true"}),(0,t.jsxs)("div",{className:["relative w-full max-w-lg max-h-[calc(100dvh-1.5rem)] sm:max-h-[calc(100dvh-2rem)] rounded-2xl border border-gray-200 bg-white shadow-2xl dark:border-gray-800 dark:bg-gray-900 flex flex-col overflow-hidden",n].filter(Boolean).join(" "),children:[(0,t.jsxs)("div",{className:"relative px-5 py-4 border-b border-gray-100 dark:border-gray-800",children:[o?(0,t.jsx)("button",{type:"button",onClick:l,"aria-label":"关闭弹窗",className:"absolute right-3 top-2.5 inline-flex h-10 w-10 items-center justify-center rounded-lg text-gray-500 hover:bg-gray-100 hover:text-gray-700 dark:text-gray-300 dark:hover:bg-gray-800 dark:hover:text-gray-100",children:(0,t.jsx)("span",{className:"text-xl leading-none",children:"×"})}):null,(0,t.jsxs)("div",{className:"min-w-0 pr-10",children:[(0,t.jsx)("div",{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:r}),a?(0,t.jsx)("div",{className:"mt-1 text-sm text-gray-500 dark:text-gray-300",children:a}):null]})]}),(0,t.jsx)("div",{className:["px-5 py-4 text-gray-900 dark:text-gray-100 overflow-y-auto overflow-x-hidden min-h-0",i].filter(Boolean).join(" "),children:s}),d?(0,t.jsx)("div",{className:"px-5 py-4 border-t border-gray-100 dark:border-gray-800",children:d}):null]})]}):null}let l=(e,r="操作失败，请重试。")=>{let t=String(e instanceof Error?e.message:e??"").trim();if(!t)return r;if(/[\u4e00-\u9fa5]/.test(t))return t;let a=t.toLowerCase();return a.includes("invalid login credentials")?"账号或密码错误，请重试。":a.includes("email not confirmed")?"邮箱尚未验证，请先前往邮箱完成验证。":a.includes("unauthorized")?"登录状态已失效，请重新登录。":a.includes("missing params")?"请求参数不完整，请刷新后重试。":a.includes("bucket required")?"缺少存储桶参数。":a.includes("bucket id required")?"缺少存储桶 ID。":a.includes("bucket not found")?"未找到存储桶，请刷新后重试。":a.includes("source not found")?"源文件不存在或已被删除。":a.includes("unknown bucket binding")||a.includes("bucket binding not configured")?"存储桶绑定未配置或不可用，请检查配置。":a.includes("token expired")?"操作令牌已过期，请重试。":a.includes("invalid token")?"操作令牌无效，请重试。":a.includes("missing environment variable")?"服务端缺少必要环境变量，请联系管理员。":a.includes("decryption failed")||a.includes("ciphertext authentication failure")||a.includes("bad padding")||a.includes("aes-gcm")?"密钥解密失败：请检查 CREDENTIALS_ENCRYPTION_KEY 是否与历史配置一致。":a.includes("failed to load buckets")?"读取存储桶列表失败，请稍后重试。":a.includes("failed to load bucket")?"读取存储桶信息失败，请稍后重试。":a.includes("failed to create bucket")?"新增存储桶失败，请检查配置后重试。":a.includes("failed to update bucket")?"更新存储桶失败，请稍后重试。":a.includes("failed to delete bucket")?"删除存储桶失败，请稍后重试。":a.includes("failed to check existing bucket")?"校验存储桶是否存在时失败，请稍后重试。":a.includes("failed to set default bucket")?"设置默认存储桶失败，请稍后重试。":a.includes("duplicate key value violates unique constraint")?"该账号下已存在同名存储桶（同 Account ID + 桶名），请修改后重试。":a.includes("failed to fetch")?"网络请求失败，请检查网络后重试。":r},d=["terms","privacy","disclaimer"],n={terms:"用户协议",privacy:"隐私政策",disclaimer:"免责声明"},i={terms:"# R2 Admin Go 用户协议\n\n更新日期：2026-02-15  \n生效日期：2026-02-15\n\n一、协议范围与接受\n\n（一）本协议适用于你访问和使用 R2 Admin Go（以下简称“本平台”）的全部行为。  \n（二）你注册、登录、访问或继续使用本平台，即表示你已阅读、理解并同意本协议及相关规则。  \n（三）若你不同意本协议任一条款，请立即停止使用本平台。\n\n二、平台服务说明\n\n（一）本平台部署于 Cloudflare Pages，不提供自建服务器托管。  \n（二）本平台主要功能为：帮助用户管理其自有 Cloudflare R2 存储桶中的对象文件。  \n（三）本平台当前涉及的第三方服务包括但不限于：  \n1. Cloudflare Pages：提供网站托管与网络分发；  \n2. Cloudflare R2：存储桶与对象存储服务；  \n3. Resend：邮箱验证码发送服务；  \n4. Supabase：账号体系（注册/登录）及平台业务数据存储。\n\n三、账号与安全\n\n（一）你应保证注册信息真实、准确、完整，并及时更新。  \n（二）你应妥善保管账号、密码、验证码及访问凭证，因你保管不当导致的风险和损失由你自行承担。  \n（三）你不得将账号出借、出租、出售或以其他方式提供给第三方使用。  \n（四）你发现账号存在异常登录或安全风险时，应立即联系平台运营者处理。\n\n四、用户数据与授权\n\n（一）你确认对所管理的 R2 桶及对象数据拥有合法权利，并已获得必要授权。  \n（二）你理解并同意：为实现功能，本平台可能处理你填写的桶绑定信息及 R2 访问凭证信息。  \n（三）你应自行确保所配置的 Access Key/Secret Key 权限范围最小化，避免使用高风险或超范围权限。  \n（四）你应自行对重要数据进行备份，本平台不对你未备份导致的数据损失承担责任。\n\n五、用户行为规范\n\n你不得利用本平台从事以下行为：\n\n（一）违反法律法规、监管要求或公序良俗的行为；  \n（二）侵害他人知识产权、隐私权、数据权益等合法权利的行为；  \n（三）上传、传播恶意代码或实施攻击、探测、干扰第三方系统的行为；  \n（四）以任何方式破坏本平台或第三方服务稳定运行的行为。\n\n六、第三方服务与可用性\n\n（一）本平台依赖第三方基础设施和服务提供商。  \n（二）因第三方服务故障、网络波动、地区性限制、政策变化、配额限制等导致的中断或异常，本平台不作绝对可用性承诺。  \n（三）第三方服务条款、隐私政策和计费规则由相应服务商另行约定，你应自行阅读并遵守。\n\n七、知识产权\n\n（一）本平台软件、界面、文档及相关内容的知识产权归平台运营者或权利人所有。  \n（二）未经书面许可，你不得对本平台进行反向工程、二次分发、商业化复制或用于非法用途。\n\n八、责任限制\n\n（一）在法律允许范围内，本平台按“现状”提供，不对适销性、特定用途适用性、不中断性、无错误性作明示或默示保证。  \n（二）因以下情形导致的损失，本平台不承担赔偿责任：  \n1. 你自身操作错误、配置错误或凭证泄露；  \n2. 你数据删除、覆盖、误操作或未备份；  \n3. 不可抗力、网络故障或第三方服务异常；  \n4. 非本平台可合理控制的其他原因。\n\n九、协议变更\n\n（一）平台运营者有权根据业务变化、法律法规要求更新本协议。  \n（二）更新后的协议发布后生效；你继续使用即视为接受更新内容。  \n（三）若你不同意更新内容，应停止使用本平台。\n\n十、终止与注销\n\n（一）你可按平台提供的方式停止使用或申请注销账号。  \n（二）若你违反本协议或存在安全、合规风险，平台运营者有权限制或终止对你的服务。  \n（三）服务终止后，平台仍可在法律要求范围内保留必要记录。\n\n最终解释权归本平台所有。\n",privacy:"# R2 Admin Go 隐私政策\n\n更新日期：2026-02-15  \n生效日期：2026-02-15\n\n一、适用范围\n\n本隐私政策适用于你在访问、注册、登录和使用 R2 Admin Go 过程中产生的个人信息与相关数据处理活动。\n\n二、我们处理的信息类型\n\n为提供服务，我们可能处理以下信息：\n\n（一）账号信息  \n1. 邮箱地址；  \n2. 账号认证相关信息（由 Supabase 处理登录与注册流程）。\n\n（二）业务配置数据  \n1. 你绑定的 Cloudflare R2 桶信息；  \n2. 你填写的 R2 账号访问信息（如 Account ID、Access Key、Secret Key）及相关配置。\n\n（三）使用与日志信息  \n1. 基础访问日志、错误日志、操作时间等用于排查问题和保障安全的信息。\n\n（四）设备与网络信息  \n1. 可能由托管平台和第三方服务自动采集的 IP 地址、浏览器类型、请求标识等技术信息。\n\n三、信息使用目的\n\n我们处理上述信息主要用于：\n\n（一）提供账号注册、登录、验证码校验、密码找回等功能；  \n（二）实现 R2 桶绑定、文件读取、上传、下载、管理等核心功能；  \n（三）保障服务安全、排查故障、优化性能与用户体验；  \n（四）履行法律法规要求或配合监管、司法机关的合法请求。\n\n四、第三方服务与数据流转\n\n本平台依赖以下第三方服务：\n\n（一）Cloudflare Pages：用于站点部署、访问分发与基础网络能力。  \n（二）Cloudflare R2：用于处理你授权访问的对象存储数据。  \n（三）Resend：用于发送邮箱验证码。  \n（四）Supabase：用于账号体系（注册、登录）及相关业务数据存储。\n\n你理解并同意：在实现上述功能时，相关数据可能在上述第三方服务间进行必要传输与处理。\n\n五、信息保存与安全措施\n\n（一）我们将仅在实现本政策所述目的所必需期间内保留信息，法律法规另有要求的除外。  \n（二）我们会采取合理的管理和技术措施降低信息泄露、篡改、丢失风险。  \n（三）互联网环境并非绝对安全，任何传输或存储方案均无法保证 100% 安全，请你妥善保管账号与密钥。\n\n六、用户权利\n\n在法律法规允许范围内，你可请求：\n\n（一）访问、更正你的相关信息；  \n（二）删除不再必要的信息；  \n（三）注销账号并停止使用服务；  \n（四）就隐私处理问题提出咨询与投诉。\n\n七、未成年人保护\n\n若你为未成年人，应在监护人同意和指导下使用本平台。监护人可联系我们行使相关信息保护权利。\n\n八、政策更新\n\n（一）我们可能根据业务变化或法律法规要求更新本隐私政策。  \n（二）更新后的政策发布后生效。你继续使用本平台即视为接受更新后的政策。\n\n最终解释权归本平台所有。\n",disclaimer:"# R2 Admin Go 免责声明\n\n更新日期：2026-02-15  \n生效日期：2026-02-15\n\n一、一般声明\n\n（一）本平台按“现状”“可用”原则提供，不对服务的连续性、及时性、准确性、完整性、适用性作任何明示或默示保证。  \n（二）你应自行评估使用本平台的风险，并对你的操作结果负责。\n\n二、非托管与责任边界\n\n（一）本平台部署在 Cloudflare Pages，不提供自建服务器托管服务。  \n（二）本平台主要作为你管理自有 Cloudflare R2 数据的工具，不直接拥有或控制你的业务数据来源和用途。  \n（三）你应确保对所管理的数据及操作行为具备合法权限并符合适用法律法规。\n\n三、第三方服务免责声明\n\n本平台依赖 Cloudflare Pages、Cloudflare R2、Resend、Supabase 等第三方服务。因以下情况导致的问题，本平台不承担责任：\n\n（一）第三方平台故障、升级、维护、限流、计费策略变化；  \n（二）网络中断、DNS 异常、区域性访问受限；  \n（三）第三方服务条款变更、账号封禁或权限限制。\n\n四、用户操作风险\n\n对于以下由用户行为引起的后果，本平台不承担责任：\n\n（一）错误配置 R2 凭证、桶名或权限策略；  \n（二）误删、误覆盖、误移动文件；  \n（三）Access Key/Secret Key 或账号凭证泄露；  \n（四）未进行数据备份导致的数据丢失或业务中断。\n\n五、安全与可用性\n\n（一）我们会尽合理努力提升安全性与稳定性，但不承诺服务绝对无漏洞、无中断、无延迟。  \n（二）对于不可抗力、黑客攻击、系统故障、通信线路问题等超出合理控制范围的事件造成的损失，本平台不承担责任。\n\n六、间接损失排除\n\n在法律允许范围内，本平台对任何间接损失、附带损失、惩罚性损失、利润损失、商誉损失或数据损失不承担责任。\n\n七、条款冲突与更新\n\n（一）本免责声明与《用户协议》《隐私政策》共同构成平台规则的一部分。  \n（二）如相关条款因法律法规调整需要更新，以最新发布版本为准。  \n（三）你继续使用本平台即视为已阅读并接受更新后的内容。\n\n最终解释权归本平台所有。\n"};var o=e.i(27025),c=e.i(75254);let x=(0,c.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),g=(0,c.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var u=e.i(16715);let m=(0,c.default)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),b=(0,c.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),y=(0,c.default)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]),h=(0,c.default)("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),p=(0,c.default)("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),f=(0,c.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),k=(0,c.default)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),v=(0,c.default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),j=(0,c.default)("file-code",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 12.5 8 15l2 2.5",key:"1tg20x"}],["path",{d:"m14 12.5 2 2.5-2 2.5",key:"yinavb"}]]),N=(0,c.default)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),w=(0,c.default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),S=(0,c.default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),C=(0,c.default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var $=e.i(40160),M=e.i(58524);let I=(0,c.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),A=(0,c.default)("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);var E=e.i(75505);let R=(0,c.default)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),_=(0,c.default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),z=(0,c.default)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]),P=(0,c.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),B=(0,c.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),T=(0,c.default)("badge-info",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["line",{x1:"12",x2:"12",y1:"16",y2:"12",key:"1y1yb1"}],["line",{x1:"12",x2:"12.01",y1:"8",y2:"8",key:"110wyk"}]]),O=(0,c.default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),U=(0,c.default)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),L=(0,c.default)("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),K=(0,c.default)("circle-user-round",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),D=(0,c.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);(0,c.default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);let Z="r2_admin_theme_v1",H=e=>{let[r,t]=(0,a.useState)(()=>window.matchMedia(e).matches);return(0,a.useEffect)(()=>{let r=window.matchMedia(e),a=()=>t(r.matches);return a(),r.addEventListener("change",a),()=>r.removeEventListener("change",a)},[e]),r},F=({className:e})=>{let[r,s]=(0,a.useState)(!1);return r?(0,t.jsx)("div",{"aria-hidden":"true",className:e}):(0,t.jsx)("img",{src:"/brand.png",alt:"","aria-hidden":"true",className:["block object-contain",e].filter(Boolean).join(" "),onError:()=>s(!0),draggable:!1})},J=({className:e})=>(0,t.jsx)("span",{className:["inline-block bg-current",e].filter(Boolean).join(" "),"aria-hidden":"true",style:{WebkitMaskImage:"url(/Wi-Fi.svg)",maskImage:"url(/Wi-Fi.svg)",WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain"}}),q=({className:e})=>(0,t.jsx)("span",{"aria-hidden":"true",className:["r2-loader-orbit",e].filter(Boolean).join(" ")}),V=({className:e})=>(0,t.jsx)("span",{"aria-hidden":"true",className:["r2-loader-dots",e].filter(Boolean).join(" "),children:Array.from({length:3}).map((e,r)=>(0,t.jsx)("span",{style:{animationDelay:`${.16*r}s`}},r))}),W=()=>(0,t.jsx)("div",{className:"space-y-3",children:Array.from({length:8}).map((e,r)=>(0,t.jsx)("div",{className:"rounded-2xl border border-gray-200 bg-white px-4 py-3 dark:border-gray-800 dark:bg-gray-900",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"h-4 w-4 rounded-md r2-skeleton-shimmer"}),(0,t.jsx)("div",{className:"h-3.5 rounded-md r2-skeleton-shimmer",style:{width:`${36+r%5*10}%`}}),(0,t.jsx)("div",{className:"ml-auto hidden h-3.5 w-16 rounded-md r2-skeleton-shimmer md:block"}),(0,t.jsx)("div",{className:"hidden h-3.5 w-20 rounded-md r2-skeleton-shimmer md:block"})]})},`skeleton-${r}`))}),G=({bucketName:e,disabled:r,onClick:a,className:s})=>(0,t.jsxs)("button",{type:"button",disabled:r,onClick:a,title:e,"aria-label":"查看当前存储桶",className:["inline-flex items-center gap-2 px-1 py-1 rounded-md text-left","transition-colors hover:text-gray-700 dark:hover:text-gray-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500/30 focus-visible:ring-offset-2 focus-visible:ring-offset-white dark:focus-visible:ring-offset-gray-900","disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:text-inherit",s].filter(Boolean).join(" "),children:[(0,t.jsx)(D,{className:"w-5 h-5 text-gray-500 shrink-0 dark:text-gray-300",strokeWidth:1.75}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-[10px] leading-tight text-gray-500 dark:text-gray-400",children:"当前桶"}),(0,t.jsx)("div",{className:"mt-0.5 text-[11px] leading-tight font-normal text-blue-600 truncate max-w-[10.5rem] md:max-w-[16rem] dark:text-blue-300",children:e})]})]}),X=(e,r=0)=>{let t="number"==typeof e?e:Number(e);return Number.isFinite(t)?t:r},Y=e=>{if(void 0===e||!Number.isFinite(e)||e<0)return"-";if(0===e)return"0 B";let r=["B","KB","MB","GB","TB"],t=Math.min(r.length-1,Math.max(0,Math.floor(Math.log(e)/Math.log(1024))));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+r[t]},Q=[{value:1,label:"1天"},{value:7,label:"7天"},{value:30,label:"30天"},{value:0,label:"永久有效"}],ee={title:"R2 Admin Go",subtitle:"R2对象存储多功能管理工具",advantages:["支持图片、视频、音频、文档、代码等文件预览","不限速下载与上传大文件、重命名、移动复制、删除等文件操作","一个账号可以保存并管理多个 Cloudflare 账号的 R2 存储桶配置"],announcementTitle:"公告",announcementText:`近期更新 V2.0版本
  
- 增加了文件列表自定义排序功能。
- 修复了已知问题。
`,footer:"By Wang Qing"},er=[{label:"我的博客",href:"https://qinghub.top",icon:"globe"},{label:"使用教程",href:"https://github.com/wangqing176176-a11y/qing-r2-cloudy",icon:"book"},{label:"关于页面",href:"https://qinghub.top/about/",icon:"about"},{label:"电子邮箱",href:"mailto:wangqing176176@gmail.com",icon:"mail"}],et="r2_multipart_resume_v1",ea="r2_supabase_session_v1",es="r2_supabase_session_tmp_v1",el=(e,r,t)=>`${e}|${r}|${t.size}|${t.lastModified}`,ed=e=>e.length>0?`${e.join("/")}/`:"",en=()=>{try{let e=localStorage.getItem(et);if(!e)return{};let r=JSON.parse(e);return r&&"object"==typeof r?r:{}}catch{return{}}},ei=e=>{localStorage.setItem(et,JSON.stringify(e))},eo=(e,r)=>{let t=en();t[e]=r,ei(t)},ec=e=>{let r=en();e in r&&(delete r[e],ei(r))};function ex(){let[e,c]=(0,a.useState)(null),et=(0,a.useRef)(null),ei=(0,a.useRef)(!1),[ex,eg]=(0,a.useState)([]),[eu,em]=(0,a.useState)(null),[eb,ey]=(0,a.useState)([]),[eh,ep]=(0,a.useState)([]),[ef,ek]=(0,a.useState)(!1),[ev,ej]=(0,a.useState)(!1),[eN,ew]=(0,a.useState)("checking"),[eS,eC]=(0,a.useState)(null),[e$,eM]=(0,a.useState)(null),[eI,eA]=(0,a.useState)(!0),[eE,eR]=(0,a.useState)(!1),[e_,ez]=(0,a.useState)(null),[eP,eB]=(0,a.useState)(null),[eT,eO]=(0,a.useState)(!1),[eU,eL]=(0,a.useState)(null),[eK,eD]=(0,a.useState)(new Set),[eZ,eH]=(0,a.useState)(null),[eF,eJ]=(0,a.useState)(!1),[eq,eV]=(0,a.useState)([]),[eW,eG]=(0,a.useState)(!1),eX=(0,a.useRef)(null),[eY,eQ]=(0,a.useState)(""),[e0,e1]=(0,a.useState)([]),[e5,e2]=(0,a.useState)(null),[e4,e7]=(0,a.useState)(!1),[e3,e8]=(0,a.useState)("name"),[e6,e9]=(0,a.useState)("asc"),[re,rr]=(0,a.useState)({}),[rt,ra]=(0,a.useState)({}),[rs,rl]=(0,a.useState)({}),[rd,rn]=(0,a.useState)({}),[ri,ro]=(0,a.useState)(null),rc=(0,a.useMemo)(()=>(e=>{if(!e)return null;if("string"==typeof e){let r=e.trim();return{kind:/失败|错误|异常/.test(r)?"error":/成功|已/.test(r)?"success":"info",message:r}}return e})(ri),[ri]),rx=H("(max-width: 767px)"),rg=H("(prefers-color-scheme: dark)"),[ru,rm]=(0,a.useState)(!1),[rb,ry]=(0,a.useState)(!1),[rh,rp]=(0,a.useState)(!1),rf=(0,a.useRef)(null),[rk,rv]=(0,a.useState)(!1),rj=(0,a.useRef)(null),[rN,rw]=(0,a.useState)(!1),[rS,rC]=(0,a.useState)("system"),[r$,rM]=(0,a.useState)(!1),[rI,rA]=(0,a.useState)(!1),[rE,rR]=(0,a.useState)(""),[r_,rz]=(0,a.useState)(!1),[rP,rB]=(0,a.useState)("move"),[rT,rO]=(0,a.useState)(""),[rU,rL]=(0,a.useState)([]),[rK,rD]=(0,a.useState)([]),[rZ,rH]=(0,a.useState)([]),[rF,rJ]=(0,a.useState)(!1),[rq,rV]=(0,a.useState)(null),[rW,rG]=(0,a.useState)(!1),[rX,rY]=(0,a.useState)(""),[rQ,r0]=(0,a.useState)(!1),[r1,r5]=(0,a.useState)(""),[r2,r4]=(0,a.useState)(""),[r7,r3]=(0,a.useState)(""),[r8,r6]=(0,a.useState)(!1),[r9,te]=(0,a.useState)(!1),[tr,tt]=(0,a.useState)(null),[ta,ts]=(0,a.useState)(7),[tl,td]=(0,a.useState)(!1),[tn,ti]=(0,a.useState)(""),[to,tc]=(0,a.useState)(""),[tx,tg]=(0,a.useState)(!1),[tu,tm]=(0,a.useState)(null),[tb,ty]=(0,a.useState)([]),[th,tp]=(0,a.useState)(!1),[tf,tk]=(0,a.useState)("all"),[tv,tj]=(0,a.useState)(""),[tN,tw]=(0,a.useState)(!1),[tS,tC]=(0,a.useState)(!1),[t$,tM]=(0,a.useState)(!1),[tI,tA]=(0,a.useState)(!1),[tE,tR]=(0,a.useState)(!1),[t_,tz]=(0,a.useState)(!1),[tP,tB]=(0,a.useState)(null),[tT,tO]=(0,a.useState)(!1),[tU,tL]=(0,a.useState)(!1),[tK,tD]=(0,a.useState)(!1),[tZ,tH]=(0,a.useState)(!1),[tF,tJ]=(0,a.useState)(null),tq=(0,a.useRef)([]),tV=(0,a.useRef)(!1),tW=(0,a.useRef)(new Map),tG=(0,a.useRef)(!1),tX=(0,a.useRef)({});(0,a.useEffect)(()=>{tq.current=eq},[eq]),(0,a.useEffect)(()=>{tG.current=eW},[eW]),(0,a.useEffect)(()=>{tX.current=re},[re]);let[tY,tQ]=(0,a.useState)(""),[t0,t1]=(0,a.useState)(""),[t5,t2]=(0,a.useState)(""),[t4,t7]=(0,a.useState)(""),[t3,t8]=(0,a.useState)(""),[t6,t9]=(0,a.useState)(!1),[ae,ar]=(0,a.useState)(!1),[at,aa]=(0,a.useState)("terms"),[as,al]=(0,a.useState)(""),[ad,an]=(0,a.useState)(""),[ai,ao]=(0,a.useState)(0),[ac,ax]=(0,a.useState)(()=>Date.now()),[ag,au]=(0,a.useState)(!1),[am,ab]=(0,a.useState)(""),[ay,ah]=(0,a.useState)(""),[ap,af]=(0,a.useState)(""),[ak,av]=(0,a.useState)(0),[aj,aN]=(0,a.useState)(!1),[aw,aS]=(0,a.useState)(""),[aC,a$]=(0,a.useState)(""),[aM,aI]=(0,a.useState)(null),[aA,aE]=(0,a.useState)(""),[aR,a_]=(0,a.useState)(""),[az,aP]=(0,a.useState)(""),[aB,aT]=(0,a.useState)(!1),[aO,aU]=(0,a.useState)(!1),[aL,aK]=(0,a.useState)(!1),[aD,aZ]=(0,a.useState)(!1),[aH,aF]=(0,a.useState)(!1),[aJ,aq]=(0,a.useState)(!1),[aV,aW]=(0,a.useState)(!1),[aG,aX]=(0,a.useState)(!1),[aY,aQ]=(0,a.useState)({bucketLabel:"",bucketName:"",accountId:"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:"",customBaseUrl:""}),[a0,a1]=(0,a.useState)({}),a5=String(r.default.env.NEXT_PUBLIC_SUPABASE_URL??"").replace(/\/$/,""),a2=String(r.default.env.NEXT_PUBLIC_SUPABASE_ANON_KEY??r.default.env.NEXT_PUBLIC_SUPABASE_PUBLISHABLE_KEY??"").trim(),a4=Math.max(0,Math.ceil((ai-ac)/1e3)),a7=Math.max(0,Math.ceil((ak-ac)/1e3));(0,a.useEffect)(()=>{if(!eI)return;let e=Date.now();if(!(ai>e||ak>e))return;ax(e);let r=window.setInterval(()=>ax(Date.now()),1e3);return()=>window.clearInterval(r)},[eI,ai,ak]);let a3=(e,r)=>{if(!e){localStorage.removeItem(ea),sessionStorage.removeItem(es);return}if(r){localStorage.setItem(ea,JSON.stringify(e)),sessionStorage.removeItem(es);return}sessionStorage.removeItem(es),localStorage.removeItem(ea)},a8=(e,r)=>{let t=String(e??"").trim(),a=String(r??"").trim();return!!t&&(a3(null,!1),ei.current=!1,eR(!1),c(null),eA(!0),ew("error"),eC("请设置新密码后再登录"),aI({accessToken:t,refreshToken:a}),aS(""),a$(""),aN(!0),tR(!1),!0)},a6=async(e,r,t)=>{if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let a=async e=>{let r=await fetch(`${a5}/auth/v1/verify`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify(e)}),t=await sr(r),a=String(t.access_token??"").trim(),s=String(t.refresh_token??"").trim();if(!r.ok||!a)throw Error(String(t.msg??t.error_description??t.error??"重置链接无效或已过期"));return{accessToken:a,refreshToken:s}};if(e)return await a({type:"recovery",token_hash:e});if(r&&t)return await a({type:"recovery",token:r,email:t});throw Error("重置链接无效或已过期")},a9=async e=>{if(!a5||!a2||!e.refreshToken)return null;let r=await fetch(`${a5}/auth/v1/token?grant_type=refresh_token`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e.refreshToken})}),t=await sr(r);if(!r.ok||!t.access_token||!t.refresh_token)return null;let a={accessToken:String(t.access_token),refreshToken:String(t.refresh_token),userId:String((t.user?.id??e.userId)||""),email:String((t.user?.email??e.email)||"")};return a3(a,!!localStorage.getItem(ea)),c(a),a};(0,a.useEffect)(()=>{et.current=e},[e]),(0,a.useEffect)(()=>{let e=(e=>{if(!e)return null;try{let r=JSON.parse(e),t=String(r?.accessToken??"").trim(),a=String(r?.refreshToken??"").trim();if(!t||!a)return null;return{accessToken:t,refreshToken:a,userId:r.userId?String(r.userId):void 0,email:r.email?String(r.email):void 0}}catch{return null}})(localStorage.getItem(ea));sessionStorage.getItem(es)&&sessionStorage.removeItem(es),e?(ei.current=!0,eR(!0),c(e),e.email&&tQ(e.email),aU(!!e),eA(!1),ew("checking"),eC(null)):(ei.current=!1,eR(!1),eA(!0),ew("error"),eC("请登录后继续使用"));let r=localStorage.getItem("r2_link_config_v1");if(r)try{ra(JSON.parse(r))}catch{localStorage.removeItem("r2_link_config_v1")}let t=localStorage.getItem("r2_s3_bucket_check_v1");if(t)try{rl(JSON.parse(t))}catch{localStorage.removeItem("r2_s3_bucket_check_v1")}let a=localStorage.getItem("r2_transfer_mode_override_v1");if(a)try{rn(JSON.parse(a))}catch{localStorage.removeItem("r2_transfer_mode_override_v1")}},[]),(0,a.useEffect)(()=>{let e=!1,r=()=>{let e=new URL(window.location.href);["type","access_token","refresh_token","token_hash","token","email","expires_in","expires_at","error","error_code","error_description","code"].forEach(r=>e.searchParams.delete(r));let r=`${e.pathname}${e.searchParams.toString()?`?${e.searchParams.toString()}`:""}`;window.history.replaceState({},document.title,r)};return(async()=>{let t=window.location.hash.replace(/^#/,"");if(t){let r=new URLSearchParams(t),a=String(r.get("type")??""),s=String(r.get("access_token")??"").trim(),l=String(r.get("refresh_token")??"").trim();if("recovery"===a&&s){!e&&a8(s,l)&&ro("检测到密码重置请求，请设置新密码");let r=`${window.location.pathname}${window.location.search}`;window.history.replaceState({},document.title,r);return}}let a=new URLSearchParams(window.location.search);if("recovery"!==String(a.get("type")??"").trim())return;let s=String(a.get("access_token")??"").trim(),d=String(a.get("refresh_token")??"").trim();if(s){!e&&a8(s,d)&&ro("检测到密码重置请求，请设置新密码"),r();return}let n=String(a.get("token_hash")??"").trim(),i=String(a.get("token")??"").trim(),o=String(a.get("email")??"").trim();try{let r=await a6(n,i,o);!e&&a8(r.accessToken,r.refreshToken)&&ro("检测到密码重置请求，请设置新密码")}catch(r){e||ro(l(r,"重置链接无效或已过期，请重新发起忘记密码")||"重置链接无效或已过期，请重新发起忘记密码")}finally{r()}})(),()=>{e=!0}},[a2,a5]),(0,a.useEffect)(()=>{if(!rc)return;let e=setTimeout(()=>ro(null),"error"===rc.kind?4500:3200);return()=>clearTimeout(e)},[rc]);let se=rc?(0,t.jsx)("div",{className:"fixed top-5 left-1/2 -translate-x-1/2 z-50 max-w-[92vw]",children:(0,t.jsxs)("div",{className:`inline-flex items-center gap-2 px-4 py-2 rounded-full border shadow-lg text-sm font-medium ${"success"===rc.kind?"bg-green-50 border-green-200 text-green-700 dark:bg-green-950/40 dark:border-green-900 dark:text-green-200":"error"===rc.kind?"bg-red-50 border-red-200 text-red-700 dark:bg-red-950/40 dark:border-red-900 dark:text-red-200":"bg-gray-900 text-white border-gray-900 dark:bg-gray-900 dark:border-gray-800"}`,role:"status","aria-live":"polite",children:[(0,t.jsx)("span",{className:"shrink-0 flex items-center justify-center",children:"success"===rc.kind?(0,t.jsx)(w,{className:"w-5 h-5"}):"error"===rc.kind?(0,t.jsx)(P,{className:"w-5 h-5"}):(0,t.jsx)(T,{className:"w-5 h-5"})}),(0,t.jsx)("span",{className:"leading-none",children:rc.message})]})}):null;(0,a.useEffect)(()=>{eI&&rp(!rx)},[eI,rx]),(0,a.useEffect)(()=>{if(!rk)return;let e=e=>{let r=e.target;!r||rf.current&&rf.current.contains(r)||rv(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[rk]),(0,a.useEffect)(()=>{if(!rN)return;let e=e=>{let r=e.target;!r||rj.current&&rj.current.contains(r)||rw(!1)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e,{passive:!0}),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[rN]),(0,a.useEffect)(()=>{rw(!1)},[eu]),(0,a.useEffect)(()=>{ru||(rv(!1),rw(!1))},[ru]),(0,a.useEffect)(()=>{try{let e=localStorage.getItem(Z);("light"===e||"dark"===e||"system"===e)&&rC(e)}catch{}},[]),(0,a.useEffect)(()=>{let e="dark"===rS||"system"===rS&&rg;rM(e),document.documentElement.classList.toggle("dark",e);try{let r=document.querySelector('meta[name="theme-color"]');r&&r.setAttribute("content",e?"#111827":"#f9fafb")}catch{}try{localStorage.setItem(Z,rS)}catch{}},[rg,rS]),(0,a.useEffect)(()=>{rx||(rm(!1),ry(!1))},[rx]),(0,a.useEffect)(()=>{if(!e){ei.current&&(ei.current=!1,eR(!1)),eA(!0),eg([]),em(null),ey([]),rr({}),eM(null),ep([]),ez(null),eB(null),tO(!1),tL(!1),tD(!1),aT(!1),au(!1),af(""),al(""),t1(""),t7(""),t8(""),r6(!1),te(!1),tt(null),tm(null),ty([]),tw(!1),tj(""),ew("error"),eC("请登录后继续使用");return}sC()},[e]);let sr=async e=>{try{return await e.clone().json()}catch{let r=await e.clone().text().catch(()=>"");return r?{error:r}:{}}},st=e=>{aa(e),ar(!0),al("")},sa=async(e,r={},t=!0)=>{let a={...r.headers};a["content-type"]||"string"!=typeof r.body||(a["content-type"]="application/json");let s=et.current;s?.accessToken&&(a.Authorization=`Bearer ${s.accessToken}`);let l=await fetch(e,{...r,headers:a});if(401!==l.status||!t||!s?.refreshToken)return l;let d=await a9(s);return d?.accessToken?await sa(e,r,!1):l},ss=(e,r)=>l(String(e?.msg??e?.error_description??e?.error??r),r),sl=(e,r)=>{let t=String(e?.access_token??"").trim(),a=String(e?.refresh_token??"").trim();if(!t||!a)return null;let s=String(e?.user?.email??r??"").trim();return{accessToken:t,refreshToken:a,userId:String(e?.user?.id??""),email:s||void 0}},sd=async(e,r)=>{if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let t=await fetch(`${a5}/auth/v1/otp`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify({email:e,create_user:r})}),a=await sr(t);if(!t.ok)throw Error(ss(a,r?"发送注册验证码失败，请重试。":"发送登录验证码失败，请重试。"))},sn=async(e,r)=>{if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let t=await fetch(`${a5}/auth/v1/verify`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify({type:"email",email:e,token:r})}),a=await sr(t),s=sl(a,e);if(!t.ok||!s)throw Error(ss(a,"验证码无效或已过期，请重试。"));return s},si=async e=>{if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let r=await fetch(`${a5}/auth/v1/recover`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify({email:e})}),t=await sr(r);if(!r.ok)throw Error(ss(t,"发送重置验证码失败，请重试。"))},so=async(e,r)=>{let t,a;if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let s=await fetch(`${a5}/auth/v1/verify`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify({type:"recovery",email:e,token:r})}),l=await sr(s),d=(t=String(l?.access_token??"").trim(),a=String(l?.refresh_token??"").trim(),t?{accessToken:t,refreshToken:a}:null);if(!s.ok||!d)throw Error(ss(l,"验证码无效或已过期，请重试。"));return d},sc=async(e,r)=>{if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let t=await fetch(`${a5}/auth/v1/token?grant_type=password`,{method:"POST",headers:{apikey:a2,"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})}),a=await sr(t),s=sl(a,e);if(!t.ok||!s)throw Error(ss(a,"登录失败，请重试。"));return s},sx=async(e,r)=>{if(!a5||!a2)throw Error("Supabase 前端环境变量未配置");let t=await fetch(`${a5}/auth/v1/user`,{method:"PUT",headers:{apikey:a2,Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({password:r})}),a=await sr(t);if(!t.ok)throw Error(l(String(a.msg??a.error_description??a.error??"重置密码失败"),"重置密码失败，请重试。"))},sg=async e=>{e.preventDefault(),an("");let r=tY.trim(),t=t0.trim();if(!r||!t)return void an("请输入邮箱和密码");try{ek(!0);let e=await sc(r,t);c(e),a3(e,aO),eA(!1),ew("checking"),eC(null),an(""),ro("登录成功")}catch(e){an(l(e,"登录失败，请重试。")||"登录失败，请重试。")}finally{ek(!1)}},su=async e=>{e?.preventDefault(),al("");let r=t5.trim(),t=t4.trim(),a=t3.trim();if(!r||!t||!a)return void al("请填写邮箱、密码和验证码");if(t.length<6)return void al("设置登录密码至少六个字符");if(!t6)return void al("请先阅读并同意「用户协议」和「隐私政策」");try{ek(!0);let e=await sn(r,a);await sx(e.accessToken,t),c(e),a3(e,aO),eA(!1),ew("checking"),eC(null),tQ(r),t1(""),t7(""),t8(""),al(""),ro("注册并登录成功")}catch(e){al(l(e,"注册失败，请重试。")||"注册失败，请重试。")}finally{ek(!1)}},sm=async()=>{let e=t5.trim(),r=t4.trim();if(!e)return void al("请输入注册邮箱");if(!r)return void al("请先输入注册密码");if(r.length<6)return void al("设置登录密码至少六个字符");if(!t6)return void al("请先阅读并同意「用户协议」和「隐私政策」");if(a4>0)return void al(`请 ${a4} 秒后再发送`);try{ek(!0),await sd(e,!0),ao(Date.now()+6e4),al("注册验证码已发送，请查收邮箱")}catch(e){al(l(e,"发送注册验证码失败，请重试。")||"发送注册验证码失败，请重试。")}finally{ek(!1)}},sb=async()=>{af("");let e=am.trim();if(!e)return void af("请输入注册邮箱");if(a7>0)return void af(`请 ${a7} 秒后再发送`);try{ek(!0),await si(e),av(Date.now()+6e4),af("重置验证码已发送，请查收邮箱")}catch(e){af(l(e,"发送重置验证码失败，请重试。")||"发送重置验证码失败")}finally{ek(!1)}},sy=async()=>{af("");let e=am.trim(),r=ay.trim();if(!e||!r)return void af("请输入邮箱和验证码");try{ek(!0);let t=await so(e,r);aI(t),au(!1),tQ(e),ah(""),af(""),aS(""),a$(""),aN(!0),ro("验证码校验成功，请设置新密码")}catch(e){af(l(e,"验证码无效或已过期，请重试。")||"验证码无效或已过期，请重试。")}finally{ek(!1)}},sh=async()=>{let e=aw.trim(),r=aC.trim();if(!aM?.accessToken)return void ro("重置会话已失效，请重新发起忘记密码");if(!e||!r)return void ro("请填写完整的新密码");if(e.length<6)return void ro("新密码至少 6 位");if(e!==r)return void ro("两次输入的新密码不一致");try{ek(!0),await sx(aM.accessToken,e),aN(!1),aS(""),a$(""),aI(null),ah(""),ab(""),ro("密码重置成功，请使用新密码登录")}catch(e){ro(l(e,"重置密码失败，请重试。")||"重置密码失败")}finally{ek(!1)}},sp=async()=>{let e=aA.trim(),r=aR.trim();if(!e||!r)return void ro("请填写完整的新密码信息");if(e.length<6)return void ro("新密码至少 6 位");if(e!==r)return void ro("两次输入的新密码不一致");try{ek(!0);let r=await sa("/api/account",{method:"PATCH",body:JSON.stringify({password:e})}),t=await sr(r);if(!r.ok)throw Error(String(t.error??"修改密码失败"));tL(!1),aE(""),a_(""),aF(!1),aq(!1),sN(),ro("密码修改成功，已退出登录，请使用新密码重新登录")}catch(e){ro(l(e,"修改密码失败，请重试。")||"修改密码失败")}finally{ek(!1)}},sf=async()=>{if("注销"!==az.trim())return void ro("请输入“注销”确认此操作");try{ek(!0);let e=await sa("/api/account",{method:"DELETE"}),r=await sr(e);if(!e.ok)throw Error(String(r.error??"注销账号失败"));tD(!1),aP(""),sN(),ro("账号已注销")}catch(e){ro(l(e,"注销账号失败，请重试。")||"注销账号失败")}finally{ek(!1)}},sk=()=>aQ({bucketLabel:"",bucketName:"",accountId:"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:"",customBaseUrl:""}),sv=async()=>{let e=!!tP,r={bucketLabel:aY.bucketLabel.trim(),bucketName:aY.bucketName.trim(),accountId:aY.accountId.trim(),accessKeyId:aY.accessKeyId.trim(),secretAccessKey:aY.secretAccessKey.trim(),publicBaseUrl:aY.publicBaseUrl.trim(),customBaseUrl:aY.customBaseUrl.trim(),isDefault:!e&&0===ex.length},t={};if(r.bucketName||(t.bucketName="此项必填"),r.accountId||(t.accountId="此项必填"),e||r.accessKeyId||(t.accessKeyId="此项必填"),e||r.secretAccessKey||(t.secretAccessKey="此项必填"),Object.keys(t).length>0)return void a1(t);a1({});try{ek(!0);let t=e?await sa("/api/buckets",{method:"PATCH",body:JSON.stringify({id:tP,bucketLabel:r.bucketLabel,bucketName:r.bucketName,accountId:r.accountId,accessKeyId:r.accessKeyId||void 0,secretAccessKey:r.secretAccessKey||void 0,publicBaseUrl:r.publicBaseUrl,customBaseUrl:r.customBaseUrl})}):await sa("/api/buckets",{method:"POST",body:JSON.stringify(r)}),a=await sr(t);if(!t.ok)throw Error(String(a.error??(e?"更新失败":"创建失败")));let s=a.bucket;tz(!1),tB(null),a1({}),aW(!1),aX(!1),sk(),await sC();let l=e?"存储桶已更新":"存储桶已添加";if(s?.id||eu){let e=s?.id??eu;if(!e)return;sw(e),ep([]),eQ(""),eL(null),eD(new Set),em(e);try{let t=await sa(`/api/bucket-check?bucketId=${encodeURIComponent(e)}&bucketName=${encodeURIComponent(r.bucketName)}`),a=await sr(t),s=!!a.ok,d=String(a.hint??"").trim();sI(e,{bucketName:r.bucketName,ok:s,hint:d||void 0,checkedAt:Date.now()}),!s&&d&&(l=`存储桶已保存，但连通性校验失败：${d}`)}catch{}}ro(l)}catch(r){ro(l(r,e?"更新存储桶失败，请重试。":"添加存储桶失败，请重试。")||(e?"更新存储桶失败":"添加存储桶失败"))}finally{ek(!1)}},sj=async e=>{if(e)try{ek(!0);let r=await sa(`/api/buckets?id=${encodeURIComponent(e)}`,{method:"DELETE"}),t=await sr(r);if(!r.ok)throw Error(String(t.error??"删除失败"));tH(!1),tJ(null),sw(e),await sC(),ro("存储桶已删除")}catch(e){ro(l(e,"删除存储桶失败，请重试。")||"删除存储桶失败")}finally{ek(!1)}},sN=()=>{a3(null,!1),c(null),eg([]),em(null),eM(null),rr({}),ez(null),eB(null),eL(null),eD(new Set),eH(null),eV([]),eJ(!1),eG(!1),rA(!1),rz(!1),r0(!1),tO(!1),tL(!1),tD(!1),aT(!1),tC(!1),tJ(null),tH(!1),aE(""),a_(""),aF(!1),aq(!1),aP(""),au(!1),ab(""),ah(""),af(""),av(0),aN(!1),aS(""),a$(""),aI(null),al(""),t8(""),t7(""),ao(0),t1(""),eA(!0),ew("error"),eC("已退出登录，请重新登录"),tQ(""),aU(!1),ek(!1),ro("退出登录成功")},sw=e=>{rr(r=>{if(!e)return{};let t=`${e}::`,a=!1,s={};for(let[e,l]of Object.entries(r)){if(e.startsWith(t)){a=!0;continue}s[e]=l}return a?s:r})},sS=async(e,r,t)=>{if(!e)return;let a=!!t?.force,s=`${e}::${ed(r)}`;if(!a){let e=tX.current[s];if(e?.items){ek(!1),ej(!1),ey(e.items),eM(null),ew("connected"),eC(null);return}}ek(!0),ej(!0),eM(null);let d=ed(r);try{let r=await sa(`/api/files?bucket=${encodeURIComponent(e)}&prefix=${encodeURIComponent(d)}`),t=await sr(r);if(!r.ok){ey([]);let e=l(t.error,"读取文件列表失败");eM(e),ew("error"),eC(null),eB(null);return}let a=Array.isArray(t.items)?t.items??[]:[];ey(a),rr(e=>({...e,[s]:{items:a,updatedAt:Date.now()}})),eM(null),ew("connected"),eC(null)}catch(e){ey([]),eM("读取文件列表失败，请检查桶配置或网络"),ew("error"),eC(null),eB(null),console.error(e)}finally{ej(!1),ek(!1)}},sC=async()=>{if(!et.current){eA(!0),ei.current&&(ei.current=!1,eR(!1));return}ew("checking"),eC(null);try{let e=await sa("/api/buckets"),r=await e.json().catch(()=>({}));if(401===e.status){a3(null,!1),c(null),eA(!0),ew("error"),eC(ei.current?"请登录后继续使用":"登录已失效，请重新登录");return}if(e.ok&&r.buckets){let e=r.buckets??[];if(eA(!1),eg(e),ra(r=>{let t={...r};for(let r of e)t[r.id]={publicBaseUrl:r.publicBaseUrl??t[r.id]?.publicBaseUrl,customBaseUrl:r.customBaseUrl??t[r.id]?.customBaseUrl,s3BucketName:r.bucketName??t[r.id]?.s3BucketName};return localStorage.setItem("r2_link_config_v1",JSON.stringify(t)),t}),0===e.length)em(null),ey([]),rr({}),eM(null),ez(null),eB(null),ep([]),ew("unbound"),eC("未配置存储桶：请先新增一个存储桶");else if(ew("connected"),!eu||!e.some(e=>e.id===eu)){let r=e.find(e=>e.isDefault)?.id??e[0].id;em(r)}}else if(ew("error"),r.error){let e=l(String(r.error),"连接失败，请稍后重试。");eC(e),ro(`连接失败: ${e}`)}}catch(e){ew("error"),eC("网络或运行时异常"),console.error(e)}finally{ei.current&&(ei.current=!1,eR(!1))}},s$=async(e,r)=>{let t=r.trim();if(!t){e1([]),e2(null);return}e7(!0);try{let r=await sa(`/api/search?bucket=${encodeURIComponent(e)}&q=${encodeURIComponent(t)}&limit=200`),a=await r.json();r.ok?(e1(a.items||[]),e2(a.cursor??null)):(e1([]),e2(null))}finally{e7(!1)}},sM=async e=>{eO(!0),eB(null);try{let r=await sa(`/api/usage?bucket=${encodeURIComponent(e)}&maxPages=10`),t=await sr(r);if(r.ok){let r={bucket:String(t.bucket??e),prefix:String(t.prefix??""),objects:Math.max(0,Math.floor(X(t.objects,0))),bytes:Math.max(0,X(t.bytes,0)),pagesScanned:Math.max(0,Math.floor(X(t.pagesScanned,0))),truncated:!!t.truncated};ez(r),eB(null)}else ez(null),eB(String(t.error??"桶占用估算失败"))}catch{ez(null),eB("桶占用估算失败，请检查桶配置或网络")}finally{eO(!1)}};(0,a.useEffect)(()=>{eu&&(sS(eu,eh).catch(()=>{}),eL(null),eD(new Set))},[eu,eh,e]),(0,a.useEffect)(()=>{if(!eu){e1([]),e2(null);return}let e=eY.trim();if(!e){e1([]),e2(null);return}let r=setTimeout(()=>{s$(eu,e).catch(()=>{})},250);return()=>clearTimeout(r)},[eY,eu,e]),(0,a.useEffect)(()=>{eu&&sM(eu)},[eu,e]);let sI=(e,r)=>{rl(t=>{let a={...t,[e]:r};return localStorage.setItem("r2_s3_bucket_check_v1",JSON.stringify(a)),a})},sA=e=>rd[e]??"auto",sE=e=>e?rt[e]??{}:{},sR=e=>{if(!e)return null;let r=(sE(e).s3BucketName??"").trim();if(!r)return null;let t=rs[e];return t&&t.bucketName===r?t:null},s_=e=>{let r=(sE(e).s3BucketName??"").trim();if(!r)return"";let t=sR(e);return t&&!1===t.ok?"":r},sz=e=>{if(!e)return;let r=e.trim();if(!r)return;let t=/^https?:\/\//i.test(r)?r:`https://${r}`;return t.endsWith("/")?t:`${t}/`},sP=e=>{let r=e.split("?")[0].split("/"),t=r[r.length-1]||"",a=t.lastIndexOf(".");return a<=0||a===t.length-1?"":t.slice(a+1).toLowerCase()},sB=e=>{if("folder"===e.type)return"DIR";let r=sP(e.name);return r?r.toUpperCase():"FILE"},sT=async e=>{try{await navigator.clipboard.writeText(e)}catch{let r=document.createElement("textarea");r.value=e,r.style.position="fixed",r.style.left="-9999px",document.body.appendChild(r),r.focus(),r.select(),document.execCommand("copy"),document.body.removeChild(r)}ro("已复制到剪贴板")},sO=e=>e.shareUrl?e.shareUrl:`${window.location.origin}/s/${encodeURIComponent(e.shareCode)}`,sU=e=>`https://api.qrserver.com/v1/create-qr-code/?size=300x300&margin=8&data=${encodeURIComponent(e)}`,sL=()=>{if(!eu)return;let e=(()=>{if(eU)return eU;let e=Array.from(eK);return 1!==e.length?null:lp.find(r=>r.key===e[0])??null})();e?(tt(e),ts(7),td(!1),ti(""),tc(""),tm(null),r6(!0)):ro("请先选择一个文件或文件夹再分享")},sK=async()=>{if(e)try{tp(!0);let e=await sa("/api/shares"),r=await sr(e);if(!e.ok)throw Error(String(r.error??"读取分享列表失败"));let t=Array.isArray(r.shares)?r.shares??[]:[];ty(t)}catch(e){ro(l(e,"读取分享列表失败，请稍后重试。"))}finally{tp(!1)}},sD=()=>{rx&&rm(!1),te(!0),sK()},sZ=async()=>{if(!eu||!tr)return;let e=tn.trim();if(tl){if(!e)return void ro("请输入提取码");if(!/^[A-Za-z0-9]{4,16}$/.test(e))return void ro("提取码仅支持 4-16 位字母或数字")}try{tg(!0);let r=await sa("/api/shares",{method:"POST",body:JSON.stringify({bucketId:eu,itemType:tr.type,itemKey:tr.key,itemName:tr.name,expireDays:ta,passcode:tl?e:"",note:to.trim()})}),t=await sr(r);if(!r.ok||!t.share)throw Error(String(t.error??"创建分享失败"));let a=t.share;tm(a),ty(e=>[a,...e.filter(e=>e.id!==a.id)]),ro("分享已创建")}catch(e){ro(l(e,"创建分享失败，请稍后重试。"))}finally{tg(!1)}},sH=async e=>{await sT(sO(e))},sF=e=>{tj(sO(e)),tw(!0)},sJ=async e=>{try{let r=await sa(`/api/shares/${encodeURIComponent(e.id)}`,{method:"PATCH",body:JSON.stringify({action:"stop"})}),t=await sr(r);if(!r.ok)throw Error(String(t.error??"停止分享失败"));ty(r=>r.map(r=>r.id===e.id?{...r,isActive:!1,status:"stopped",updatedAt:new Date().toISOString()}:r)),ro("已停止分享")}catch(e){ro(l(e,"停止分享失败，请稍后重试。"))}},sq=e=>{ep([...eh,e]),eQ("")},sV=e=>{ep(eh.slice(0,e+1)),eQ("")},sW=async()=>{if(!eu)return;let e=eY.trim();e?await s$(eu,e):await sS(eu,eh,{force:!0})},sG=()=>{eu&&(rY(""),rG(!0))},sX=async()=>{if(!eu)return;let e=rX.trim();if(!e)return void rG(!1);if(e.includes("/"))return void ro("文件夹名不支持 /");let r=eh.length>0?eh.join("/")+"/":"";try{if(ek(!0),!(await sa("/api/operate",{method:"POST",body:JSON.stringify({bucket:eu,targetKey:`${r}${e}/`,operation:"mkdir"})})).ok)throw Error("mkdir failed");rG(!1),eQ(""),sw(eu),await sS(eu,eh,{force:!0}),ro("新建文件夹成功")}catch{ro("新建文件夹失败，请重试")}finally{ek(!1)}},sY=()=>{!eu||(0!==eK.size||eU)&&tC(!0)},sQ=async()=>{if(eu)try{ek(!0);let e=Array.from(eK);if(e.length>0){if(!(await sa("/api/operate",{method:"POST",body:JSON.stringify({bucket:eu,sourceKeys:e,operation:"deleteMany"})})).ok)throw Error("delete failed")}else if(!eU)return void tC(!1);else if("folder"===eU.type){if(!(await sa("/api/operate",{method:"POST",body:JSON.stringify({bucket:eu,sourceKey:eU.key,operation:"delete"})})).ok)throw Error("delete failed")}else if(!(await sa(`/api/files?bucket=${eu}&key=${encodeURIComponent(eU.key)}`,{method:"DELETE"})).ok)throw Error("delete failed");tC(!1),sw(eu),await sW(),eL(null),eD(new Set),ro("删除成功")}catch{ro("删除失败，请刷新后重试")}finally{ek(!1)}},s0=()=>{eu&&eU&&(rR(eU.name),rA(!0))},s1=()=>{if(eu){if(1===eK.size)return void(()=>{if(!eu)return;let e=Array.from(eK);if(1!==e.length)return ro("请选择 1 个文件/文件夹进行重命名");let r=lp.find(r=>r.key===e[0]);r?s5(r):ro("未找到选中文件")})();if(eU)return void s0();ro("请选择 1 个文件/文件夹进行重命名")}},s5=e=>{eu&&(eL(e),rR(e.name),rA(!0))},s2=async()=>{if(!eu||!eU)return;let e=rE.trim();if(!e||e===eU.name)return void rA(!1);let r=eU.key,t="";if("folder"===eU.type){let e=(r.endsWith("/")?r.slice(0,-1):r).split("/").filter(Boolean);t=e.length>1?`${e.slice(0,-1).join("/")}/`:""}else{let e=r.split("/").filter(Boolean);t=e.length>1?`${e.slice(0,-1).join("/")}/`:""}let a=t+e+("folder"===eU.type?"/":"");try{ek(!0);let e=await sa("/api/operate",{method:"POST",body:JSON.stringify({bucket:eu,sourceKey:eU.key,targetKey:a,operation:"move"})}),r=await sr(e);if(!e.ok)throw Error(l(r.error,"重命名失败，请刷新后重试"));rA(!1),sw(eu),await sW(),eL(null),eD(new Set),ro("重命名成功")}catch(e){ro(l(e,"重命名失败，请刷新后重试"))}finally{ek(!1)}},s4=e=>{if(!eu||!eU)return;rB(e);let r=[...eh];rD(r),rV(null),rO(r.length?`${r.join("/")}/`:"/"),rL([eU.key]),rz(!0)},s7=(e,r)=>{if(!eu)return;eL(e),rB(r);let t=[...eh];rD(t),rV(null),rO(t.length?`${t.join("/")}/`:"/"),rL([e.key]),rz(!0)},s3=()=>{if(!eu)return;let e=Array.from(eK).filter(e=>"string"==typeof e&&e.length>0);if(!e.length)return void ro("请选择要移动的文件或文件夹");rB("move");let r=[...eh];rD(r),rV(null),rO(r.length?`${r.join("/")}/`:"/"),rL(e),rz(!0)},s8=()=>{rz(!1),rL([]),rD([]),rH([]),rV(null)},s6=e=>{rD(e),rO(e.length?`${e.join("/")}/`:"/")};(0,a.useEffect)(()=>{if(!r_||!eu)return;let e=!0,r=rK.length?`${rK.join("/")}/`:"";return(async()=>{rJ(!0),rV(null);try{let t=await sa(`/api/files?bucket=${encodeURIComponent(eu)}&prefix=${encodeURIComponent(r)}`),a=await sr(t);if(!t.ok)throw Error(l(a.error,"读取目录失败"));let s=(Array.isArray(a.items)?a.items??[]:[]).filter(e=>"folder"===e.type).sort((e,r)=>e.name.localeCompare(r.name,"zh-CN"));e&&rH(s)}catch(r){if(!e)return;rH([]),rV(l(r,"读取目录失败"))}finally{e&&rJ(!1)}})(),()=>{e=!1}},[r_,rK,eu,e]);let s9=async()=>{if(!eu)return;let e=rT.trim();if(!e)return void s8();let r=e;for(;r.startsWith("/");)r=r.slice(1);let t=e.endsWith("/")||"/"===e,a=rU.length?rU:eU?[eU.key]:[];if(a.length)try{let e,s;ek(!0);let d="move"===rP?"move":"copy",n=a.length>1||!eU||a[0]!==eU.key?await sa("/api/operate",{method:"POST",body:JSON.stringify({bucket:eu,sourceKeys:a,targetPrefix:r,operation:"move"===d?"moveMany":"copyMany"})}):await sa("/api/operate",{method:"POST",body:JSON.stringify({bucket:eu,sourceKey:eU.key,targetKey:(e="folder"===eU.type?"/":"",s=r,t||""===r?s=r+eU.name+e:"folder"!==eU.type||s.endsWith("/")||(s+="/"),s),operation:d})}),i=await sr(n);if(!n.ok)throw Error(l(i.error,"move"===rP?"移动失败":"复制失败"));s8(),sw(eu),await sW(),eL(null),eD(new Set),ro("move"===rP?"已移动":"已复制")}catch(e){ro(l(e,"move"===rP?"移动失败":"复制失败"))}finally{ek(!1)}},le=async(e,r,t)=>{let a=new URLSearchParams;a.set("bucket",e),a.set("key",r),t&&a.set("filename",t),"proxy"===sA(e)&&a.set("forceProxy","1");let s=s_(e);s&&a.set("bucketName",s);let l=await sa(`/api/download?${a.toString()}`),d=await l.json();if(!l.ok||!d.url)throw Error(d.error||"download url failed");return d.url},lr=async(e,r,t)=>{let a=s_(e),s=sA(e),l=a?`&bucketName=${encodeURIComponent(a)}`:"",d=await sa(`/api/download?bucket=${encodeURIComponent(e)}&key=${encodeURIComponent(r)}&download=1&filename=${encodeURIComponent(t)}${l}${"proxy"===s?"&forceProxy=1":""}`),n=await d.json();if(!d.ok||!n.url)throw Error(n.error||"download url failed");return n.url},lt=async e=>{if(eu){if("folder"===e.type)return void ro("文件夹打包下载下一步做（当前先支持文件下载）");try{let r=await lr(eu,e.key,e.name);la(r,e.name),ro("已拉起下载")}catch{ro("下载失败")}}},la=(e,r)=>{let t=document.createElement("a");t.href=e,t.download=r,t.rel="noreferrer",document.body.appendChild(t),t.click(),document.body.removeChild(t)},ls=async()=>{if(!eu)return;let e=Array.from(eK).filter(e=>!e.endsWith("/"));if(!e.length)return void ro("暂不支持文件夹整体批量下载");for(let r of(ro(`开始下载 ${e.length} 个文件`),e))try{let e=r.split("/").pop()||"download",t=await lr(eu,r,e);la(t,e),await new Promise(e=>setTimeout(e,150))}catch{}ro("已拉起批量下载")},ll=async()=>{if(!eu)return;let e=sz(r1||void 0),r=sz(r2||void 0),t=r7.trim()||void 0;if(!t)return void ro("桶名不能为空");try{var a;let s=await sa(`/api/bucket-check?bucketId=${encodeURIComponent(eu)}&bucketName=${encodeURIComponent(t)}`),l=await sr(s),d=!!l.ok,n=String(l.hint??"").trim();if(sI(eu,{bucketName:t,ok:d,hint:n||void 0,checkedAt:Date.now()}),!d)return void ro(`桶名校验失败：${n||"请检查桶名"}`);let i=await sa("/api/buckets",{method:"PATCH",body:JSON.stringify({id:eu,bucketName:t,publicBaseUrl:e,customBaseUrl:r})}),o=await sr(i);if(!i.ok)throw Error(String(o.error??"保存失败"));a={...rt,[eu]:{publicBaseUrl:e,customBaseUrl:r,s3BucketName:t}},ra(a),localStorage.setItem("r2_link_config_v1",JSON.stringify(a)),r0(!1),ro("已保存链接设置（桶名校验通过）")}catch(r){let e=l(r,"保存失败，请重试。");sI(eu,{bucketName:t,ok:!1,hint:e,checkedAt:Date.now()}),ro(e||"保存失败")}},ld=async(e,r)=>{var t,a;if(!eu)return;let s=sE(eu),l=(t="public"===r?s.publicBaseUrl:s.customBaseUrl,a=e.key,t?t+a.split("/").map(encodeURIComponent).join("/"):null);l?await sT(l):ro("public"===r?"未配置公共开发 URL":"未配置自定义域名")},ln=async e=>{if(!eu||"folder"===e.type)return;let r=e.name.toLowerCase(),t=sP(e.name),a="other";"pdf"===t?a="pdf":/^(doc|docx|ppt|pptx|xls|xlsx)$/.test(t)?a="office":/\.(png|jpg|jpeg|gif|webp|svg)$/.test(r)?a="image":/\.(mp4|mov|mkv|webm)$/.test(r)?a="video":/\.(mp3|wav|flac|ogg)$/.test(r)?a="audio":/\.(txt|log|md|json|csv|ts|tsx|js|jsx|css|html|xml|yml|yaml)$/.test(r)&&(a="text");try{let r=await le(eu,e.key,e.name),t={name:e.name,key:e.key,bucket:eu,kind:a,url:r};if(eH(t),"text"===a){let t=await fetch(r,{headers:{Range:"bytes=0-204799"}}),a=await t.text();eH(r=>r&&r.key===e.key?{...r,text:a}:r)}}catch{ro("预览失败")}},li=e=>!Number.isFinite(e)||e<=0?"-":`${Y(e)}/s`,lo=(e,r,t,a,s)=>new Promise((l,d)=>{let n=new XMLHttpRequest;if(n.open("PUT",e,!0),n.setRequestHeader("Content-Type",t||"application/octet-stream"),s){if(s.aborted)return void d(Error("上传已中止"));let e=()=>{try{n.abort()}catch{}};s.addEventListener("abort",e,{once:!0}),n.addEventListener("loadend",()=>{s.removeEventListener("abort",e)},{once:!0})}n.upload.onprogress=e=>{e.lengthComputable&&a(e.loaded,e.total)},n.onload=()=>{n.status>=200&&n.status<300?l({etag:n.getResponseHeader("ETag")}):d(Error(`上传失败（状态码：${n.status}）`))},n.onerror=()=>d(Error("网络异常，请重试")),n.onabort=()=>d(Error("上传已中止")),n.send(r)}),lc=async(e,r,t,a,s,d)=>{let n;try{n=await sa("/api/files",{method:"POST",body:JSON.stringify({bucket:r,key:t,contentType:a.type})})}catch(r){let e=r instanceof Error?r.message:String(r);throw Error(`请求上传签名失败：${e}`)}let i=await sr(n);if(!n.ok||!i.url)throw Error(l(i.error,`上传签名失败（状态码：${n.status}）`));await lo(i.url,a,a.type,e=>s(e),d)},lx=async(e,r,t,a,s,d)=>{let n,i=e=>1048576*Math.ceil(Math.max(8388608,Math.min(0x4000000,Math.ceil(e/6)))/1048576),o=el(r,t,a),c=tq.current.find(r=>r.id===e),x=c?.multipart,g=(n=en()[o])&&"object"==typeof n?n:null,u=x?.uploadId??g?.uploadId??null,m=x?.partSize??g?.partSize??i(a.size),b=x?.parts??g?.parts??{};if(g&&(g.size!==a.size||g.lastModified!==a.lastModified)&&(u=x?.uploadId??null,b=x?.parts??{},ec(o)),!u){let e;try{e=await sa("/api/multipart",{method:"POST",body:JSON.stringify({action:"create",bucket:r,key:t,contentType:a.type})})}catch(r){let e=r instanceof Error?r.message:String(r);throw Error(`创建分片上传失败：${e}`)}let s=await sr(e);if(!e.ok||!s.uploadId)throw Error(l(s.error,`创建分片上传失败（状态码：${e.status}）`));u=s.uploadId,b={},m=i(a.size)}lg(e,e=>({...e,resumeKey:o,multipart:{uploadId:u,partSize:m,parts:b}})),eo(o,{bucket:r,key:t,size:a.size,lastModified:a.lastModified,name:a.name,uploadId:u,partSize:m,parts:b});let y=Math.ceil(a.size/m),h=new Map,p=Object.keys(b).reduce((e,r)=>{let t,s=Number.parseInt(r,10);return!Number.isFinite(s)||s<=0?e:e+(t=(s-1)*m,Math.max(0,Math.min(a.size,t+m)-t))},0),f=()=>{let e=Array.from(h.values()).reduce((e,r)=>e+r,0);s(Math.min(a.size,p+e))};f();let k=Math.min(6,y),v=1,j=!1,N=async s=>{let n;if(b[String(s)])return;let i=(s-1)*m,c=Math.min(a.size,i+m),x=a.slice(i,c);try{n=await sa("/api/multipart",{method:"POST",body:JSON.stringify({action:"signPart",bucket:r,key:t,uploadId:u,partNumber:s})})}catch(r){let e=r instanceof Error?r.message:String(r);throw Error(`获取分片上传签名失败：${e}`)}let g=await sr(n);if(!n.ok||!g.url)throw Error(l(g.error,`分片签名失败（状态码：${n.status}）`));let y=null;try{y=(await lo(g.url,x,a.type,(e,r)=>{h.set(s,Math.min(e,r)),f()},d)).etag}finally{y||(h.delete(s),f())}if(!y)throw Error("上传响应缺少 ETag");h.delete(s),p=Math.min(a.size,p+x.size),f(),b[String(s)]=y,lg(e,e=>e.multipart?{...e,multipart:{...e.multipart,parts:{...e.multipart.parts,[String(s)]:y}}}:e),eo(o,{bucket:r,key:t,size:a.size,lastModified:a.lastModified,name:a.name,uploadId:u,partSize:m,parts:b})},w=async()=>{for(;;){if(j)return;let e=v++;if(e>y)return;await N(e)}};try{let e;await Promise.all(Array.from({length:Math.min(k,y)},w));let a=Object.entries(b).map(([e,r])=>({partNumber:Number.parseInt(e,10),etag:r})).filter(e=>Number.isFinite(e.partNumber)&&e.partNumber>0).sort((e,r)=>e.partNumber-r.partNumber);try{e=await sa("/api/multipart",{method:"POST",body:JSON.stringify({action:"complete",bucket:r,key:t,uploadId:u,parts:a})})}catch(r){let e=r instanceof Error?r.message:String(r);throw Error(`完成分片上传失败：${e}`)}let s=await sr(e);if(!e.ok)throw Error(l(s.error,`完成分片上传失败（状态码：${e.status}）`));ec(o)}catch(n){j=!0;let a=tq.current.find(r=>r.id===e),s=a?.status,l=d?.aborted===!0;throw l&&"paused"===s||l&&"canceled"===s&&(await sa("/api/multipart",{method:"POST",body:JSON.stringify({action:"abort",bucket:r,key:t,uploadId:u})}).catch(()=>{}),ec(o)),n}},lg=(e,r)=>{eV(t=>t.map(t=>t.id===e?r(t):t))},lu=e=>{eV(r=>r.map(r=>r.id===e&&("paused"===r.status||"error"===r.status)?{...r,status:"queued",speedBps:0,startedAt:void 0,error:void 0}:r)),eG(!1),setTimeout(()=>ly(),0)},lm=async e=>{let r=tq.current.find(r=>r.id===e);if(r?.multipart?.uploadId)try{await sa("/api/multipart",{method:"POST",body:JSON.stringify({action:"abort",bucket:r.bucket,key:r.key,uploadId:r.multipart.uploadId})})}catch{}finally{r.resumeKey&&ec(r.resumeKey)}},lb=e=>{eV(r=>r.map(r=>r.id===e&&("queued"===r.status||"uploading"===r.status||"paused"===r.status)?{...r,status:"canceled",speedBps:0}:r)),tW.current.get(e)?.abort(),lm(e),ro("已取消")},ly=async()=>{if(!tV.current&&!tG.current){tV.current=!0;try{for(;!tG.current;){let e=tq.current.find(e=>"queued"===e.status);if(!e)break;let r=new AbortController;tW.current.set(e.id,r),lg(e.id,e=>({...e,status:"uploading",startedAt:performance.now(),loaded:"number"==typeof e.loaded&&e.loaded>0?e.loaded:0,speedBps:0,error:void 0}));let t=e.file.size>=0x4600000?lx:lc,a=[{at:performance.now(),loaded:Math.max(0,e.loaded??0)}],s=0;try{await t(e.id,e.bucket,e.key,e.file,r=>{let t=performance.now(),l=Math.max(0,r);for(a.push({at:t,loaded:l});a.length>2&&t-a[0].at>1200;)a.shift();let d=a[0],n=Math.max(0,l-d.loaded),i=Math.max(.05,(t-d.at)/1e3),o=n/i;s=s>0?.65*s+.35*o:o,lg(e.id,e=>({...e,loaded:l,speedBps:Number.isFinite(s)?s:0}))},r.signal),lg(e.id,e=>({...e,status:"done",loaded:e.file.size,speedBps:0,multipart:void 0})),sw(e.bucket),eu===e.bucket&&sS(e.bucket,eh,{force:!0}).catch(()=>{}),e.resumeKey&&ec(e.resumeKey)}catch(a){let r=a instanceof Error?a.message:String(a),t=tq.current.find(r=>r.id===e.id);t?.status==="paused"||t?.status==="canceled"||lg(e.id,e=>({...e,status:"error",error:r,speedBps:0}))}finally{tW.current.delete(e.id)}}}finally{tV.current=!1}}},lh=async e=>{if(!e.target.files||!eu)return;let r=Array.from(e.target.files),t=eh.length>0?eh.join("/")+"/":"",a=r.map(e=>({id:globalThis.crypto?.randomUUID?.()??`${Date.now()}_${Math.random().toString(16).slice(2)}`,bucket:eu,file:e,key:t+e.name,resumeKey:el(eu,t+e.name,e),loaded:0,speedBps:0,status:"queued"}));eV(e=>[...a,...e].slice(0,50)),eJ(!0),ro(`已加入 ${a.length} 个上传任务`),eX.current&&(eX.current.value=""),setTimeout(()=>ly(),0)},lp=(0,a.useMemo)(()=>{let e=[...eY.trim()?e0:eb],r=(e,r)=>e.localeCompare(r,"zh-CN",{numeric:!0,sensitivity:"base"}),t=e=>"file"===e.type?sP(e.name):"",a=e=>{let r=Date.parse(e.lastModified??"");return Number.isFinite(r)?r:-1},s="asc"===e6?1:-1;return e.sort((e,l)=>{let d=("folder"!==e.type)-("folder"!==l.type);if(0!==d)return d;if("size"===e3){if("file"===e.type&&"file"===l.type){let r=(e.size??0)-(l.size??0);if(0!==r)return r*s}return r(e.name,l.name)*s}if("type"===e3){if("file"===e.type&&"file"===l.type){let a=r(t(e),t(l));if(0!==a)return a*s}return r(e.name,l.name)*s}if("time"===e3){let r=a(e)-a(l);if(0!==r)return r*s}return r(e.name,l.name)*s}),e},[e6,e3,eb,e0,eY]),lf=(0,a.useMemo)(()=>"all"===tf?tb:tb.filter(e=>e.status===tf),[tb,tf]),lk=(0,a.useMemo)(()=>{let e=eq.reduce((e,r)=>e+r.file.size,0),r=eq.reduce((e,r)=>e+Math.min(r.loaded,r.file.size),0),t=eq.filter(e=>"queued"===e.status||"uploading"===e.status).length,a=eq.reduce((e,r)=>e+("uploading"===r.status?r.speedBps:0),0),s=e?Math.min(100,Math.round(r/e*100)):0;return{active:t,total:eq.length,pct:s,speedText:li(a)}},[eq]),lv=(0,a.useMemo)(()=>{let e=eb.filter(e=>"file"===e.type).length;return{fileCount:e,folderCount:eb.filter(e=>"folder"===e.type).length,totalSize:eb.reduce((e,r)=>e+(r.size||0),0)}},[eb]),lj=(e,r,a="lg")=>{let s="lg"===a?"h-8 w-8":"h-7 w-7",l=r.toLowerCase(),d=sP(r),n="lg"===a?"4.5":"4.2",i=(e,r)=>(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:`${s} ${e}`,fill:"currentColor",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z",clipRule:"evenodd"}),(0,t.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"}),(0,t.jsx)("text",{x:"12",y:"18",textAnchor:"middle",fontSize:n,fill:"white",fontWeight:"bold",children:r})]});return"folder"===e?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-yellow-400`,fill:"currentColor",children:(0,t.jsx)("path",{d:"M19.5 21a3 3 0 0 0 3-3v-4.5a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3V18a3 3 0 0 0 3 3h15ZM1.5 10.146V6a3 3 0 0 1 3-3h5.379a2.25 2.25 0 0 1 1.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 0 1 3 3v1.146A4.483 4.483 0 0 0 19.5 9h-15a4.483 4.483 0 0 0-3 1.146Z"})}):/\.(jpg|jpeg|png|gif|webp|svg|bmp|ico|tiff)$/.test(l)?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-purple-500`,fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z",clipRule:"evenodd"})}):/\.(mp4|webm|ogg|mov|mkv|avi|m4v)$/.test(l)?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-rose-500`,fill:"currentColor",children:(0,t.jsx)("path",{d:"M4.5 4.5a3 3 0 0 0-3 3v9a3 3 0 0 0 3 3h8.25a3 3 0 0 0 3-3v-9a3 3 0 0 0-3-3H4.5ZM19.94 18.75l-2.69-2.69V7.94l2.69-2.69c.944-.945 2.56-.276 2.56 1.06v11.38c0 1.336-1.616 2.005-2.56 1.06Z"})}):/\.(mp3|wav|ogg|m4a|flac|aac|wma)$/.test(l)?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-cyan-500`,fill:"currentColor",children:(0,t.jsx)("path",{d:"M21 3L9 5.5v10.03a3.5 3.5 0 1 0 2 3V8.41l8-1.66v7.78a3.5 3.5 0 1 0 2 3V3z"})}):l.endsWith(".pdf")?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:`${s} text-red-500`,fill:"currentColor",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,t.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):/\.(xlsx|xls|csv)$/.test(l)?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:`${s} text-green-600`,fill:"currentColor",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,t.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):/\.(pptx|ppt)$/.test(l)?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:`${s} text-orange-500`,fill:"currentColor",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,t.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):/\.(docx|doc)$/.test(l)?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:`${s} text-blue-600`,fill:"currentColor",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,t.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"}),(0,t.jsx)("text",{x:"8",y:"18",fontSize:"6",fill:"white",fontWeight:"bold",children:"W"})]}):/(dwg|dxf|dwt|dwf|step|stp|iges|igs|ifc)$/.test(d)?i("text-teal-600","CAD"):/(exe|msi|com|scr)$/.test(d)?i("text-slate-700","EXE"):/(apk|xapk|apks|aab)$/.test(d)?i("text-emerald-600","APK"):"ipa"===d?i("text-sky-600","IPA"):/(dmg|pkg|deb|rpm|appimage)$/.test(d)?i("text-slate-600","APP"):/\.(zip|rar|7z|tar|gz|bz2|xz)$/.test(l)?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-gray-500`,fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M6 3a3 3 0 0 0-3 3v12a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3V6a3 3 0 0 0-3-3H6Zm1.5 1.5a.75.75 0 0 0-.75.75v1.5a.75.75 0 0 0 .75.75h1.5a.75.75 0 0 0 .75-.75v-1.5a.75.75 0 0 0-.75-.75h-1.5ZM6 9.75A.75.75 0 0 1 6.75 9h1.5a.75.75 0 0 1 .75.75v1.5a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1-.75-.75v-1.5Zm.75 3.75a.75.75 0 0 0-.75.75v1.5a.75.75 0 0 0 .75.75h1.5a.75.75 0 0 0 .75-.75v-1.5a.75.75 0 0 0-.75-.75h-1.5Z",clipRule:"evenodd"})}):/\.(html|css|js|jsx|ts|tsx|json|java|py|go|c|cpp|h|cs|php|rb|sh|bat|cmd|xml|yaml|yml|sql|rs|swift|kt)$/.test(l)?(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-indigo-500`,fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M14.447 3.026a.75.75 0 0 1 .527.921l-4.5 16.5a.75.75 0 0 1-1.448-.394l4.5-16.5a.75.75 0 0 1 .921-.527ZM16.72 6.22a.75.75 0 0 1 1.06 0l5.25 5.25a.75.75 0 0 1 0 1.06l-5.25 5.25a.75.75 0 1 1-1.06-1.06L21.44 12l-4.72-4.72a.75.75 0 0 1 0-1.06Zm-9.44 0a.75.75 0 0 1 0 1.06L2.56 12l4.72 4.72a.75.75 0 0 1-1.06 1.06L.97 12.53a.75.75 0 0 1 0-1.06l5.25-5.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"})}):/\.(txt|md|markdown|log|ini|conf)$/.test(l)?(0,t.jsxs)("svg",{viewBox:"0 0 24 24",className:`${s} text-slate-500`,fill:"currentColor",children:[(0,t.jsx)("path",{fillRule:"evenodd",d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625ZM7.5 15a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 7.5 15Zm.75 2.25a.75.75 0 0 0 0 1.5H12a.75.75 0 0 0 0-1.5H8.25Z",clipRule:"evenodd"}),(0,t.jsx)("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})]}):(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:`${s} text-gray-400`,fill:"currentColor",children:(0,t.jsx)("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm11.378-3.917c-.89-.777-2.366-.777-3.255 0a.75.75 0 0 1-.988-1.129c1.454-1.272 3.776-1.272 5.23 0 1.513 1.271 1.513 3.374 0 4.646l-2.114 1.84a.75.75 0 0 1-1.004-1.114l2.114-1.84c.89-.777.89-2.096 0-2.803Zm-4.243 9.045a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"})})};if(eE)return(0,t.jsx)("div",{className:"min-h-dvh bg-gradient-to-br from-slate-50 via-white to-slate-50 dark:from-gray-950 dark:via-gray-950 dark:to-gray-900 px-4 sm:px-6 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-3 rounded-full border border-gray-200 bg-white/90 px-4 py-2 text-sm text-gray-700 shadow-sm dark:border-gray-800 dark:bg-gray-900/90 dark:text-gray-200",children:[(0,t.jsx)(q,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"正在恢复登录状态"})]})});if(eI){let e=!rx||rh,r=d.every(e=>i[e].trim().length>0),a=i[at].replace(/^\s*#{1,6}\s*/gm,"");return(0,t.jsxs)("div",{className:`bg-gradient-to-br from-slate-50 via-white to-slate-50 dark:from-gray-950 dark:via-gray-950 dark:to-gray-900 px-4 sm:px-6 font-sans text-gray-900 dark:text-gray-100 pt-[max(1rem,env(safe-area-inset-top))] pb-[max(1rem,env(safe-area-inset-bottom))] ${rx?e?"min-h-dvh overflow-y-auto":"min-h-dvh flex items-center justify-center":"h-dvh overflow-hidden flex items-center justify-center"}`,children:[(0,t.jsxs)("div",{className:`w-full max-w-6xl grid grid-cols-1 lg:grid-cols-2 gap-6 ${rx?e?"h-auto items-start":"h-auto items-center":"h-full min-h-0 items-stretch"}`,children:[(0,t.jsxs)("section",{className:`min-h-0 rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col order-2 lg:order-1 dark:border-gray-800 dark:bg-gray-900 ${e?"":"hidden"}`,children:[(0,t.jsx)("div",{className:"px-8 py-7 h-[168px] bg-gradient-to-br from-indigo-600 to-blue-600 text-white flex items-center",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-white/85",children:ee.title}),(0,t.jsx)("h1",{className:"mt-2 text-3xl font-semibold tracking-tight",children:"公告与说明"}),(0,t.jsx)("p",{className:"mt-2 text-white/80",children:ee.subtitle})]})}),(0,t.jsxs)("div",{className:["px-8 py-6 flex flex-col gap-5",rx?"":"grow overflow-y-auto"].filter(Boolean).join(" "),children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:"平台优势"}),(0,t.jsx)("ul",{className:"mt-3 space-y-2 text-sm text-gray-800 dark:text-gray-200",children:ee.advantages.map(e=>(0,t.jsxs)("li",{className:"flex gap-3",children:[(0,t.jsx)("span",{className:"mt-2 h-1.5 w-1.5 rounded-full bg-blue-600 flex-none"}),(0,t.jsx)("span",{className:"leading-relaxed",children:e})]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:ee.announcementTitle}),(0,t.jsx)("div",{className:"mt-3 rounded-2xl border border-gray-200 bg-gray-50 p-4 text-sm text-gray-700 whitespace-pre-wrap leading-relaxed dark:border-gray-800 dark:bg-gray-950/30 dark:text-gray-200",children:ee.announcementText})]}),(0,t.jsxs)("div",{className:"mt-auto",children:[(0,t.jsx)("div",{className:"text-xs font-semibold tracking-wide text-gray-500 dark:text-gray-400",children:"导航"}),(0,t.jsx)("nav",{className:"mt-3 grid grid-cols-4 gap-2",children:er.map(e=>{let r="globe"===e.icon?(0,t.jsx)(B,{className:"w-5 h-5"}):"book"===e.icon?(0,t.jsx)(U,{className:"w-5 h-5"}):"about"===e.icon?(0,t.jsx)(T,{className:"w-5 h-5"}):(0,t.jsx)(O,{className:"w-5 h-5"});return(0,t.jsxs)("a",{href:e.href,target:e.href.startsWith("mailto:")?void 0:"_blank",rel:e.href.startsWith("mailto:")?void 0:"noreferrer",className:"group rounded-xl border border-gray-200 bg-white hover:bg-gray-50 transition-colors px-2 py-3 flex flex-col items-center justify-center gap-2 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-900",children:[(0,t.jsx)("div",{className:"text-gray-700 group-hover:text-blue-600 transition-colors dark:text-gray-200 dark:group-hover:text-blue-300",children:r}),(0,t.jsx)("div",{className:"text-[12px] text-gray-700 group-hover:text-blue-600 transition-colors dark:text-gray-200 dark:group-hover:text-blue-300",children:e.label})]},e.href)})}),(0,t.jsxs)("div",{className:"mt-6 flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[(0,t.jsx)("span",{children:ee.footer}),(0,t.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("span",{className:"h-2 w-2 rounded-full bg-emerald-500"}),"版本号：V2.0"]})]})]})]})]}),(0,t.jsxs)("section",{className:"relative min-h-0 rounded-2xl border border-gray-200 bg-white shadow-sm overflow-hidden flex flex-col order-1 lg:order-2 dark:border-gray-800 dark:bg-gray-900",children:[(0,t.jsx)("div",{className:"px-6 py-4 sm:px-8 sm:py-7 sm:h-[168px] bg-blue-600 text-white flex items-center shrink-0",children:(0,t.jsxs)("div",{className:"flex items-center gap-4 w-full",children:[(0,t.jsx)("div",{className:"h-16 w-16 flex items-center justify-center shrink-0",children:(0,t.jsx)(F,{className:"w-16 h-16"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-semibold leading-tight",children:ee.title}),(0,t.jsx)("div",{className:"mt-1 text-[17px] text-white/80",children:ee.subtitle})]})]})}),(0,t.jsxs)("div",{className:["px-8 py-7 flex flex-col gap-5",rx?"":"grow overflow-y-auto"].filter(Boolean).join(" "),children:[(0,t.jsx)("div",{className:"mx-auto w-full max-w-sm",children:(0,t.jsxs)("div",{className:"relative grid grid-cols-2 rounded-xl border border-gray-200 bg-gray-50 p-1 dark:border-gray-800 dark:bg-gray-950/40",children:[(0,t.jsx)("span",{"aria-hidden":"true",className:`absolute left-1 top-1 bottom-1 w-[calc(50%-0.25rem)] rounded-lg bg-blue-600 transition-transform duration-300 ease-out ${tE?"translate-x-full":"translate-x-0"}`}),(0,t.jsx)("button",{type:"button",disabled:ef,onClick:()=>{tR(!1),an("")},className:`relative z-10 rounded-lg py-2 text-sm font-semibold transition-colors disabled:opacity-60 disabled:cursor-not-allowed ${tE?"text-gray-600 dark:text-gray-300":"text-white"}`,children:"登陆"}),(0,t.jsx)("button",{type:"button",disabled:ef,onClick:()=>{tR(!0),an("")},className:`relative z-10 rounded-lg py-2 text-sm font-semibold transition-colors disabled:opacity-60 disabled:cursor-not-allowed ${tE?"text-white":"text-gray-600 dark:text-gray-300"}`,children:"注册"})]})}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("h2",{className:"text-3xl font-bold tracking-tight text-blue-600 dark:text-blue-400",children:tE?"账号注册":"账号登录"})}),(0,t.jsx)("div",{children:tE?(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),su(e)},className:"flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱账号"}),(0,t.jsx)("input",{type:"email",value:t5,onChange:e=>{t2(e.target.value),al("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"登录密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:aD?"text":"password",value:t4,onChange:e=>{t7(e.target.value),al("")},className:"w-full px-4 py-3 pr-10 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>aZ(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":aD?"隐藏密码":"显示密码",children:aD?(0,t.jsx)(C,{className:"w-5 h-5"}):(0,t.jsx)(S,{className:"w-5 h-5"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between gap-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"邮箱验证码"}),(0,t.jsx)("button",{type:"button",onClick:()=>{sm()},disabled:ef||a4>0,className:"shrink-0 text-xs font-medium text-blue-600 hover:text-blue-700 disabled:text-gray-400 disabled:cursor-not-allowed dark:text-blue-300 dark:hover:text-blue-200 dark:disabled:text-gray-500",children:a4>0?`${a4}s 后重发`:"发送验证码"})]}),(0,t.jsx)("div",{children:(0,t.jsx)("input",{type:"text",inputMode:"numeric",value:t3,onChange:e=>{t8(e.target.value.replace(/\s+/g,"")),al("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱验证码"})})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-2 py-0 min-h-9",children:[(0,t.jsx)("input",{type:"checkbox",id:"register_agree",checked:t6,onChange:e=>{t9(e.target.checked),al("")},className:"w-4 h-4 mt-0.5 shrink-0 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-700"}),(0,t.jsxs)("div",{className:"block text-sm leading-5 text-gray-600 dark:text-gray-300",children:[(0,t.jsx)("label",{htmlFor:"register_agree",className:"cursor-pointer",children:"我已阅读并同意"}),(0,t.jsx)("span",{children:"「"}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),st("terms")},className:"text-gray-700 hover:text-blue-600 transition-colors dark:text-gray-200 dark:hover:text-blue-300",children:"用户协议"}),(0,t.jsx)("span",{children:"」和「"}),(0,t.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),st("privacy")},className:"text-gray-700 hover:text-blue-600 transition-colors dark:text-gray-200 dark:hover:text-blue-300",children:"隐私政策"}),(0,t.jsx)("span",{children:"」"})]})]})]}),(0,t.jsxs)("div",{className:"pt-2 space-y-3",children:[(0,t.jsx)("div",{className:"relative h-6",children:as?(0,t.jsx)("div",{className:"absolute inset-x-0 -top-1 text-sm text-red-600 leading-tight text-left dark:text-red-300",children:as}):null}),(0,t.jsx)("button",{type:"submit",disabled:ef,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors shadow-blue-500/20 shadow-lg inline-flex items-center justify-center gap-2 disabled:cursor-not-allowed disabled:bg-blue-500/75",children:ef?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q,{className:"h-5 w-5"}),(0,t.jsxs)("span",{className:"inline-flex items-center gap-2",children:["正在注册",(0,t.jsx)(V,{})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w,{className:"w-5 h-5"}),"验证并注册"]})})]})]}):(0,t.jsxs)("form",{onSubmit:sg,className:"flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"space-y-5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱账号"}),(0,t.jsx)("input",{type:"email",value:tY,onChange:e=>{tQ(e.target.value),an("")},className:"w-full px-4 py-3 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入邮箱"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"登录密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:aL?"text":"password",value:t0,onChange:e=>{t1(e.target.value),an("")},className:"w-full px-4 py-3 pr-10 rounded-lg border border-gray-300 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>aK(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":aL?"隐藏密码":"显示密码",children:aL?(0,t.jsx)(C,{className:"w-5 h-5"}):(0,t.jsx)(S,{className:"w-5 h-5"})})]})]}),(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3 py-0 min-h-9",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"remember",checked:aO,onChange:e=>aU(e.target.checked),className:"w-4 h-4 mt-0.5 shrink-0 text-blue-600 border-gray-300 rounded focus:ring-blue-500 dark:border-gray-700"}),(0,t.jsx)("label",{htmlFor:"remember",className:"block text-sm leading-5 text-gray-600 dark:text-gray-300",children:"记住登录状态"})]}),(0,t.jsx)("button",{type:"button",onClick:()=>{ab(tY.trim()),ah(""),af(""),au(!0)},className:"shrink-0 text-sm leading-5 text-gray-600 hover:text-blue-700 transition-colors dark:text-gray-300 dark:hover:text-blue-200",children:"忘记密码"})]})]}),(0,t.jsxs)("div",{className:"pt-2 space-y-3",children:[(0,t.jsx)("div",{className:"relative h-6",children:ad?(0,t.jsx)("div",{className:"absolute inset-x-0 -top-1 text-sm text-red-600 leading-tight text-left dark:text-red-300",children:ad}):null}),(0,t.jsx)("button",{type:"submit",disabled:ef,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-lg transition-colors shadow-blue-500/20 shadow-lg inline-flex items-center justify-center gap-2 disabled:cursor-not-allowed disabled:bg-blue-500/75",children:ef?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q,{className:"h-5 w-5"}),(0,t.jsxs)("span",{className:"inline-flex items-center gap-2",children:["正在登录",(0,t.jsx)(V,{})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(w,{className:"w-5 h-5"}),"进入管理"]})})]})]})}),rx?(0,t.jsxs)("button",{type:"button",onClick:()=>rp(e=>!e),className:"mt-1 inline-flex w-fit self-start items-center gap-1.5 px-0 py-0 text-xs font-medium text-gray-500 hover:text-blue-600 transition-colors dark:text-gray-400 dark:hover:text-blue-300",children:[rh?"收起「公告与说明」":"展开「公告与说明」",(0,t.jsx)(k,{className:`w-3.5 h-3.5 transition-transform ${rh?"rotate-180":""}`})]}):null]}),ef?(0,t.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-white/70 backdrop-blur-[2px] dark:bg-gray-900/70",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-3 rounded-2xl border border-cyan-200/70 bg-white/90 px-4 py-3 text-sm font-medium text-slate-700 shadow-lg dark:border-cyan-900/60 dark:bg-slate-900/90 dark:text-slate-100",children:[(0,t.jsx)(q,{className:"h-5 w-5"}),(0,t.jsxs)("span",{className:"inline-flex items-center gap-2",children:[tE?"正在提交注册信息":"正在验证账号信息",(0,t.jsx)(V,{})]})]})}):null]})]}),(0,t.jsx)(s,{open:ag,title:"找回密码",description:"输入注册邮箱并验证邮箱验证码，验证后可设置新密码。",onClose:()=>au(!1),footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>au(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{sy()},disabled:ef,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"验证并继续"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"注册邮箱"}),(0,t.jsx)("input",{type:"email",value:am,onChange:e=>{ab(e.target.value),af("")},className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入注册邮箱"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"邮箱验证码"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"text",inputMode:"numeric",value:ay,onChange:e=>{ah(e.target.value.replace(/\s+/g,"")),af("")},className:"flex-1 px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"请输入重置验证码"}),(0,t.jsx)("button",{type:"button",onClick:()=>{sb()},disabled:ef||a7>0,className:"shrink-0 px-3.5 py-2.5 rounded-lg border border-blue-200 text-blue-700 bg-blue-50 hover:bg-blue-100 text-sm font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed dark:border-blue-900 dark:bg-blue-950/30 dark:text-blue-200 dark:hover:bg-blue-950/40",children:a7>0?`${a7}s`:"发送验证码"})]})]}),ap?(0,t.jsx)("div",{className:"text-sm text-red-600 dark:text-red-300",children:ap}):null]})}),(0,t.jsx)(s,{open:aj,title:"设置新密码",description:"请设置新的登录密码，设置完成后使用新密码登录。",onClose:()=>aN(!1),footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>aN(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"稍后再说"}),(0,t.jsx)("button",{onClick:()=>{sh()},disabled:ef,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"保存新密码"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新密码"}),(0,t.jsx)("input",{type:"password",value:aw,onChange:e=>aS(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"确认新密码"}),(0,t.jsx)("input",{type:"password",value:aC,onChange:e=>a$(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"再次输入新密码"})]})]})}),(0,t.jsx)(s,{open:ae,title:"服务条款与政策",description:"请阅读并确认相关条款内容。",onClose:()=>ar(!1),closeOnBackdropClick:!1,panelClassName:"max-w-4xl",footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{window.location.assign("/404")},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium transition-colors",children:"不同意"}),(0,t.jsx)("button",{onClick:()=>{t9(!0),al(""),ar(!1)},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium transition-colors",children:"我已阅读并理解全部条款"})]}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:d.map(e=>{let r=at===e;return(0,t.jsx)("button",{type:"button",onClick:()=>aa(e),className:["rounded-lg px-3 py-2 text-sm font-medium border transition-colors",r?"border-blue-500 bg-blue-50 text-blue-700 dark:border-blue-400 dark:bg-blue-950/30 dark:text-blue-200":"border-gray-200 bg-white text-gray-600 hover:bg-gray-50 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-300 dark:hover:bg-gray-900"].filter(Boolean).join(" "),children:n[e]},e)})}),(0,t.jsx)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm leading-6 text-gray-700 whitespace-pre-wrap break-words min-h-[24rem] dark:border-gray-800 dark:bg-gray-950/40 dark:text-gray-200",children:r?a:(0,t.jsx)("div",{className:"text-gray-500 dark:text-gray-400",children:"暂无内容"})})]})}),se]})}let lN=e=>{if(!e)return"";let r=ex.find(r=>r.id===e);return r?.Name||e},lw=eu?lN(eu):null,lS=ef||e4||ev,lC=tF?ex.find(e=>e.id===tF)??null:null,l$=!tP,lM=e=>e?ex.find(r=>r.id===e)??null:null,lI=e=>{em(e),ep([]),eQ(""),eL(null),eD(new Set),rv(!1),rx&&rm(!1),ro(`已切换到：${lN(e)}`)},lA=()=>{tB(null),a1({}),aW(!1),aX(!1),sk(),tz(!0)},lE=({onClose:r})=>{let a,s,l,d,n,i,o,c,x,g;return(0,t.jsxs)("div",{className:`h-full w-full bg-white border-r border-gray-200 flex flex-col dark:bg-gray-900 dark:border-gray-800 ${r?"shadow-sm":""}`,children:[(0,t.jsxs)("div",{className:"h-16 px-5 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)(F,{className:"w-10 h-10 md:w-11 md:h-11 shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("h1",{className:"font-bold text-[18px] leading-[1.15] tracking-tight text-blue-600 truncate dark:text-blue-400",children:ee.title}),(0,t.jsx)("p",{className:"mt-0.25 text-[13px] leading-[1.1] text-gray-400 font-medium truncate dark:text-gray-400",children:ee.subtitle})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:r?(0,t.jsx)("button",{type:"button",onClick:r,className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800","aria-label":"关闭菜单",children:(0,t.jsx)(R,{className:"w-5 h-5"})}):null})]}),(0,t.jsxs)("div",{className:"flex-1 flex flex-col overflow-y-auto",children:[(0,t.jsx)("div",{className:"p-3 space-y-3 shrink-0",children:(0,t.jsxs)("div",{className:"px-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase px-2 tracking-wider leading-none dark:text-gray-400",children:"存储桶"}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)("button",{type:"button",onClick:()=>{sC(),ro("已刷新桶列表")},className:"px-2 py-1 rounded-md text-xs font-medium text-blue-600 hover:bg-blue-50 leading-none dark:text-blue-300 dark:hover:bg-blue-950/30",title:"刷新桶列表","aria-label":"刷新桶列表",children:"刷新"})})]}),(0,t.jsxs)("div",{ref:rf,className:"relative mt-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>rv(e=>!e),className:"w-full rounded-xl border border-gray-200 bg-white px-3 py-2.5 text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 flex items-center justify-between gap-3","aria-haspopup":"listbox","aria-expanded":rk,children:[(0,t.jsx)("span",{className:"truncate",children:eu?lN(eu):"选择存储桶"}),(0,t.jsx)(k,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform ${rk?"rotate-180":""}`})]}),rk?(0,t.jsx)("div",{className:"absolute left-0 right-0 top-[calc(100%+0.5rem)] z-20 rounded-2xl border border-gray-200 bg-white shadow-xl overflow-hidden dark:border-gray-800 dark:bg-gray-900",children:(0,t.jsx)("div",{className:"max-h-[40vh] overflow-auto p-2",children:ex.length?ex.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>lI(e.id),className:`w-full flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm transition-colors ${eu===e.id?"bg-blue-50 text-blue-700 font-medium dark:bg-blue-950/40 dark:text-blue-200":"text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-800"}`,children:[(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${eu===e.id?"bg-blue-500":"bg-gray-300 dark:bg-gray-700"}`}),(0,t.jsx)("span",{className:"truncate",children:lN(e.id)})]},e.id)):(0,t.jsx)("div",{className:"px-3 py-3 text-sm text-gray-500 dark:text-gray-400",children:"暂无桶"})})}):null]}),(0,t.jsx)("div",{className:"mt-2 text-[10px] text-gray-500 px-1 leading-relaxed dark:text-gray-400",children:"桶管理入口已移至底部「当前登陆账号」模块。"})]})}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50/50 space-y-3 dark:border-gray-800 dark:bg-gray-950/30 shrink-0",children:[(0,t.jsxs)("div",{className:`text-xs px-3 py-2 rounded-md border ${"connected"===eN?"bg-green-50 text-green-700 border-green-100 dark:bg-green-950/40 dark:text-green-200 dark:border-green-900":"checking"===eN?"bg-yellow-50 text-yellow-700 border-yellow-100 dark:bg-yellow-950/35 dark:text-yellow-200 dark:border-yellow-900":"unbound"===eN?"bg-blue-50 text-blue-700 border-blue-100 dark:bg-blue-950/40 dark:text-blue-200 dark:border-blue-900":"bg-red-50 text-red-700 border-red-100 dark:bg-red-950/40 dark:text-red-200 dark:border-red-900"}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(J,{className:"w-3 h-3"}),(0,t.jsx)("span",{className:"font-medium",children:"connected"===eN?"连接状态正常":"checking"===eN?"连接中...":"unbound"===eN?"未绑定存储桶":"连接异常"})]}),"connected"===eN?(a=eu?ex.find(e=>e.id===eu)?.transferMode:void 0,s=eu?sE(eu):void 0,l=String(s?.s3BucketName??"").trim(),d=eu?sR(eu):null,n=eu?sA(eu):"auto",i="当前传输通道：未检测",o=null,c="auto"===n?"":"（手动）","presigned"===a?(i="proxy"===n?`当前传输通道：Pages 代理${c}`:`当前传输通道：R2 直连${c}`,l&&(o=d?d.ok?null:`桶名校验失败：${l}，${d.hint||"请检查桶名"}（已忽略此桶名设置）`:null)):"presigned_needs_bucket_name"===a?l?d?d.ok?(i="proxy"===n?`当前传输通道：Pages 代理${c}`:`当前传输通道：R2 直连${c}`,o=null):(i=`当前传输通道：Pages 代理${c}`,o=`桶名校验失败：${l}${d.hint||"请检查桶名"}，无法启用「R2 直连」，已回退至「Pages 代理」`):(i="proxy"===n?`当前传输通道：Pages 代理${c}`:`当前传输通道：R2 直连${c}`,o=null):(i=`当前传输通道：Pages 代理${c}`,o="已配置 R2 直连，如需启动 R2 直连，请先在「编辑桶」中确认桶名并完成校验。"):"proxy"===a&&(i=`当前传输通道：Pages 代理${c}`),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"mt-1 text-[11px] leading-relaxed opacity-80",children:i}),o?(0,t.jsx)("div",{className:"mt-1 text-[10px] leading-relaxed opacity-80",children:o}):null]})):null,eS&&!e$?(0,t.jsx)("div",{className:"mt-1 text-[10px] leading-relaxed opacity-80",children:eS}):null]}),"connected"===eN&&eu?(0,t.jsx)("div",{className:"px-3 py-2 rounded-md border border-gray-200 bg-white text-xs text-gray-600 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"font-medium truncate",children:"选择传输通道"}),(x=sA(eu),g=ex.find(e=>e.id===eu)?.transferMode!=="proxy",(0,t.jsxs)("div",{ref:rj,className:"relative",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>rw(e=>!e),className:"inline-flex items-center gap-2 rounded-md border border-gray-200 bg-white px-2 py-1 text-[11px] text-gray-700 outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-colors dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100","aria-haspopup":"listbox","aria-expanded":rN,title:"选择传输通道",children:[(0,t.jsx)("span",{className:"leading-none",children:"auto"===x?"自动":"presigned"===x?"R2 直连":"Pages 代理"}),(0,t.jsx)(k,{className:`w-3.5 h-3.5 opacity-70 transition-transform ${rN?"rotate-180":""}`})]}),rN?(0,t.jsx)("div",{className:"absolute right-0 top-[calc(100%+0.5rem)] z-30 min-w-[10rem] rounded-xl border border-gray-200 bg-white shadow-xl overflow-hidden dark:border-gray-800 dark:bg-gray-900",children:(0,t.jsx)("div",{className:"p-2 space-y-1",children:[{value:"auto",label:"自动",disabled:!1},{value:"presigned",label:"R2 直连",disabled:!g},{value:"proxy",label:"Pages 代理",disabled:!1}].map(e=>(0,t.jsxs)("button",{type:"button",disabled:e.disabled,onClick:()=>{var r;rw(!1),r=e.value,rn(e=>{let t={...e,[eu]:r};return localStorage.setItem("r2_transfer_mode_override_v1",JSON.stringify(t)),t}),ro("auto"===e.value?"已切换传输模式（自动）":"presigned"===e.value?"已切换传输模式（R2 直连）":"已切换传输模式（Pages 代理）")},className:["w-full flex items-center justify-between gap-3 px-3 py-2 rounded-lg text-[12px] transition-colors",e.value===x?"bg-blue-50 text-blue-700 font-medium dark:bg-blue-950/40 dark:text-blue-200":"text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-800",e.disabled?"opacity-50 cursor-not-allowed hover:bg-transparent dark:hover:bg-transparent":""].filter(Boolean).join(" "),role:"option","aria-selected":e.value===x,children:[(0,t.jsx)("span",{children:e.label}),(0,t.jsx)("span",{className:["w-2 h-2 rounded-full",e.value===x?"bg-blue-500":"bg-gray-300 dark:bg-gray-700"].join(" "),"aria-hidden":"true"})]},e.value))})}):null]}))]})}):null,(0,t.jsxs)("div",{className:"px-3 py-2 rounded-md border border-gray-200 bg-white text-xs text-gray-600 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"font-medium truncate",children:"当前桶占用估算"}),(0,t.jsx)("button",{onClick:()=>eu&&sM(eu),disabled:!eu||eT,className:"text-[11px] text-blue-600 hover:text-blue-700 disabled:opacity-50 dark:text-blue-300 dark:hover:text-blue-200",children:eT?"计算中...":"刷新"})]}),(0,t.jsxs)("div",{className:"mt-1.5 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"对象数"}),(0,t.jsx)("span",{className:"text-[11px] font-semibold text-gray-800 dark:text-gray-100",children:e_?e_.truncated?`≥${e_.objects}`:`${e_.objects}`:"-"})]}),(0,t.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"容量"}),(0,t.jsx)("span",{className:"text-[11px] font-semibold text-gray-800 dark:text-gray-100",children:e_?e_.truncated?`≥${Y(e_.bytes)}`:Y(e_.bytes):"-"})]}),e_?.truncated?(0,t.jsxs)("div",{className:"mt-1 text-[10px] text-gray-400 dark:text-gray-500",children:["仅扫描前 ",e_.pagesScanned," 页（每页最多 1000 项）"]}):null,eP&&!e$?(0,t.jsx)("div",{className:"mt-1 text-[10px] text-red-600 leading-relaxed dark:text-red-300",children:eP}):null]}),(0,t.jsxs)("button",{type:"button",onClick:()=>tO(!0),className:"w-full px-3 py-2 rounded-md border border-gray-200 bg-white text-left text-xs text-gray-600 hover:bg-gray-50 transition-colors dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200 dark:hover:bg-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-blue-50 text-blue-600 dark:bg-blue-950/40 dark:text-blue-300",children:(0,t.jsx)(K,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"font-medium truncate",children:"当前登录账号"}),(0,t.jsx)("div",{className:"mt-0.5 text-[11px] font-semibold text-gray-800 truncate dark:text-gray-100",children:e?.email?e.email:"未读取到邮箱"}),(0,t.jsxs)("div",{className:"mt-0.5 text-[10px] text-gray-500 dark:text-gray-400",children:["已绑定桶：",ex.length]})]})]}),(0,t.jsx)("div",{className:"mt-2 text-[10px] text-gray-400 dark:text-gray-500",children:"点击进入账号中心，管理当前账号下的存储桶。"})]}),(0,t.jsxs)("button",{onClick:sD,className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-600 hover:bg-blue-50 hover:text-blue-600 hover:border-blue-200 rounded-lg text-xs font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-blue-950/40 dark:hover:text-blue-200 dark:hover:border-blue-900",children:[(0,t.jsx)(M.Link2,{className:"w-3 h-3"}),"分享管理"]}),(0,t.jsxs)("button",{onClick:()=>tM(!0),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-600 hover:bg-red-50 hover:text-red-600 hover:border-red-200 rounded-lg text-xs font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-red-950/40 dark:hover:text-red-200 dark:hover:border-red-900",children:[(0,t.jsx)(N,{className:"w-3 h-3"}),"退出登录"]})]})]})]})},lR=({onClose:e,compact:r})=>(0,t.jsxs)("div",{className:"h-full w-full bg-white border-l border-gray-200 flex flex-col shadow-sm dark:bg-gray-900 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"h-16 px-5 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,t.jsx)("h2",{className:"font-bold text-gray-800 text-sm uppercase tracking-wide dark:text-gray-100",children:"详细信息"}),e?(0,t.jsx)("button",{type:"button",onClick:e,className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800","aria-label":"关闭详情",children:(0,t.jsx)(R,{className:"w-5 h-5"})}):null]}),(0,t.jsxs)("div",{className:`flex-1 overflow-y-auto ${r?"p-4 space-y-5":"p-6 space-y-8"}`,children:[eU?(0,t.jsxs)("div",{className:`${r?"space-y-4":"space-y-6"} animate-in fade-in slide-in-from-right-4 duration-300`,children:[(0,t.jsxs)("div",{className:r?"flex items-center gap-3":"flex flex-col items-center",children:[(0,t.jsx)("div",{className:`${r?"w-14 h-14 rounded-xl":"w-16 h-16 rounded-2xl"} bg-gray-50 border border-gray-100 flex items-center justify-center ${r?"":"mb-4"} shadow-sm dark:bg-gray-950 dark:border-gray-800`,children:lj(eU.type,eU.name)}),(0,t.jsxs)("div",{className:r?"min-w-0 flex-1":"",children:[(0,t.jsx)("h3",{className:`font-semibold text-gray-900 ${r?"text-left break-words":"text-center break-all px-2"} leading-snug dark:text-gray-100`,children:eU.name}),r?(0,t.jsxs)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["folder"===eU.type?"文件夹":Y(eU.size),eU.lastModified?` \xb7 ${new Date(eU.lastModified).toLocaleDateString()}`:""]}):(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap items-center justify-center gap-2",children:[(0,t.jsx)("span",{className:"text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:sB(eU)}),(0,t.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["folder"===eU.type?"文件夹":"文件","file"===eU.type?` \xb7 ${Y(eU.size)}`:"",eU.lastModified?` \xb7 ${new Date(eU.lastModified).toLocaleDateString()}`:""]})]})]})]}),"folder"===eU.type?(0,t.jsxs)("div",{className:`grid grid-cols-2 ${r?"gap-2 pt-1":"gap-3 pt-2"}`,children:[(0,t.jsxs)("button",{onClick:()=>sq(eU.name),className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors col-span-2",children:[(0,t.jsx)(E.FolderOpen,{className:"w-4 h-4"}),"打开文件夹"]}),(0,t.jsxs)("button",{onClick:s0,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(v,{className:"w-4 h-4"}),"重命名"]}),(0,t.jsxs)("button",{onClick:()=>s4("move"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(A,{className:"w-4 h-4"}),"移动"]}),(0,t.jsxs)("button",{onClick:()=>s4("copy"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(I,{className:"w-4 h-4"}),"复制"]}),(0,t.jsxs)("button",{onClick:sY,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-200 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-red-200 dark:hover:bg-red-950/40 dark:hover:border-red-900",children:[(0,t.jsx)(x,{className:"w-4 h-4"}),"删除"]})]}):(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3 pt-2",children:[(0,t.jsxs)("button",{onClick:()=>ln(eU),className:"flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 text-white hover:bg-blue-700 rounded-lg text-sm font-medium transition-colors col-span-2",children:[(0,t.jsx)(S,{className:"w-4 h-4"}),"预览"]}),(0,t.jsxs)("button",{onClick:()=>lt(eU),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)($.Download,{className:"w-4 h-4"}),"下载"]}),(0,t.jsxs)("button",{onClick:s0,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(v,{className:"w-4 h-4"}),"重命名"]}),(0,t.jsxs)("button",{onClick:()=>s4("move"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(A,{className:"w-4 h-4"}),"移动"]}),(0,t.jsxs)("button",{onClick:()=>s4("copy"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(I,{className:"w-4 h-4"}),"复制"]}),(0,t.jsxs)("button",{onClick:sY,className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-red-600 hover:bg-red-50 hover:border-red-200 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-red-200 dark:hover:bg-red-950/40 dark:hover:border-red-900",children:[(0,t.jsx)(x,{className:"w-4 h-4"}),"删除"]}),(0,t.jsxs)("button",{onClick:()=>ld(eU,"public"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(M.Link2,{className:"w-4 h-4"}),"公共链接"]}),(0,t.jsxs)("button",{onClick:()=>ld(eU,"custom"),className:"flex items-center justify-center gap-2 px-3 py-2 bg-white border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 rounded-lg text-sm font-medium transition-colors dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800 dark:hover:text-blue-200",children:[(0,t.jsx)(M.Link2,{className:"w-4 h-4"}),"自定义链接"]})]})]}):(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 dark:bg-gray-950",children:(0,t.jsx)(b,{className:"w-6 h-6 text-gray-300 dark:text-gray-600"})}),(0,t.jsxs)("p",{className:"text-gray-500 text-sm dark:text-gray-400",children:["选择一个文件以查看详情",(0,t.jsx)("br",{}),"或进行管理"]})]}),r?null:(0,t.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-100 dark:from-blue-950/35 dark:to-indigo-950/25 dark:border-blue-900",children:[(0,t.jsxs)("h3",{className:"text-xs font-bold text-blue-800 uppercase tracking-wider mb-4 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),"当前视图统计"]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"文件数"}),(0,t.jsx)("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:lv.fileCount})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"文件夹数"}),(0,t.jsx)("span",{className:"text-sm font-bold text-gray-800 dark:text-gray-100",children:lv.folderCount})]}),(0,t.jsx)("div",{className:"h-px bg-blue-200/50 my-2 dark:bg-blue-900/50"}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"总大小"}),(0,t.jsx)("span",{className:"text-sm font-bold text-blue-700 dark:text-blue-200",children:Y(lv.totalSize)})]})]})]})]}),(0,t.jsxs)("div",{className:"p-4 border-t border-gray-100 bg-gray-50 text-[10px] text-gray-400 text-center dark:border-gray-800 dark:bg-gray-950/30 dark:text-gray-400",children:[(0,t.jsx)("p",{children:ee.title}),(0,t.jsx)("p",{className:"mt-0.5",children:"R2对象存储多功能管理工具"})]})]});return(0,t.jsxs)("div",{className:"flex h-dvh md:h-screen bg-gray-50 text-gray-900 font-sans overflow-hidden dark:bg-gray-900 dark:text-gray-100",children:[rx?(0,t.jsxs)("div",{className:`fixed inset-0 z-50 md:hidden ${ru?"":"pointer-events-none"}`,children:[(0,t.jsx)("button",{type:"button","aria-label":"关闭菜单",onClick:()=>rm(!1),className:`absolute inset-0 bg-black/40 transition-opacity ${ru?"opacity-100":"opacity-0"}`}),(0,t.jsx)("div",{className:`absolute inset-y-0 left-0 w-[18rem] max-w-[85vw] transition-transform duration-200 ${ru?"translate-x-0":"-translate-x-full"}`,children:(0,t.jsx)(lE,{onClose:()=>rm(!1)})})]}):null,(0,t.jsx)("div",{className:"hidden md:block w-[17rem] shrink-0",children:rx?null:(0,t.jsx)(lE,{})}),(0,t.jsxs)("main",{className:"flex-1 flex flex-col min-w-0 bg-white dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"border-b border-gray-200 bg-white shrink-0 dark:border-gray-800 dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"hidden md:flex h-16 border-b-0 items-center px-6 gap-6",children:[(0,t.jsxs)("div",{className:"inline-grid grid-flow-col auto-cols-[3rem] items-stretch gap-2",children:[(0,t.jsxs)("button",{onClick:()=>eu&&sS(eu,eh,{force:!0}),disabled:!eu,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:"刷新","aria-label":"刷新",children:[(0,t.jsx)(u.RefreshCw,{className:`w-4 h-4 ${ef?"animate-spin":""}`}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"刷新"})]}),(0,t.jsxs)("button",{onClick:sG,disabled:!eu||!!eY.trim(),className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:eY.trim()?"搜索中无法新建文件夹":"新建文件夹","aria-label":"新建",children:[(0,t.jsx)(L,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"新建"})]}),(0,t.jsxs)("button",{onClick:ls,disabled:0===eK.size,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:"批量下载（所选文件）","aria-label":"下载",children:[(0,t.jsx)($.Download,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"下载"})]}),(0,t.jsxs)("button",{onClick:s3,disabled:0===eK.size,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:"批量移动（所选项）","aria-label":"移动",children:[(0,t.jsx)(A,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"移动"})]}),(0,t.jsxs)("button",{onClick:s1,disabled:eK.size>1||0===eK.size&&!eU,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:"重命名（仅支持单选）","aria-label":"重命名",children:[(0,t.jsx)(v,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"重命名"})]}),(0,t.jsxs)("button",{onClick:sY,disabled:0===eK.size&&!eU,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-red-200 dark:hover:bg-red-950/40",title:"删除（所选项）","aria-label":"删除",children:[(0,t.jsx)(x,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"删除"})]}),(0,t.jsxs)("button",{onClick:sL,disabled:!eu||1!==eK.size&&!eU,className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:"分享文件（需先选中一个文件或文件夹）","aria-label":"分享文件",children:[(0,t.jsx)(M.Link2,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"分享文件"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>rC(e=>"system"===e?r$?"light":"dark":"dark"===e?"light":"system"),className:"w-12 h-14 flex flex-col items-center justify-center gap-1 text-gray-500 hover:bg-blue-50/70 hover:text-blue-600 rounded-lg transition-colors active:scale-95 dark:text-gray-300 dark:hover:bg-blue-950/30 dark:hover:text-blue-300",title:"system"===rS?"主题：跟随系统":"dark"===rS?"主题：深色":"主题：浅色","aria-label":"主题",children:["dark"===rS?(0,t.jsx)(p,{className:"w-4 h-4"}):"light"===rS?(0,t.jsx)(h,{className:"w-4 h-4"}):(0,t.jsx)(f,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"主题"})]})]}),(0,t.jsx)("div",{className:"flex-1"}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(b,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,t.jsx)("input",{type:"text",placeholder:"桶内全局搜索...",value:eY,onChange:e=>eQ(e.target.value),className:"pl-9 pr-9 py-1.5 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 w-60 transition-all dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),e4?(0,t.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,t.jsx)(u.RefreshCw,{className:"w-4 h-4 text-gray-400 animate-spin dark:text-gray-500"})}):null]}),(0,t.jsx)("button",{onClick:()=>{eu&&(eq.length>0?eJ(!0):eX.current?.click())},disabled:!eu,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-all shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:lk.active>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.RefreshCw,{className:"w-4 h-4 animate-spin"}),(0,t.jsxs)("span",{children:[lk.pct,"%"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"上传"})]})})]})]}),(0,t.jsxs)("div",{className:"hidden md:flex items-center justify-between gap-3 px-6 py-2 border-t border-gray-100 bg-white dark:border-gray-800 dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm text-gray-600 dark:text-gray-300 min-w-0",children:[(0,t.jsxs)("button",{onClick:()=>{ep([]),eQ("")},className:"hover:bg-gray-100 px-2 py-1 rounded-md transition-colors text-gray-500 flex items-center gap-1 dark:text-gray-300 dark:hover:bg-gray-800",children:[(0,t.jsx)(E.FolderOpen,{className:"w-5 h-5 text-gray-500 dark:text-gray-300",strokeWidth:1.75}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"根目录"})]}),eh.length>0&&(0,t.jsx)(m,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"}),eh.map((e,r)=>(0,t.jsxs)(a.default.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>sV(r),className:"hover:text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-md transition-colors font-medium break-words dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:e}),r<eh.length-1&&(0,t.jsx)(m,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"})]},r))]}),(0,t.jsx)(G,{bucketName:lw??"未选择",disabled:!eu,onClick:()=>tA(!0)})]}),(0,t.jsxs)("div",{className:"md:hidden px-3 py-2 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>rm(!0),className:"p-2.5 -ml-1 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800","aria-label":"打开菜单",children:(0,t.jsx)(y,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,t.jsx)(F,{className:"w-10 h-10 shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"font-bold text-[18px] leading-[1.15] tracking-tight text-blue-600 truncate dark:text-blue-400",children:ee.title}),(0,t.jsx)("div",{className:"mt-0.25 text-[12px] leading-[1.1] text-gray-400 font-medium truncate dark:text-gray-400",children:ee.subtitle})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(b,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,t.jsx)("input",{type:"text",placeholder:"桶内搜索...",value:eY,onChange:e=>eQ(e.target.value),className:"w-full pl-9 pr-9 py-2 text-sm border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),e4?(0,t.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,t.jsx)(u.RefreshCw,{className:"w-4 h-4 text-gray-400 animate-spin dark:text-gray-500"})}):null]}),(0,t.jsxs)("button",{onClick:()=>{eu&&(eq.length>0?eJ(!0):eX.current?.click())},disabled:!eu,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-all shadow-sm active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[(0,t.jsx)(g,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"上传"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-8 items-stretch gap-1 pb-0.5",children:[(0,t.jsxs)("button",{onClick:()=>eu&&sS(eu,eh,{force:!0}),disabled:!eu,className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"刷新","aria-label":"刷新",children:[(0,t.jsx)(u.RefreshCw,{className:`w-5 h-5 ${ef?"animate-spin":""}`}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"刷新"})]}),(0,t.jsxs)("button",{onClick:sG,disabled:!eu||!!eY.trim(),className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:eY.trim()?"搜索中无法新建文件夹":"新建文件夹","aria-label":"新建",children:[(0,t.jsx)(L,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"新建"})]}),(0,t.jsxs)("button",{onClick:ls,disabled:0===eK.size,className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"批量下载（所选文件）","aria-label":"下载",children:[(0,t.jsx)($.Download,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"下载"})]}),(0,t.jsxs)("button",{onClick:s3,disabled:0===eK.size,className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"批量移动（所选项）","aria-label":"移动",children:[(0,t.jsx)(A,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"移动"})]}),(0,t.jsxs)("button",{onClick:s1,disabled:eK.size>1||0===eK.size&&!eU,className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名（仅支持单选）","aria-label":"重命名",children:[(0,t.jsx)(v,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"重命名"})]}),(0,t.jsxs)("button",{onClick:sY,disabled:0===eK.size&&!eU,className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-red-200 dark:hover:bg-red-950/40",title:"删除（所选项）","aria-label":"删除",children:[(0,t.jsx)(x,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none",children:"删除"})]}),(0,t.jsxs)("button",{onClick:sL,disabled:!eu||1!==eK.size&&!eU,className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"分享文件（需先选中一个文件或文件夹）","aria-label":"分享文件",children:[(0,t.jsx)(M.Link2,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"分享文件"})]}),(0,t.jsxs)("button",{type:"button",onClick:()=>rC(e=>"system"===e?r$?"light":"dark":"dark"===e?"light":"system"),className:"w-full h-14 flex flex-col items-center justify-center gap-1 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors active:scale-95 dark:text-gray-200 dark:hover:bg-gray-800",title:"system"===rS?"主题：跟随系统":"dark"===rS?"主题：深色":"主题：浅色","aria-label":"主题",children:["dark"===rS?(0,t.jsx)(p,{className:"w-5 h-5"}):"light"===rS?(0,t.jsx)(h,{className:"w-5 h-5"}):(0,t.jsx)(f,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"text-[10px] leading-none text-gray-500 dark:text-gray-400",children:"主题"})]})]}),(0,t.jsx)("div",{className:"pt-1",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1 text-sm text-gray-600 dark:text-gray-300 min-w-0",children:[(0,t.jsxs)("button",{onClick:()=>{ep([]),eQ("")},className:"hover:bg-gray-100 px-2 py-1 rounded-md transition-colors text-gray-500 flex items-center gap-1 dark:text-gray-300 dark:hover:bg-gray-800",children:[(0,t.jsx)(E.FolderOpen,{className:"w-5 h-5 text-gray-500 dark:text-gray-300",strokeWidth:1.75}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"根目录"})]}),eh.length>0&&(0,t.jsx)(m,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"}),eh.map((e,r)=>(0,t.jsxs)(a.default.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>sV(r),className:"hover:text-blue-600 hover:bg-blue-50 px-2 py-1 rounded-md transition-colors font-medium whitespace-nowrap dark:hover:text-blue-200 dark:hover:bg-blue-950/30",children:e}),r<eh.length-1&&(0,t.jsx)(m,{className:"w-4 h-4 text-gray-300 shrink-0 dark:text-gray-600"})]},r))]}),(0,t.jsx)(G,{bucketName:lw??"未选择",disabled:!eu,onClick:()=>tA(!0),className:"shrink-0"})]})})]})]}),(0,t.jsx)("input",{type:"file",multiple:!0,ref:eX,className:"hidden",onChange:lh}),ev||e4?(0,t.jsx)("div",{className:"h-1 w-full bg-[var(--loader-track)]",children:(0,t.jsx)("div",{className:"h-1 w-full r2-loading-progress"})}):(0,t.jsx)("div",{className:"h-1 w-full bg-transparent"}),(0,t.jsx)("div",{className:`flex-1 overflow-y-auto p-3 md:py-4 md:px-6 bg-gray-50/30 dark:bg-gray-900 ${ef||ev?"pointer-events-none":""}`,onClick:()=>{eL(null)},children:"unbound"===eN?(0,t.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,t.jsxs)("div",{className:"w-full max-w-2xl bg-white border border-gray-200 rounded-2xl shadow-sm p-6 dark:bg-gray-900 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-800 dark:text-gray-100",children:"未绑定存储桶"}),(0,t.jsx)("div",{className:"mt-1 text-sm text-gray-500 leading-relaxed dark:text-gray-300",children:"当前账号还没有可用存储桶，请点击「新增存储桶」并填写你的 R2 账号参数后继续。"})]}),(0,t.jsx)("button",{onClick:lA,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium transition-colors whitespace-nowrap",children:"新增存储桶"})]}),(0,t.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950/30",children:[(0,t.jsx)("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"配置步骤"}),(0,t.jsxs)("ol",{className:"mt-3 space-y-2 text-sm text-gray-700 list-decimal pl-5 dark:text-gray-200",children:[(0,t.jsx)("li",{children:"点击「新增存储桶」按钮"}),(0,t.jsx)("li",{children:"填写桶名、Account ID、Access Key、Secret Key"}),(0,t.jsx)("li",{children:"可选填写公共链接和自定义域名"}),(0,t.jsx)("li",{children:"保存后即可开始管理文件"})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-gray-50 p-4 dark:border-gray-800 dark:bg-gray-950/30",children:[(0,t.jsx)("div",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider dark:text-gray-400",children:"字段说明"}),(0,t.jsxs)("div",{className:"mt-3 text-sm text-gray-700 leading-relaxed space-y-2 dark:text-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("span",{className:"font-medium",children:"桶名称"}),(0,t.jsx)("code",{className:"px-2 py-1 rounded bg-white border border-gray-200 text-xs dark:bg-gray-900 dark:border-gray-800",children:"my-bucket"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("span",{className:"font-medium",children:"Account ID"}),(0,t.jsx)("code",{className:"px-2 py-1 rounded bg-white border border-gray-200 text-xs dark:bg-gray-900 dark:border-gray-800",children:"xxxxxxxx"})]}),(0,t.jsx)("div",{className:"text-[12px] text-gray-500 dark:text-gray-400",children:"Access Key 和 Secret Key 在 Cloudflare R2 API Tokens 中创建与查看。"})]})]})]}),(0,t.jsxs)("div",{className:"mt-4 rounded-xl border border-gray-200 bg-white p-4 dark:border-gray-800 dark:bg-gray-900",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-gray-600 dark:text-gray-200",children:"提示"}),(0,t.jsxs)("ul",{className:"mt-2 text-sm text-gray-700 space-y-1.5 list-disc pl-5 dark:text-gray-200",children:[(0,t.jsx)("li",{children:"每个账号可配置多个桶，也可混用多个 Cloudflare 账号的桶。"}),(0,t.jsx)("li",{children:"所有桶配置会绑定到当前登录账号，后续登录可直接继续使用。"})]})]})]})}):ev?(0,t.jsx)(W,{}):e$&&!ef?(0,t.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,t.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl border border-red-200 bg-red-50 p-6 dark:border-red-900/50 dark:bg-red-950/20",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-red-700 dark:text-red-200",children:"文件列表读取失败"}),(0,t.jsx)("div",{className:"mt-2 text-sm leading-relaxed text-red-700/90 dark:text-red-200/90",children:e$}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)("button",{onClick:()=>eu&&sS(eu,eh,{force:!0}),className:"inline-flex items-center gap-2 rounded-lg bg-red-600 px-4 py-2 text-sm font-medium text-white hover:bg-red-700",children:"重新读取"})})]})}):0!==lp.length||ef||e4?(0,t.jsx)(a.default.Fragment,{children:(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-2xl overflow-hidden shadow-sm dark:bg-gray-900 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center px-4 py-3 sm:py-2.5 text-[11px] font-semibold text-gray-500 bg-gray-50 border-b border-gray-200 dark:bg-gray-950/30 dark:border-gray-800 dark:text-gray-400",children:[(0,t.jsx)("div",{className:"w-7 flex items-center justify-start",children:(0,t.jsx)("input",{type:"checkbox","aria-label":"Select all",checked:lp.length>0&&lp.every(e=>eK.has(e.key)),onChange:e=>{let r=new Set(eK);if(e.target.checked)for(let e of lp)r.add(e.key);else for(let e of lp)r.delete(e.key);eD(r)},onClick:e=>e.stopPropagation(),className:"w-4 h-4"})}),(0,t.jsx)("div",{className:"flex-1",children:"名称"}),(0,t.jsx)("div",{className:"w-28 text-right hidden md:block",children:"大小"}),(0,t.jsx)("div",{className:"w-28 text-right hidden md:block",children:"修改时间"}),(0,t.jsx)("div",{className:"w-40 text-right hidden md:block",children:"操作"}),(0,t.jsx)("div",{className:"w-12 text-right md:hidden",children:"操作"})]}),(0,t.jsx)("div",{children:lp.map(e=>{let r=eK.has(e.key);return(0,t.jsxs)("div",{onClick:r=>{(r.stopPropagation(),rx)?"folder"===e.type?sq(e.name):ln(e):eL(e)},onDoubleClick:r=>{r.stopPropagation(),rx||("folder"===e.type?sq(e.name):ln(e))},className:`group flex items-center px-4 py-3 md:py-2.5 text-sm border-b border-gray-100 hover:bg-gray-50 cursor-pointer dark:border-gray-800 dark:hover:bg-gray-800 ${eU?.key===e.key?"bg-blue-50 dark:bg-blue-950/30":"bg-white dark:bg-gray-900"}`,children:[(0,t.jsx)("div",{className:"w-7 flex items-center justify-start",children:(0,t.jsx)("input",{type:"checkbox",checked:r,onChange:r=>{let t=new Set(eK);r.target.checked?t.add(e.key):t.delete(e.key),eD(t)},onClick:e=>e.stopPropagation(),className:"w-4 h-4"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"shrink-0",children:lj(e.type,e.name,"sm")}),(0,t.jsxs)("div",{className:"min-w-0 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"truncate",title:e.name,children:e.name}),(0,t.jsx)("span",{className:"shrink-0 text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:sB(e)})]})]}),(0,t.jsx)("div",{className:"w-28 text-right text-xs text-gray-500 hidden md:block dark:text-gray-400",children:"folder"===e.type?"-":Y(e.size)}),(0,t.jsx)("div",{className:"w-28 text-right text-xs text-gray-500 hidden md:block dark:text-gray-400",children:e.lastModified?new Date(e.lastModified).toLocaleDateString():"-"}),(0,t.jsx)("div",{className:"w-40 hidden md:flex justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:"folder"===e.type?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),sq(e.name)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"打开",children:(0,t.jsx)(E.FolderOpen,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),s5(e)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名",children:(0,t.jsx)(v,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),s7(e,"move")},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"移动",children:(0,t.jsx)(A,{className:"w-4 h-4"})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),lt(e)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"下载",children:(0,t.jsx)($.Download,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),s5(e)},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重命名",children:(0,t.jsx)(v,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:r=>{r.stopPropagation(),s7(e,"move")},className:"p-3 sm:p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"移动",children:(0,t.jsx)(A,{className:"w-4 h-4"})})]})}),(0,t.jsx)("div",{className:"w-12 flex justify-end md:hidden",children:(0,t.jsx)("button",{type:"button",onClick:r=>{r.stopPropagation(),eL(e),ry(!0)},className:"px-2.5 py-1.5 rounded-lg border border-gray-200 bg-white text-xs font-medium text-gray-700 hover:bg-gray-50 active:scale-95 transition dark:border-gray-800 dark:bg-gray-900 dark:text-gray-100 dark:hover:bg-gray-800","aria-label":"操作",title:"操作",children:"操作"})})]},e.key)})})]})}):(0,t.jsxs)("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 dark:text-gray-400",children:[(0,t.jsx)("div",{className:"w-24 h-24 bg-gray-50 rounded-full flex items-center justify-center mb-4 dark:bg-gray-950",children:(0,t.jsx)(o.Folder,{className:"w-10 h-10 text-gray-300 dark:text-gray-600"})}),(0,t.jsx)("p",{className:"text-sm font-medium",children:eY.trim()?"未找到匹配内容":"文件夹为空"})]})})]}),(0,t.jsx)("div",{className:"hidden md:flex w-80 shrink-0",children:(0,t.jsx)(lR,{})}),(0,t.jsxs)("div",{className:`fixed inset-0 z-50 md:hidden ${rb?"":"pointer-events-none"}`,children:[(0,t.jsx)("button",{type:"button","aria-label":"关闭详情",onClick:()=>ry(!1),className:`absolute inset-0 bg-black/40 transition-opacity ${rb?"opacity-100":"opacity-0"}`}),(0,t.jsx)("div",{className:`absolute inset-x-0 bottom-0 transition-transform duration-200 ${rb?"translate-y-0":"translate-y-full"}`,onClick:e=>e.stopPropagation(),children:(0,t.jsx)("div",{className:"h-[70dvh] bg-white rounded-t-2xl shadow-2xl border border-gray-200 overflow-hidden dark:bg-gray-900 dark:border-gray-800",children:(0,t.jsx)(lR,{compact:!0,onClose:()=>ry(!1)})})})]}),null,(0,t.jsx)(s,{open:tI,title:"当前存储桶",description:"主页仅展示（不支持切换）；如需切换请在侧边栏/菜单中操作。",onClose:()=>tA(!1),footer:(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:()=>tA(!1),className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"知道了"})}),children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"桶名称"}),(0,t.jsx)("div",{className:"text-base font-semibold text-gray-900 break-all dark:text-gray-100",children:lw??"未选择"})]})}),(0,t.jsx)(s,{open:r8,title:"分享文件",description:tr?`当前对象：${tr.name}（${"folder"===tr.type?"文件夹":"文件"}）`:"请选择文件或文件夹后再分享",onClose:()=>{r6(!1),tt(null),tm(null),ti(""),td(!1),tc(""),ts(7)},footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{r6(!1),tt(null),tm(null)},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"关闭"}),tu?(0,t.jsx)("button",{onClick:()=>{sH(tu)},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"复制链接"}):(0,t.jsx)("button",{onClick:()=>{sZ()},disabled:tx||!tr,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:tx?"创建中...":"创建分享"})]}),children:tu?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"rounded-xl border border-blue-200 bg-blue-50 px-4 py-3 text-sm text-blue-700 dark:border-blue-900/60 dark:bg-blue-950/30 dark:text-blue-200",children:"分享已创建，可直接复制链接或扫码分享。"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200",children:"分享链接"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{readOnly:!0,value:sO(tu),className:"flex-1 px-3 py-2 rounded-lg border border-gray-200 bg-gray-50 text-sm text-gray-700 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100"}),(0,t.jsx)("button",{onClick:()=>{sH(tu)},className:"px-3 py-2 rounded-lg border border-gray-200 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"复制"})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white p-4 dark:border-gray-800 dark:bg-gray-900",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-3 dark:text-gray-200",children:"二维码分享"}),(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,t.jsx)("img",{src:sU(sO(tu)),alt:"分享二维码",className:"w-44 h-44 rounded-lg border border-gray-200 bg-white p-2 dark:border-gray-800"}),(0,t.jsx)("button",{onClick:()=>sF(tu),className:"px-3 py-1.5 rounded-lg border border-gray-200 text-xs font-medium text-gray-700 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"放大查看二维码"})]})]})]}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"有效期"}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2 sm:grid-cols-4",children:Q.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>ts(e.value),className:`rounded-lg border px-3 py-2 text-xs font-medium transition-colors ${ta===e.value?"border-blue-500 bg-blue-50 text-blue-700 dark:border-blue-400 dark:bg-blue-950/40 dark:text-blue-200":"border-gray-200 text-gray-600 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800"}`,children:e.label},`expire-${e.value}`))})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 p-3 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:"启用提取码"}),(0,t.jsx)("button",{type:"button",onClick:()=>td(e=>!e),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${tl?"bg-blue-600":"bg-gray-300 dark:bg-gray-700"}`,"aria-label":"切换提取码",children:(0,t.jsx)("span",{className:`inline-block h-5 w-5 transform rounded-full bg-white transition-transform ${tl?"translate-x-5":"translate-x-1"}`})})]}),tl?(0,t.jsx)("input",{value:tn,onChange:e=>ti(e.target.value),className:"mt-3 w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none text-sm dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"4-16 位字母或数字"}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"备注（可选）"}),(0,t.jsx)("input",{value:to,onChange:e=>tc(e.target.value),className:"w-full px-3 py-2 rounded-lg border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none text-sm dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：项目资料第一版"})]})]})}),(0,t.jsx)(s,{open:r9,title:"分享管理",description:"查看已分享文件、复制链接、查看二维码与停止分享",panelClassName:"max-w-[96vw] sm:max-w-[960px]",onClose:()=>te(!1),footer:(0,t.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,t.jsx)("button",{onClick:()=>{sK()},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"刷新列表"}),(0,t.jsx)("button",{onClick:()=>te(!1),className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"完成"})]}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:[{value:"all",label:"全部"},{value:"active",label:"生效中"},{value:"expired",label:"已过期"},{value:"stopped",label:"已停止"}].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>tk(e.value),className:`rounded-lg border px-3 py-1.5 text-xs font-medium transition-colors ${tf===e.value?"border-blue-500 bg-blue-50 text-blue-700 dark:border-blue-400 dark:bg-blue-950/40 dark:text-blue-200":"border-gray-200 text-gray-600 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800"}`,children:e.label},`share-filter-${e.value}`))}),(0,t.jsx)("div",{className:"rounded-xl border border-gray-200 overflow-hidden dark:border-gray-800",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("div",{className:"min-w-[760px]",children:[(0,t.jsxs)("div",{className:"grid grid-cols-[2.1fr_0.8fr_0.8fr_0.8fr_1.2fr] gap-2 px-4 py-2 text-[11px] font-semibold text-gray-500 bg-gray-50 border-b border-gray-200 dark:bg-gray-950/40 dark:border-gray-800 dark:text-gray-400",children:[(0,t.jsx)("div",{children:"文件信息"}),(0,t.jsx)("div",{children:"有效期"}),(0,t.jsx)("div",{children:"提取码"}),(0,t.jsx)("div",{children:"状态"}),(0,t.jsx)("div",{className:"text-right",children:"操作"})]}),th?(0,t.jsx)("div",{className:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400",children:"正在加载分享记录..."}):0===lf.length?(0,t.jsx)("div",{className:"px-4 py-4 text-sm text-gray-500 dark:text-gray-400",children:"暂无分享记录"}):(0,t.jsx)("div",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:lf.map(e=>(0,t.jsxs)("div",{className:"grid grid-cols-[2.1fr_0.8fr_0.8fr_0.8fr_1.2fr] gap-2 px-4 py-3 text-sm",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"font-medium text-gray-800 truncate dark:text-gray-100",children:e.itemName}),(0,t.jsxs)("div",{className:"mt-0.5 text-xs text-gray-500 truncate dark:text-gray-400",children:["folder"===e.itemType?"文件夹":"文件"," · 创建于 ",new Date(e.createdAt).toLocaleString()]})]}),(0,t.jsx)("div",{className:"text-xs text-gray-600 self-center dark:text-gray-300",children:e.expiresAt?new Date(e.expiresAt).toLocaleDateString():"永久"}),(0,t.jsx)("div",{className:"text-xs text-gray-600 self-center dark:text-gray-300",children:e.passcodeEnabled?"已启用":"未启用"}),(0,t.jsx)("div",{className:"self-center",children:(0,t.jsx)("span",{className:`inline-flex rounded-full px-2 py-0.5 text-[11px] font-medium ${"active"===e.status?"bg-green-50 text-green-700 dark:bg-green-950/40 dark:text-green-200":"expired"===e.status?"bg-amber-50 text-amber-700 dark:bg-amber-950/40 dark:text-amber-200":"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-200"}`,children:"active"===e.status?"生效中":"expired"===e.status?"已过期":"已停止"})}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-1",children:[(0,t.jsx)("button",{onClick:()=>{sH(e)},className:"px-2 py-1 rounded-md border border-gray-200 text-xs text-gray-700 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"复制链接"}),(0,t.jsx)("button",{onClick:()=>sF(e),className:"px-2 py-1 rounded-md border border-gray-200 text-xs text-gray-700 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"二维码"}),(0,t.jsx)("button",{onClick:()=>{sJ(e)},disabled:"active"!==e.status,className:"px-2 py-1 rounded-md border border-red-200 text-xs text-red-600 hover:bg-red-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"停止"})]})]},e.id))})]})})})]})}),(0,t.jsx)(s,{open:tN,title:"分享二维码",onClose:()=>{tw(!1),tj("")},footer:(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:()=>{tw(!1),tj("")},className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"完成"})}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"flex justify-center",children:(0,t.jsx)("img",{src:sU(tv),alt:"分享二维码",className:"w-64 h-64 rounded-lg border border-gray-200 bg-white p-2 dark:border-gray-800"})}),(0,t.jsx)("input",{readOnly:!0,value:tv,className:"w-full px-3 py-2 rounded-lg border border-gray-200 bg-gray-50 text-xs text-gray-700 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100"})]})}),(0,t.jsxs)(s,{open:rW,title:"新建文件夹",description:eh.length?`当前位置：/${eh.join("/")}/`:"当前位置：/（根目录）",onClose:()=>{rG(!1),rY("")},footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{rG(!1),rY("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:sX,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"创建"})]}),children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"文件夹名称"}),(0,t.jsx)("input",{value:rX,onChange:e=>rY(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：images"})]}),(0,t.jsxs)(s,{open:rI,title:"重命名",description:eU?`当前：${eU.name}`:void 0,onClose:()=>rA(!1),footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>rA(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:s2,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"确认"})]}),children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新名称"}),(0,t.jsx)("input",{value:rE,onChange:e=>rR(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"输入新名称"})]}),(0,t.jsx)(s,{open:r_,title:"move"===rP?"移动":"复制",panelClassName:"max-w-[96vw] sm:max-w-[760px]",description:rU.length>1?`已选择 ${rU.length} 个对象`:eU?`对象：${eU.key}`:void 0,onClose:s8,footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:s8,className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:s9,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"确认"})]}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-blue-100 bg-blue-50 px-3 py-2 text-sm text-blue-700 dark:border-blue-900/60 dark:bg-blue-950/30 dark:text-blue-200",children:["当前目标：","/"===rT?"/（根目录）":`/${rT}`]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>s6([]),className:"inline-flex items-center gap-1.5 rounded-lg border border-gray-200 px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:[(0,t.jsx)(E.FolderOpen,{className:"h-3.5 w-3.5"}),"根目录"]}),(0,t.jsxs)("button",{type:"button",onClick:()=>s6(rK.slice(0,-1)),disabled:0===rK.length,className:"inline-flex items-center gap-1.5 rounded-lg border border-gray-200 px-3 py-1.5 text-xs text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:[(0,t.jsx)(m,{className:"h-3.5 w-3.5 rotate-180"}),"上一级"]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5 rounded-xl border border-gray-200 bg-gray-50 px-2 py-2 text-xs dark:border-gray-800 dark:bg-gray-950/50",children:[(0,t.jsx)("button",{type:"button",onClick:()=>s6([]),className:"rounded-md px-2 py-1 text-gray-700 hover:bg-white dark:text-gray-200 dark:hover:bg-gray-900",children:"根目录"}),rK.map((e,r)=>(0,t.jsxs)(a.default.Fragment,{children:[(0,t.jsx)(m,{className:"h-3.5 w-3.5 text-gray-400 dark:text-gray-500"}),(0,t.jsx)("button",{type:"button",onClick:()=>s6(rK.slice(0,r+1)),className:"rounded-md px-2 py-1 text-gray-700 hover:bg-white dark:text-gray-200 dark:hover:bg-gray-900",children:e})]},`move-breadcrumb-${r}`))]}),(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 dark:border-gray-800 overflow-hidden",children:[(0,t.jsx)("div",{className:"border-b border-gray-100 bg-gray-50 px-3 py-2 text-xs font-medium text-gray-500 dark:border-gray-800 dark:bg-gray-950/40 dark:text-gray-400",children:"点击文件夹进入并选择为目标目录"}),(0,t.jsx)("div",{className:"max-h-56 overflow-y-auto",children:rF?(0,t.jsx)("div",{className:"px-3 py-4 text-sm text-gray-500 dark:text-gray-400",children:"正在读取目录..."}):rq?(0,t.jsx)("div",{className:"px-3 py-4 text-sm text-red-600 dark:text-red-300",children:rq}):0===rZ.length?(0,t.jsx)("div",{className:"px-3 py-4 text-sm text-gray-500 dark:text-gray-400",children:"当前目录下没有子文件夹"}):rZ.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>s6([...rK,e.name]),className:"flex w-full items-center justify-between gap-3 border-b border-gray-100 px-3 py-2.5 text-left text-sm text-gray-800 hover:bg-gray-50 last:border-b-0 dark:border-gray-800 dark:text-gray-100 dark:hover:bg-gray-800",children:[(0,t.jsxs)("span",{className:"inline-flex min-w-0 items-center gap-2",children:[(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:"h-5 w-5 shrink-0 text-yellow-400",fill:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M19.5 21a3 3 0 0 0 3-3v-4.5a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3V18a3 3 0 0 0 3 3h15ZM1.5 10.146V6a3 3 0 0 1 3-3h5.379a2.25 2.25 0 0 1 1.59.659l2.122 2.121c.14.141.331.22.53.22H19.5a3 3 0 0 1 3 3v1.146A4.483 4.483 0 0 0 19.5 9h-15a4.483 4.483 0 0 0-3 1.146Z"})}),(0,t.jsx)("span",{className:"truncate",children:e.name})]}),(0,t.jsx)(m,{className:"h-4 w-4 shrink-0 text-gray-400 dark:text-gray-500"})]},`move-folder-${e.key}`))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-200",children:"手动路径（可选）"}),(0,t.jsx)("input",{value:rT,onChange:e=>rO(e.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-2.5 outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 dark:border-gray-800 dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：/ 或 photos/ 或 a/b/c/"}),(0,t.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"目录建议以 `/` 结尾；选择根目录可直接点击上方「根目录」。"})]})]})}),(0,t.jsx)(s,{open:tT,title:"账号中心",description:"当前账号与存储桶管理",panelClassName:"max-w-[96vw] sm:max-w-[600px]",showHeaderClose:!0,onClose:()=>{tO(!1),tJ(null)},children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"h-11 w-11 shrink-0 rounded-full bg-blue-50 text-blue-600 dark:bg-blue-950/40 dark:text-blue-300 flex items-center justify-center",children:(0,t.jsx)(K,{className:"h-7 w-7"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("div",{className:"text-sm leading-tight font-semibold text-gray-800 break-all sm:truncate sm:break-normal dark:text-gray-100",children:e?.email||"未读取到邮箱"}),(0,t.jsxs)("div",{className:"mt-0 min-w-0",children:[(0,t.jsx)("button",{type:"button",onClick:()=>aT(e=>!e),className:"text-[11px] leading-none text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:aB?"隐藏用户ID":"显示用户ID"}),aB?(0,t.jsxs)("div",{className:"mt-0.5 text-xs leading-tight text-gray-500 break-all dark:text-gray-400",children:["用户ID：",e?.userId||"-"]}):null]})]})]}),(0,t.jsxs)("div",{className:"w-full flex items-center gap-1.5 flex-wrap sm:w-auto sm:shrink-0 sm:justify-end",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{tO(!1),sD()},className:"px-2 py-1 rounded-md text-xs font-medium border border-blue-200 text-blue-700 hover:bg-blue-50 dark:border-blue-900 dark:text-blue-200 dark:hover:bg-blue-950/30",children:"分享管理"}),(0,t.jsx)("button",{type:"button",onClick:()=>{tO(!1),tM(!0)},className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"退出登录"}),(0,t.jsx)("button",{type:"button",onClick:()=>tL(!0),className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"修改密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>tD(!0),className:"px-2 py-1 rounded-md text-xs font-medium border border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"注销账号"})]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-900",children:[(0,t.jsxs)("div",{className:"pl-3 pr-5 py-2 border-b border-gray-200 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400",children:["已绑定存储桶（",ex.length,"）"]}),(0,t.jsxs)("button",{type:"button",onClick:lA,className:"shrink-0 inline-flex items-center gap-1.5 px-2 py-1.5 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:[(0,t.jsx)(D,{className:"w-3.5 h-3.5"}),"添加存储桶"]})]}),ex.length?(0,t.jsx)("div",{className:"max-h-[45vh] overflow-y-auto p-2 space-y-2",children:ex.map(e=>{let r=eu===e.id;return(0,t.jsxs)("div",{className:`rounded-lg border px-3 py-2 ${r?"border-blue-200 bg-blue-50 dark:border-blue-900 dark:bg-blue-950/30":"border-gray-200 bg-white dark:border-gray-800 dark:bg-gray-900"}`,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsx)("div",{className:"min-w-0",children:(0,t.jsx)("div",{className:"text-sm font-medium text-gray-800 truncate dark:text-gray-100",children:e.Name||e.bucketName||e.id})}),(0,t.jsxs)("div",{className:"shrink-0 flex items-center gap-1",children:[(0,t.jsx)("button",{type:"button",onClick:()=>{r||(lI(e.id),tO(!1))},disabled:r,className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800 dark:disabled:hover:bg-transparent",children:r?"当前":"切换"}),(0,t.jsx)("button",{type:"button",onClick:()=>{let r;!(r=lM(e.id??eu))?ro("请先选择要编辑的存储桶"):(tB(r.id),a1({}),aW(!1),aX(!1),aQ({bucketLabel:r.Name??"",bucketName:r.bucketName??"",accountId:r.accountId??"",accessKeyId:"",secretAccessKey:"",publicBaseUrl:r.publicBaseUrl??"",customBaseUrl:r.customBaseUrl??""}),tz(!0))},className:"px-2 py-1 rounded-md text-xs font-medium border border-gray-200 text-gray-700 hover:bg-gray-50 dark:border-gray-700 dark:text-gray-200 dark:hover:bg-gray-800",children:"编辑"}),(0,t.jsx)("button",{type:"button",onClick:()=>{let r;!(r=lM(e.id))?ro("未找到要删除的存储桶"):(tJ(r.id),tH(!0))},className:"px-2 py-1 rounded-md text-xs font-medium border border-red-200 text-red-600 hover:bg-red-50 dark:border-red-900 dark:text-red-200 dark:hover:bg-red-950/30",children:"删除"})]})]}),(0,t.jsxs)("div",{className:"mt-1 text-xs text-gray-500 break-all dark:text-gray-400",children:["R2 桶名：",e.bucketName||"-"]}),(0,t.jsxs)("div",{className:"mt-0.5 text-xs text-gray-500 break-all dark:text-gray-400",title:e.accountId||"-",children:["Account ID：",e.accountId||"-"]})]},e.id)})}):(0,t.jsx)("div",{className:"p-4 text-sm text-gray-500 dark:text-gray-400",children:"当前账号还未绑定存储桶，请点击右上角「添加存储桶」。"})]})]})}),(0,t.jsx)(s,{open:tU,title:"修改密码",onClose:()=>{tL(!1),aE(""),a_(""),aF(!1),aq(!1)},footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{tL(!1),aE(""),a_(""),aF(!1),aq(!1)},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{sp()},disabled:ef,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"保存新密码"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"新密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:aH?"text":"password",value:aA,onChange:e=>aE(e.target.value),className:"w-full px-4 py-2.5 pr-10 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"至少六位密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>aF(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":aH?"隐藏密码":"显示密码",children:aH?(0,t.jsx)(C,{className:"w-5 h-5"}):(0,t.jsx)(S,{className:"w-5 h-5"})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"确认新密码"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:aJ?"text":"password",value:aR,onChange:e=>a_(e.target.value),className:"w-full px-4 py-2.5 pr-10 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"再次输入新密码"}),(0,t.jsx)("button",{type:"button",onClick:()=>aq(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":aJ?"隐藏密码":"显示密码",children:aJ?(0,t.jsx)(C,{className:"w-5 h-5"}):(0,t.jsx)(S,{className:"w-5 h-5"})})]})]})]})}),(0,t.jsx)(s,{open:tK,title:"注销账号",description:"该操作不可恢复，将永久删除当前账号及其桶配置。",onClose:()=>{tD(!1),aP("")},footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{tD(!1),aP("")},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{sf()},disabled:ef,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"确认注销"})]}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"text-sm text-red-700 leading-relaxed dark:text-red-200",children:"注销后无法恢复，账号下已绑定的桶配置会一并清理。"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"请输入“注销”确认"}),(0,t.jsx)("input",{value:az,onChange:e=>aP(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-red-500/20 focus:border-red-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"注销"})]})]})}),(0,t.jsx)(s,{open:t_,title:tP?"编辑存储桶":"新增存储桶",panelClassName:"md:max-h-none",contentClassName:"md:overflow-y-visible",onClose:()=>{tz(!1),tB(null),a1({}),aW(!1),aX(!1)},footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{tz(!1),tB(null),a1({}),aW(!1),aX(!1)},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{sv()},disabled:ef,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:tP?"保存修改":"保存"})]}),children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["显示星号为必填项，不会配置可查看",(0,t.jsx)("a",{href:"/404",className:"text-blue-600 hover:text-blue-700 dark:text-blue-300 dark:hover:text-blue-200",children:"「使用教程」"}),"。"]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"显示名称"}),(0,t.jsx)("input",{value:aY.bucketLabel,onChange:e=>aQ(r=>({...r,bucketLabel:e.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500",placeholder:"例如：我的云盘"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["R2 桶名称"," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{value:aY.bucketName,onChange:e=>{aQ(r=>({...r,bucketName:e.target.value})),a1(e=>({...e,bucketName:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${a0.bucketName?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`}),a0.bucketName?(0,t.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:a0.bucketName}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Account ID"," ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{value:aY.accountId,onChange:e=>{aQ(r=>({...r,accountId:e.target.value})),a1(e=>({...e,accountId:void 0}))},className:`w-full px-4 py-2.5 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${a0.accountId?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`}),a0.accountId?(0,t.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:a0.accountId}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Access Key ID"," ",l$?(0,t.jsx)("span",{className:"text-red-500",children:"*"}):null]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:aV?"text":"password",value:aY.accessKeyId,onChange:e=>{aQ(r=>({...r,accessKeyId:e.target.value})),a1(e=>({...e,accessKeyId:void 0}))},className:`w-full px-4 py-2.5 pr-10 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${a0.accessKeyId?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:tP?"留空表示不修改":""}),(0,t.jsx)("button",{type:"button",onClick:()=>aW(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":aV?"隐藏密码":"显示密码",children:aV?(0,t.jsx)(C,{className:"w-5 h-5"}):(0,t.jsx)(S,{className:"w-5 h-5"})})]}),a0.accessKeyId?(0,t.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:a0.accessKeyId}):null]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:["Secret Access Key"," ",l$?(0,t.jsx)("span",{className:"text-red-500",children:"*"}):null]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:aG?"text":"password",value:aY.secretAccessKey,onChange:e=>{aQ(r=>({...r,secretAccessKey:e.target.value})),a1(e=>({...e,secretAccessKey:void 0}))},className:`w-full px-4 py-2.5 pr-10 rounded-xl border focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:text-gray-100 dark:placeholder:text-gray-500 ${a0.secretAccessKey?"border-red-500 dark:border-red-500":"border-gray-200 dark:border-gray-800"}`,placeholder:tP?"留空表示不修改":""}),(0,t.jsx)("button",{type:"button",onClick:()=>aX(e=>!e),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300","aria-label":aG?"隐藏密码":"显示密码",children:aG?(0,t.jsx)(C,{className:"w-5 h-5"}):(0,t.jsx)(S,{className:"w-5 h-5"})})]}),a0.secretAccessKey?(0,t.jsx)("div",{className:"mt-1 text-xs text-red-600 dark:text-red-300",children:a0.secretAccessKey}):null]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"公共开发 URL"}),(0,t.jsx)("input",{value:aY.publicBaseUrl,onChange:e=>aQ(r=>({...r,publicBaseUrl:e.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"自定义域名"}),(0,t.jsx)("input",{value:aY.customBaseUrl,onChange:e=>aQ(r=>({...r,customBaseUrl:e.target.value})),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]})]})]})}),(0,t.jsx)(s,{open:tZ,title:"确认删除存储桶？",onClose:()=>{tH(!1),tJ(null)},footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>{tH(!1),tJ(null)},className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{tF&&sj(tF)},disabled:!tF,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"删除存储桶"})]}),children:(0,t.jsxs)("div",{className:"text-sm text-gray-700 leading-relaxed dark:text-gray-200",children:["将删除以下存储桶配置：",(0,t.jsxs)("span",{className:"font-semibold",children:[" ",lC?.Name||lC?.bucketName||tF||"-"]}),"。该操作不会删除 R2 中的真实文件，只会移除本账号下的桶绑定配置。"]})}),(0,t.jsx)(s,{open:t$,title:"确认退出登录？",onClose:()=>tM(!1),footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>tM(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:()=>{tM(!1),sN()},className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"退出登录"})]}),children:(0,t.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:"退出后将清除本地登录状态，需要重新输入邮箱和密码才能继续使用。确定退出登录吗？"})}),(0,t.jsx)(s,{open:rQ,title:"链接设置",description:eu?`桶：${eu}`:void 0,onClose:()=>r0(!1),footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>r0(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:ll,className:"px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-sm font-medium",children:"保存"})]}),children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"公共开发 URL（可选）"}),(0,t.jsx)("input",{value:r1,onChange:e=>r5(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"自定义域名（可选）"}),(0,t.jsx)("input",{value:r2,onChange:e=>r4(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2 dark:text-gray-200",children:"R2 存储桶名称（必填）"}),(0,t.jsx)("input",{value:r7,onChange:e=>r3(e.target.value),className:"w-full px-4 py-2.5 rounded-xl border border-gray-200 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none dark:bg-gray-950 dark:border-gray-800 dark:text-gray-100 dark:placeholder:text-gray-500"}),(0,t.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"修改后将重新校验该桶名，校验通过才会保存。"})]})]})}),(0,t.jsx)(s,{open:tS,title:"确认删除",description:eK.size>0?`将删除 ${eK.size} 项`:eU?`将删除：${eU.key}`:void 0,onClose:()=>tC(!1),footer:(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)("button",{onClick:()=>tC(!1),className:"px-4 py-2 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-sm font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"取消"}),(0,t.jsx)("button",{onClick:sQ,className:"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 text-sm font-medium",children:"删除"})]}),children:(0,t.jsxs)("div",{className:"text-sm text-gray-700 dark:text-gray-200",children:["确定删除文件？此操作不可恢复。",eK.size>0?Array.from(eK).some(e=>e.endsWith("/"))?"（选择文件夹时，文件夹内的所有文件都将会被删除）":null:eU?.type==="folder"?"（文件夹会递归删除前缀下的所有对象）":null]})}),eq.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>eJ(e=>!e),className:"fixed bottom-5 right-5 z-40 flex items-center gap-2 px-4 py-2 rounded-full bg-gray-900 text-white shadow-lg hover:bg-gray-800",children:[(0,t.jsx)(g,{className:"w-4 h-4"}),(0,t.jsxs)("span",{className:"text-sm font-medium",children:["上传 ",lk.active?`(${lk.active})`:""]}),(0,t.jsxs)("span",{className:"text-xs text-gray-200",children:[lk.pct,"%"]})]}),eF?(0,t.jsxs)("div",{className:"fixed bottom-20 right-5 z-40 w-[420px] max-w-[calc(100vw-2.5rem)] bg-white border border-gray-200 rounded-2xl shadow-2xl overflow-hidden dark:bg-gray-900 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"px-4 py-3 border-b border-gray-100 flex items-center justify-between dark:border-gray-800",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100",children:"上传任务"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>eX.current?.click(),className:"px-3 py-1.5 rounded-lg bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:"添加文件"}),(0,t.jsx)("button",{onClick:()=>eV(e=>e.filter(e=>"queued"===e.status||"uploading"===e.status||"paused"===e.status)),className:"px-3 py-1.5 rounded-lg border border-gray-200 text-gray-700 hover:bg-gray-50 text-xs font-medium dark:border-gray-800 dark:text-gray-200 dark:hover:bg-gray-800",children:"清理已完成"}),(0,t.jsx)("button",{onClick:()=>eJ(!1),className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",title:"关闭",children:(0,t.jsx)(R,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{className:"max-h-[50vh] overflow-auto divide-y divide-gray-100 dark:divide-gray-800",children:eq.map(e=>{let r=e.file.size?Math.min(100,Math.round(Math.min(e.loaded,e.file.size)/e.file.size*100)):0;return(0,t.jsxs)("div",{className:"px-4 py-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate dark:text-gray-100",title:e.key,children:e.file.name}),(0,t.jsxs)("div",{className:"mt-0.5 text-[11px] text-gray-500 truncate dark:text-gray-400",title:`${e.bucket}/${e.key}`,children:[e.bucket,"/",e.key]})]}),(0,t.jsxs)("div",{className:"shrink-0 flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-xs font-semibold text-gray-800 dark:text-gray-100",children:[r,"%"]}),(0,t.jsx)("div",{className:"text-[11px] text-gray-500 dark:text-gray-400",children:"uploading"===e.status?li(e.speedBps):"done"===e.status?"完成":"queued"===e.status?"排队中":"paused"===e.status?"已暂停":"canceled"===e.status?"已取消":"error"===e.status?"失败":e.status})]}),"uploading"===e.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{var r;return r=e.id,void(eV(e=>e.map(e=>e.id===r&&"uploading"===e.status?{...e,status:"paused",speedBps:0}:e)),eG(!0),tW.current.get(r)?.abort(),ro("已暂停（可继续续传）"))},className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"暂停",children:(0,t.jsx)(_,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>lb(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,t.jsx)(P,{className:"w-4 h-4"})})]}):"paused"===e.status?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>lu(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"继续",children:(0,t.jsx)(z,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>lb(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,t.jsx)(P,{className:"w-4 h-4"})})]}):"queued"===e.status?(0,t.jsx)("button",{onClick:()=>lb(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"取消",children:(0,t.jsx)(P,{className:"w-4 h-4"})}):"error"===e.status?(0,t.jsx)("button",{onClick:()=>lu(e.id),className:"p-2 rounded-lg hover:bg-gray-100 text-gray-600 dark:text-gray-200 dark:hover:bg-gray-800",title:"重试",children:(0,t.jsx)(z,{className:"w-4 h-4"})}):null]})]}),(0,t.jsx)("div",{className:"mt-2 h-2 bg-gray-100 rounded-full overflow-hidden dark:bg-gray-800",children:(0,t.jsx)("div",{className:`h-2 ${"error"===e.status?"bg-red-500":"done"===e.status?"bg-green-500":"paused"===e.status||"canceled"===e.status?"bg-gray-400":"bg-blue-600"}`,style:{width:`${r}%`}})}),"error"===e.status?(0,t.jsx)("div",{className:"mt-2 text-[11px] text-red-600 dark:text-red-300",children:e.error??"上传失败"}):null]},e.id)})})]}):null]}):null,lS?(0,t.jsx)("div",{className:"pointer-events-none fixed top-[4.25rem] right-4 z-40",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 rounded-full border border-cyan-200/70 bg-white/95 px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm backdrop-blur dark:border-cyan-900/60 dark:bg-slate-900/90 dark:text-slate-100",children:[(0,t.jsx)(q,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:ev?"正在加载文件列表":e4?"正在搜索对象":"正在处理请求"}),(0,t.jsx)(V,{})]})}):null,se,eZ?(0,t.jsx)("div",{className:"fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-6",onClick:()=>eH(null),children:(0,t.jsxs)("div",{className:"w-full max-w-4xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden dark:bg-gray-900 dark:border-gray-800",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"px-5 py-3 border-b border-gray-100 flex items-center justify-between gap-3 dark:border-gray-800",children:[(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-900 truncate dark:text-gray-100",title:eZ.name,children:eZ.name}),(0,t.jsx)("div",{className:"text-[11px] text-gray-500 truncate dark:text-gray-400",title:eZ.key,children:eZ.key})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"hidden sm:inline-flex text-[10px] px-2 py-0.5 rounded-full border border-gray-200 bg-white text-gray-600 font-semibold dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200",children:sP(eZ.name).toUpperCase()||"FILE"}),(0,t.jsx)("button",{onClick:async()=>{try{let e=await lr(eZ.bucket,eZ.key,eZ.name);la(e,eZ.name),ro("已拉起下载")}catch{ro("下载失败")}},className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-gray-800",title:"下载",children:(0,t.jsx)($.Download,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>eH(null),className:"p-2 rounded-lg text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-800",title:"关闭",children:(0,t.jsx)(R,{className:"w-4 h-4"})})]})]}),(0,t.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-950/30",children:"image"===eZ.kind?(0,t.jsx)("div",{className:"flex items-center justify-center",children:(0,t.jsx)("img",{src:eZ.url,alt:eZ.name,className:"max-h-[70vh] max-w-full rounded-lg shadow"})}):"video"===eZ.kind?(0,t.jsx)("div",{className:"w-full aspect-video rounded-lg shadow bg-black overflow-hidden",children:(0,t.jsx)("video",{src:eZ.url,controls:!0,className:"w-full h-full object-contain"})}):"audio"===eZ.kind?(0,t.jsx)("audio",{src:eZ.url,controls:!0,className:"w-full"}):"pdf"===eZ.kind?(0,t.jsx)("iframe",{src:eZ.url,className:"w-full h-[70vh] rounded-lg shadow bg-white dark:bg-gray-900",title:"PDF Preview"}):"office"===eZ.kind?(0,t.jsx)("iframe",{src:`https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(eZ.url)}`,className:"w-full h-[70vh] rounded-lg shadow bg-white dark:bg-gray-900",title:"Office Preview"}):"text"===eZ.kind?(0,t.jsx)("pre",{className:"text-xs bg-white border border-gray-200 rounded-lg p-4 overflow-auto max-h-[70vh] whitespace-pre-wrap dark:bg-gray-900 dark:border-gray-800 dark:text-gray-100",children:eZ.text??"加载中..."}):(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl p-10 flex flex-col items-center justify-center text-center dark:bg-gray-900 dark:border-gray-800",children:[(0,t.jsx)("div",{className:"w-28 h-28 rounded-full bg-gray-100 flex items-center justify-center dark:bg-gray-800",children:(0,t.jsx)(j,{className:"w-10 h-10 text-blue-600"})}),(0,t.jsx)("div",{className:"mt-8 text-2xl font-semibold text-gray-900 dark:text-gray-100",children:"无法预览此文件"}),(0,t.jsx)("div",{className:"mt-3 text-sm text-gray-500 dark:text-gray-400",children:"此文件类型暂不支持在线预览，请下载后查看。"}),(0,t.jsxs)("button",{onClick:async()=>{try{let e=await lr(eZ.bucket,eZ.key,eZ.name);la(e,eZ.name),ro("已拉起下载")}catch{ro("下载失败")}},className:"mt-8 inline-flex items-center gap-3 px-8 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-lg",children:[(0,t.jsx)($.Download,{className:"w-5 h-5"}),"下载文件"]})]})})]})}):null]})}e.s(["default",()=>ex],31713)}]);